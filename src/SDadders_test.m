% SDadders_test.m
% Copyright (C) 2017,2018 Robert G. Jenssen

test_common;

unlink("SDadders_test.diary");
unlink("SDadders_test.diary.tmp");
diary SDadders_test.diary.tmp

% From bitflip_bandpass_NS_lattice_test.m
s10_bfsd = [  0.37500, -0.71875, -0.87500, -0.62500, ... 
              0.03125,  0.50000,  0.46875,  0.15625, ... 
             -0.09375, -0.09375,  0.00000,  0.00000, ... 
             -0.06250, -0.09375,  0.00000,  0.03125, ... 
              0.03125,  0.00000,  0.00000,  0.00000 ]';
s11_bfsd = [  0.93750,  0.68750,  0.46875,  0.78125, ... 
              1.00000,  0.87500,  0.87500,  1.06250, ... 
              1.00000,  1.00000,  1.06250,  1.00000, ... 
              1.00000,  1.00000,  1.00000,  1.00000, ... 
              1.00000,  1.00000,  1.00000,  0.43750 ]';
s00_bfsd = [  1.00000,  0.62500,  1.00000,  0.87500, ... 
              1.00000,  0.93750,  1.00000,  0.90625, ... 
              1.00000,  0.93750,  1.00000,  0.96875, ... 
              1.00000,  0.96875,  1.00000,  1.00000, ... 
              1.00000,  1.00000,  1.00000,  1.00000 ]';
s02_bfsd = [  0.00000, -0.78125,  0.00000, -0.53125, ... 
              0.00000, -0.37500,  0.00000, -0.40625, ... 
              0.00000, -0.34375,  0.00000, -0.28125, ... 
              0.00000, -0.18750,  0.00000, -0.12500, ... 
              0.00000, -0.06250,  0.00000, -0.03125 ]';
s20_bfsd = [  0.00000,  0.62500,  0.00000,  0.53125, ... 
              0.00000,  0.37500,  0.00000,  0.31250, ... 
              0.00000,  0.15625,  0.00000,  0.43750, ... 
              0.00000,  0.46875,  0.00000,  0.00000, ... 
              0.00000,  0.00000,  0.00000,  0.03125 ]';
s22_bfsd = [  1.00000,  0.53125,  1.00000,  0.75000, ... 
              1.00000,  0.90625,  1.00000,  0.93750, ... 
              1.00000,  0.84375,  1.00000,  0.96875, ... 
              1.00000,  0.96875,  1.00000,  1.00000, ... 
              1.00000,  1.00000,  1.00000,  1.00000 ]';

% Run 
nbits=6;
s_bfsd=[s10_bfsd(:);s11_bfsd(:);s20_bfsd(:);s00_bfsd(:);s02_bfsd(:);s22_bfsd(:)];
[s_bfsd_digits,s_bfsd_adders]=SDadders(s_bfsd,nbits);
printf("s_bfsd_digits=%d,s_bfsd_adders=%d\n",s_bfsd_digits,s_bfsd_adders);

% Done
diary off
movefile SDadders_test.diary.tmp SDadders_test.diary;
