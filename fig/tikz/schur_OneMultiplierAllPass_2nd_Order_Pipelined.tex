% schur_OneMultiplierAllPass_4th_Order_Pipelined.tex

\documentclass{standalone}
\usepackage{tikz}
\usetikzlibrary{dsp,chains}

\begin{document}

\begin{tikzpicture}
	\matrix (m1) [row sep=5mm, column sep=5mm]
	{
		%--------------------------------------------------------------------
		\node[coordinate]                   (m200) {};          &
		\node[coordinate]                   (m201) {};          &
		\node[coordinate]                   (m202) {};          &
		\node[coordinate]                   (m203) {};          &
		\node[coordinate]                   (m204) {};          &
		\node[coordinate]                   (m205) {};          &
		\node[coordinate]                   (m206) {};          &
		\node[coordinate]                   (m207) {};          &
		\node[coordinate]                   (m208) {};          &
		\node[coordinate]                   (m209) {};          &
		\node[coordinate]                   (m210) {};          &
		\node[coordinate]                   (m211) {};          &
		\node[coordinate]                   (m212) {};          &
		\node[coordinate]                   (m213) {};          &
		\node[coordinate]                   (m214) {};          &
		\node[coordinate]                   (m215) {};          &
		\node[coordinate]                   (m216) {};          &
		\node[coordinate]                   (m217) {};          &
		\node[coordinate]                   (m218) {};          &
		\node[coordinate]                   (m219) {};          &
		%--------------------------------------------------------------------
        \\
		%--------------------------------------------------------------------
		\node[coordinate]                   (m300) {};          &
		\node[dspnodeopen, dsp/label=left]  (m301) {$u$};       &
		\node[dspnodefull]                  (m302) {};          &
		\node[dspadder]                     (m303) {};          &
		\node[coordinate]                   (m304) {};          &
		\node[dspnodefull]                  (m305) {};          &
		\node[coordinate]                   (m306) {};          &
		\node[dspadder]                     (m307) {};          &
		\node[coordinate]                   (m308) {};          &
		\node[coordinate]                   (m309) {};          &
		\node[dspnodefull]                  (m310) {};          &
		\node[dspadder]                     (m311) {};          &
		\node[coordinate]                   (m312) {};          &
		\node[dspnodefull]                  (m313) {};          &
		\node[coordinate]                   (m314) {};          &
		\node[dspadder]                     (m315) {};          &
		\node[dspsquare]                    (m316) {$z^{-1}$};   &
		\node[dspnodefull, dsp/label=above] (m317) {$x_{1}$};    &
		\node[coordinate]                   (m318) {};          &
		\node[coordinate]                   (m319) {};          &
		%--------------------------------------------------------------------
        \\
		%--------------------------------------------------------------------
		\node[coordinate]                   (m400) {};           &
		\node[dspnodeopen, dsp/label=left]  (m401) {$\hat{y}$};  &
		\node[coordinate]                   (m402) {};           &
		\node[dspadder]                     (m403) {};           &
		\node[coordinate]                   (m404) {};           &
		\node[dspnodefull]                  (m405) {};           &
		\node[coordinate]                   (m406) {};           &
		\node[coordinate]                   (m407) {};           &
		\node[dspnodefull, dsp/label=above] (m408) {$x_{2}$};    &
		\node[dspsquare]                    (m409) {$z^{-1}$};   &
		\node[coordinate]                   (m410) {};           &
		\node[dspadder]                     (m411) {};           &
		\node[coordinate]                   (m412) {};           &
		\node[dspnodefull]                  (m413) {};           &
		\node[coordinate]                   (m414) {};           &
		\node[coordinate]                   (m415) {};           &
		\node[coordinate]                   (m416) {};           &
		\node[coordinate]                   (m417) {};           &
		\node[coordinate]                   (m418) {};           &
		\node[coordinate]                   (m419) {};           &
		%--------------------------------------------------------------------
        \\
		%--------------------------------------------------------------------
	};

	% Draw horizontal connections

	\begin{scope}[start chain]
		\chainin (m301);
		\chainin (m302) [join=by dspconn];
		\chainin (m303) [join=by dspconn];
    \end{scope}

    \draw[dspconn] (m303) -- node[above] {$k_{2}$} (m305);
    \draw[dspconn] (m305) -- (m307);
    \draw[dspconn] (m307) -- (m310);
    \draw[dspconn] (m310) -- (m311);
      
	\begin{scope}[start chain]
		\chainin (m305);
		\chainin (m307) [join=by dspconn];
		\chainin (m310) [join=by dspconn];
		\chainin (m311) [join=by dspconn];
    \end{scope}
      
    \draw[dspconn] (m311) -- node[above] {$k_{1}$} (m313);

	\begin{scope}[start chain]
      \chainin (m313);
      \chainin (m315) [join=by dspconn];
      \chainin (m316) [join=by dspconn];
      \chainin (m317) [join=by dspconn];
      \chainin (m318) [join=by dspline];
    \end{scope}
    
    \draw[dspconn] (m318) |- (m413);
    
	\begin{scope}[start chain]
      \chainin (m413);
      \chainin (m411) [join=by dspconn];
      \chainin (m409) [join=by dspconn];
      \chainin (m408) [join=by dspconn];
      \chainin (m405) [join=by dspconn];
      \chainin (m403) [join=by dspconn];
      \chainin (m401) [join=by dspconn];
	\end{scope}

    
	% Draw vertical connections

    \draw[dspline] (m302) -- (m202);
    \draw[dspconn] (m202) -| (m307);

    \draw[dspline] (m310) -- (m210);
    \draw[dspconn] (m210) -| (m315);

	% Draw diagonal connections

    \draw[dspconn] (m405) -- (m303);
    \draw[dspconn] (m305) -- (m403);
    
    \draw[dspconn] (m413) -- (m311);
    \draw[dspconn] (m313) -- (m411);
    
\end{tikzpicture}

\end{document}
