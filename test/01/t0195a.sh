#!/bin/sh

prog=schurOneMscale_test.m
depends="schurOneMscale_test.m test_common.m \
schurdecomp.oct schurexpand.oct schurOneMscale.m schurOneMlatticeFilter.m"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
epsilon =

   1.0000e+00   1.0000e+00  -1.0000e+00   1.0000e+00  -1.0000e+00

epsilon =

   1.0000e+00   1.0000e+00  -1.0000e+00   1.0000e+00  -1.0000e+00

p =

   1.5523e+00   8.3268e-01   9.4421e-01   9.8426e-01   9.9766e-01

k =

 Columns 1 through 6:

  -8.1674e-01   9.9818e-01  -8.8440e-01   9.6513e-01  -9.2990e-01   8.8687e-01

 Column 7:

  -5.6357e-01

S =

 Columns 1 through 6:

   5.9755e-04   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -8.4580e-04   1.0356e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   1.7120e-02  -2.7991e-02   1.7152e-02   0.0000e+00   0.0000e+00   0.0000e+00
  -3.2500e-02   8.9721e-02  -9.2414e-02   3.6748e-02   0.0000e+00   0.0000e+00
   1.3548e-01  -4.6485e-01   6.7350e-01  -4.7283e-01   1.4038e-01   0.0000e+00
  -3.5491e-01   1.5638e+00  -2.9666e+00   3.0064e+00  -1.6281e+00   3.8166e-01
   7.3261e-01  -3.8934e+00   9.1556e+00  -1.2116e+01   9.5089e+00  -4.2051e+00
  -5.6357e-01   3.7557e+00  -1.1200e+01   1.9349e+01  -2.0913e+01   1.4167e+01

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   8.2607e-01   0.0000e+00
  -5.5903e+00   1.0000e+00

epsilon =

 Columns 1 through 6:

   1.0000e+00   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00  -1.0000e+00

 Column 7:

  -1.0000e+00

p =

 Columns 1 through 6:

   8.4339e-01   2.6554e+00   8.0239e-02   3.2396e-01   2.4319e+00   4.6347e-01

 Column 7:

   1.8928e+00

S1M =

 Columns 1 through 6:

   5.0397e-04   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.2460e-03   2.7500e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   1.3737e-03  -2.2460e-03   1.3762e-03   0.0000e+00   0.0000e+00   0.0000e+00
  -1.0529e-02   2.9066e-02  -2.9939e-02   1.1905e-02   0.0000e+00   0.0000e+00
   3.2947e-01  -1.1305e+00   1.6379e+00  -1.1499e+00   3.4138e-01   0.0000e+00
  -1.6449e-01   7.2477e-01  -1.3749e+00   1.3934e+00  -7.5457e-01   1.7689e-01
   1.3867e+00  -7.3693e+00   1.7330e+01  -2.2932e+01   1.7998e+01  -7.9594e+00
  -5.6357e-01   3.7557e+00  -1.1200e+01   1.9349e+01  -2.0913e+01   1.4167e+01

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   1.5636e+00   0.0000e+00
  -5.5903e+00   1.0000e+00

c =

 Columns 1 through 6:

  -6.5709e-02   5.1872e-02   2.4980e+00   7.5389e-01   8.9681e-02   1.9551e-01

 Columns 7 and 8:

   2.0683e-02   1.3694e-02

km =

 Columns 1 through 6:

  -8.1674e-01   9.9818e-01  -8.8440e-01   9.6513e-01  -9.2990e-01   8.8687e-01

 Column 7:

  -5.6357e-01

Sm =

 Columns 1 through 6:

  -5.9755e-04   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   8.4580e-04  -1.0356e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -1.7120e-02   2.7991e-02  -1.7152e-02   0.0000e+00   0.0000e+00   0.0000e+00
   3.2500e-02  -8.9721e-02   9.2414e-02  -3.6748e-02   0.0000e+00   0.0000e+00
  -1.3548e-01   4.6485e-01  -6.7350e-01   4.7283e-01  -1.4038e-01   0.0000e+00
   3.5491e-01  -1.5638e+00   2.9666e+00  -3.0064e+00   1.6281e+00  -3.8166e-01
  -7.3261e-01   3.8934e+00  -9.1556e+00   1.2116e+01  -9.5089e+00   4.2051e+00
   5.6357e-01  -3.7557e+00   1.1200e+01  -1.9349e+01   2.0913e+01  -1.4167e+01

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -8.2607e-01   0.0000e+00
   5.5903e+00  -1.0000e+00

epsilonm =

 Columns 1 through 6:

   1.0000e+00   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00  -1.0000e+00

 Column 7:

  -1.0000e+00

pm =

 Columns 1 through 6:

   8.4339e-01   2.6554e+00   8.0239e-02   3.2396e-01   2.4319e+00   4.6347e-01

 Column 7:

   1.8928e+00

S1Mm =

 Columns 1 through 6:

  -5.0397e-04   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.2460e-03  -2.7500e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -1.3737e-03   2.2460e-03  -1.3762e-03   0.0000e+00   0.0000e+00   0.0000e+00
   1.0529e-02  -2.9066e-02   2.9939e-02  -1.1905e-02   0.0000e+00   0.0000e+00
  -3.2947e-01   1.1305e+00  -1.6379e+00   1.1499e+00  -3.4138e-01   0.0000e+00
   1.6449e-01  -7.2477e-01   1.3749e+00  -1.3934e+00   7.5457e-01  -1.7689e-01
  -1.3867e+00   7.3693e+00  -1.7330e+01   2.2932e+01  -1.7998e+01   7.9594e+00
   5.6357e-01  -3.7557e+00   1.1200e+01  -1.9349e+01   2.0913e+01  -1.4167e+01

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -1.5636e+00   0.0000e+00
   5.5903e+00  -1.0000e+00

cm =

 Columns 1 through 6:

   6.5709e-02  -5.1872e-02  -2.4980e+00  -7.5389e-01  -8.9681e-02  -1.9551e-01

 Columns 7 and 8:

  -2.0683e-02  -1.3694e-02

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
stdxf =

 Columns 1 through 6:

   1.1375e+02   1.1340e+02   1.2740e+02   1.2512e+02   1.2839e+02   1.2806e+02

 Column 7:

   1.2928e+02

stdxfr =

 Columns 1 through 6:

   6.4658e+00   6.4811e+00   7.2934e+03   7.1482e+03   1.2859e+02   1.2811e+02

 Column 7:

   1.2950e+02

stdxfr43 =

 Columns 1 through 6:

   1.0426e+05   1.0391e+05   1.1695e+05   7.0463e+03   1.2843e+02   1.2813e+02

 Column 7:

   1.2929e+02

stdxfm =

 Columns 1 through 6:

   1.6118e+02   1.6216e+01   1.9828e+04   1.1956e+03   2.1733e+01   5.9680e+02

 Column 7:

   3.6091e+01

k =

 Columns 1 through 6:

  -8.0578e-01   9.9921e-01  -7.8555e-01   9.7685e-01  -6.7947e-01   6.0937e-01

 Column 7:

  -2.8265e-02

S =

 Columns 1 through 6:

   1.8123e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.4658e-03   3.0602e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   7.6920e-02  -1.2401e-01   7.6981e-02   0.0000e+00   0.0000e+00   0.0000e+00
  -9.7726e-02   2.8173e-01  -2.9805e-01   1.2440e-01   0.0000e+00   0.0000e+00
   5.6805e-01  -1.8178e+00   2.6034e+00  -1.8394e+00   5.8151e-01   0.0000e+00
  -5.3852e-01   2.4777e+00  -4.8884e+00   5.2316e+00  -3.0331e+00   7.9257e-01
   6.0913e-01  -3.0103e+00   7.1457e+00  -9.9224e+00   8.5025e+00  -4.2393e+00
  -2.8265e-02   7.2924e-01  -3.2519e+00   7.4291e+00  -1.0128e+01   8.5910e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   9.9960e-01   0.0000e+00
  -4.2582e+00   1.0000e+00

epsilon =

 Columns 1 through 6:

   1.0000e+00   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00  -1.0000e+00

 Column 7:

   1.0000e+00

p =

 Columns 1 through 6:

   6.7813e-01   2.0677e+00   4.1115e-02   1.1864e-01   1.0963e+00   4.7893e-01

 Column 7:

   9.7212e-01

S1M =

 Columns 1 through 6:

   1.2290e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -5.0987e-03   6.3277e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   3.1626e-03  -5.0987e-03   3.1651e-03   0.0000e+00   0.0000e+00   0.0000e+00
  -1.1594e-02   3.3425e-02  -3.5361e-02   1.4759e-02   0.0000e+00   0.0000e+00
   6.2275e-01  -1.9928e+00   2.8541e+00  -2.0166e+00   6.3751e-01   0.0000e+00
  -2.5792e-01   1.1866e+00  -2.3412e+00   2.5056e+00  -1.4527e+00   3.7959e-01
   5.9215e-01  -2.9264e+00   6.9465e+00  -9.6458e+00   8.2654e+00  -4.1211e+00
  -2.8265e-02   7.2924e-01  -3.2519e+00   7.4291e+00  -1.0128e+01   8.5910e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   9.7174e-01   0.0000e+00
  -4.2582e+00   1.0000e+00

c =

 Columns 1 through 6:

   1.3388e-01   4.2422e-02  -4.5263e+00  -8.0518e-01   2.6240e-01   3.3774e-01

 Columns 7 and 8:

  -6.7985e-01   3.4094e-01

km =

 Columns 1 through 6:

  -8.0578e-01   9.9921e-01  -7.8555e-01   9.7685e-01  -6.7947e-01   6.0937e-01

 Column 7:

  -2.8265e-02

Sm =

 Columns 1 through 6:

  -1.8123e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.4658e-03  -3.0602e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -7.6920e-02   1.2401e-01  -7.6981e-02   0.0000e+00   0.0000e+00   0.0000e+00
   9.7726e-02  -2.8173e-01   2.9805e-01  -1.2440e-01   0.0000e+00   0.0000e+00
  -5.6805e-01   1.8178e+00  -2.6034e+00   1.8394e+00  -5.8151e-01   0.0000e+00
   5.3852e-01  -2.4777e+00   4.8884e+00  -5.2316e+00   3.0331e+00  -7.9257e-01
  -6.0913e-01   3.0103e+00  -7.1457e+00   9.9224e+00  -8.5025e+00   4.2393e+00
   2.8265e-02  -7.2924e-01   3.2519e+00  -7.4291e+00   1.0128e+01  -8.5910e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -9.9960e-01   0.0000e+00
   4.2582e+00  -1.0000e+00

epsilonm =

 Columns 1 through 6:

   1.0000e+00   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00  -1.0000e+00

 Column 7:

   1.0000e+00

pm =

 Columns 1 through 6:

   6.7813e-01   2.0677e+00   4.1115e-02   1.1864e-01   1.0963e+00   4.7893e-01

 Column 7:

   9.7212e-01

S1Mm =

 Columns 1 through 6:

  -1.2290e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   5.0987e-03  -6.3277e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -3.1626e-03   5.0987e-03  -3.1651e-03   0.0000e+00   0.0000e+00   0.0000e+00
   1.1594e-02  -3.3425e-02   3.5361e-02  -1.4759e-02   0.0000e+00   0.0000e+00
  -6.2275e-01   1.9928e+00  -2.8541e+00   2.0166e+00  -6.3751e-01   0.0000e+00
   2.5792e-01  -1.1866e+00   2.3412e+00  -2.5056e+00   1.4527e+00  -3.7959e-01
  -5.9215e-01   2.9264e+00  -6.9465e+00   9.6458e+00  -8.2654e+00   4.1211e+00
   2.8265e-02  -7.2924e-01   3.2519e+00  -7.4291e+00   1.0128e+01  -8.5910e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -9.7174e-01   0.0000e+00
   4.2582e+00  -1.0000e+00

cm =

 Columns 1 through 6:

  -1.3388e-01  -4.2422e-02   4.5263e+00   8.0518e-01  -2.6240e-01  -3.3774e-01

 Columns 7 and 8:

   6.7985e-01  -3.4094e-01

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
k =

  -3.9699e-01   9.3499e-01  -6.5887e-01   6.2581e-01  -3.1213e-01

S =

   1.8146e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -7.8488e-02   1.9771e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   5.2119e-01  -4.2820e-01   5.5743e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -4.8823e-01   1.0679e+00  -1.0257e+00   7.4101e-01   0.0000e+00   0.0000e+00
   5.9455e-01  -1.4489e+00   2.2259e+00  -1.7068e+00   9.5004e-01   0.0000e+00
  -3.1213e-01   1.1866e+00  -2.2564e+00   2.8190e+00  -1.9919e+00   1.0000e+00

epsilon =

   1.0000e+00   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00

p =

   1.0770e+00   1.6392e+00   3.0047e-01   6.6259e-01   1.3811e+00

S1M =

   1.9543e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -1.2866e-01   3.2409e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   1.5660e-01  -1.2866e-01   1.6749e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -3.2349e-01   7.0756e-01  -6.7962e-01   4.9098e-01   0.0000e+00   0.0000e+00
   8.2115e-01  -2.0012e+00   3.0743e+00  -2.3573e+00   1.3121e+00   0.0000e+00
  -3.1213e-01   1.1866e+00  -2.2564e+00   2.8190e+00  -1.9919e+00   1.0000e+00

c =

  -2.0970e-01   9.6836e-02   1.2070e+00   5.3326e-01   1.2381e-01   4.9343e-02

km =

  -3.9699e-01   9.3499e-01  -6.5887e-01   6.2581e-01  -3.1213e-01

Sm =

  -1.8146e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   7.8488e-02  -1.9771e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -5.2119e-01   4.2820e-01  -5.5743e-01   0.0000e+00   0.0000e+00   0.0000e+00
   4.8823e-01  -1.0679e+00   1.0257e+00  -7.4101e-01   0.0000e+00   0.0000e+00
  -5.9455e-01   1.4489e+00  -2.2259e+00   1.7068e+00  -9.5004e-01   0.0000e+00
   3.1213e-01  -1.1866e+00   2.2564e+00  -2.8190e+00   1.9919e+00  -1.0000e+00

epsilonm =

   1.0000e+00   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00

pm =

   1.0770e+00   1.6392e+00   3.0047e-01   6.6259e-01   1.3811e+00

S1Mm =

  -1.9543e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   1.2866e-01  -3.2409e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -1.5660e-01   1.2866e-01  -1.6749e-01   0.0000e+00   0.0000e+00   0.0000e+00
   3.2349e-01  -7.0756e-01   6.7962e-01  -4.9098e-01   0.0000e+00   0.0000e+00
  -8.2115e-01   2.0012e+00  -3.0743e+00   2.3573e+00  -1.3121e+00   0.0000e+00
   3.1213e-01  -1.1866e+00   2.2564e+00  -2.8190e+00   1.9919e+00  -1.0000e+00

cm =

   2.0970e-01  -9.6836e-02  -1.2070e+00  -5.3326e-01  -1.2381e-01  -4.9343e-02

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
k =

  -2.6973e-01   9.5268e-01   5.5805e-02   4.5026e-01   1.5592e-01

S =

   2.5777e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -7.2203e-02   2.6769e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   8.3893e-01  -4.6380e-01   8.8060e-01   0.0000e+00   0.0000e+00   0.0000e+00
   4.9219e-02   8.1431e-01  -4.1764e-01   8.8197e-01   0.0000e+00   0.0000e+00
   4.4476e-01  -1.5548e-01   1.3226e+00  -4.4292e-01   9.8777e-01   0.0000e+00
   1.5592e-01   3.8035e-01   5.1378e-02   1.3145e+00  -3.7819e-01   1.0000e+00

epsilon =

   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00  -1.0000e+00

p =

   2.4237e+00   3.1959e+00   4.9753e-01   5.2611e-01   8.5453e-01

S1M =

   6.2476e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.3076e-01   8.5551e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   4.1739e-01  -2.3076e-01   4.3812e-01   0.0000e+00   0.0000e+00   0.0000e+00
   2.5895e-02   4.2842e-01  -2.1973e-01   4.6402e-01   0.0000e+00   0.0000e+00
   3.8006e-01  -1.3286e-01   1.1302e+00  -3.7848e-01   8.4408e-01   0.0000e+00
   1.5592e-01   3.8035e-01   5.1378e-02   1.3145e+00  -3.7819e-01   1.0000e+00

c =

   4.4788e-02  -8.5303e-02  -1.0234e-01   9.5001e-01  -5.0329e-01   1.3991e-01

km =

  -2.6973e-01   9.5268e-01   5.5805e-02   4.5026e-01   1.5592e-01

Sm =

  -2.5777e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   7.2203e-02  -2.6769e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -8.3893e-01   4.6380e-01  -8.8060e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -4.9219e-02  -8.1431e-01   4.1764e-01  -8.8197e-01   0.0000e+00   0.0000e+00
  -4.4476e-01   1.5548e-01  -1.3226e+00   4.4292e-01  -9.8777e-01   0.0000e+00
  -1.5592e-01  -3.8035e-01  -5.1378e-02  -1.3145e+00   3.7819e-01  -1.0000e+00

epsilonm =

   1.0000e+00   1.0000e+00  -1.0000e+00  -1.0000e+00  -1.0000e+00

pm =

   2.4237e+00   3.1959e+00   4.9753e-01   5.2611e-01   8.5453e-01

S1Mm =

  -6.2476e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.3076e-01  -8.5551e-01   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -4.1739e-01   2.3076e-01  -4.3812e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -2.5895e-02  -4.2842e-01   2.1973e-01  -4.6402e-01   0.0000e+00   0.0000e+00
  -3.8006e-01   1.3286e-01  -1.1302e+00   3.7848e-01  -8.4408e-01   0.0000e+00
  -1.5592e-01  -3.8035e-01  -5.1378e-02  -1.3145e+00   3.7819e-01  -1.0000e+00

cm =

  -4.4788e-02   8.5303e-02   1.0234e-01  -9.5001e-01   5.0329e-01  -1.3991e-01

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match
#
echo "Running $prog"

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi


#
# this much worked
#
pass

