#!/bin/sh

prog=schurNSscale_test.m
descr="schurNSscale_test.m (mfile)"
depends="schurNSscale_test.m test_common.m schurNSlatticeFilter.m \
schurdecomp.oct schurexpand.oct schurNSscale.m"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $descr 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $descr
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
Caught schurNSscale([],1)!
c is empty
Caught schurNSscale([1 1],[1 1])!
(length(k)+1) ~= length(c)
s10 =    1.0000e+00
s11 =    0.0000e+00
s20 =    1.0000e+00
s00 =    0.0000e+00
s02 =   -1.0000e+00
s22 =    0.0000e+00
k =   -1.5838e-01
S =

   9.8738e-01   0.0000e+00
  -1.5838e-01   1.0000e+00

c =

   4.9369e-01   4.2081e-01

s10 =    4.2081e-01
s11 =    4.9369e-01
s20 =   -1.5838e-01
s00 =    9.8738e-01
s02 =    1.5838e-01
s22 =    9.8738e-01
k =

 Columns 1 through 6:

  -3.6272e-01   9.7439e-01  -6.3391e-01   8.1099e-01  -6.9759e-01   5.4885e-01

 Column 7:

  -2.3909e-01

S =

 Columns 1 through 6:

   5.5143e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.1463e-02   5.9173e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.5641e-01  -1.8846e-01   2.6315e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -2.1569e-01   4.8601e-01  -4.5384e-01   3.4025e-01   0.0000e+00   0.0000e+00
   4.7165e-01  -9.9776e-01   1.5044e+00  -1.0747e+00   5.8157e-01   0.0000e+00
  -5.6622e-01   1.7046e+00  -2.8572e+00   3.0711e+00  -1.9591e+00   8.1168e-01
   5.3293e-01  -1.9637e+00   4.0556e+00  -5.2940e+00   4.7930e+00  -2.7154e+00
  -2.3909e-01   1.2175e+00  -3.2025e+00   5.4802e+00  -6.4507e+00   5.4197e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   9.7100e-01   0.0000e+00
  -2.9278e+00   1.0000e+00

c =

 Columns 1 through 6:

  -1.7905e-01  -1.9168e-01   3.9563e-02   3.7996e-01   3.5656e-01   1.9270e-01

 Columns 7 and 8:

   6.6556e-02   1.3687e-02

s10 =

 Columns 1 through 6:

  -7.3077e-01   1.4915e-01   8.1995e-01   6.0982e-01   3.1302e-01   1.0748e-01

 Column 7:

   1.3687e-02

s11 =

 Columns 1 through 6:

  -6.8262e-01   9.8881e-01   5.7244e-01   7.9254e-01   9.4975e-01   9.9421e-01

 Column 7:

   6.1922e-01

s20 =

 Columns 1 through 6:

  -3.6272e-01   9.7439e-01  -6.3391e-01   8.1099e-01  -6.9759e-01   5.4885e-01

 Column 7:

  -2.3909e-01

s00 =

 Columns 1 through 6:

   9.3190e-01   2.2486e-01   7.7340e-01   5.8506e-01   7.1650e-01   8.3592e-01

 Column 7:

   9.7100e-01

s02 =

 Columns 1 through 6:

   3.6272e-01  -9.7439e-01   6.3391e-01  -8.1099e-01   6.9759e-01  -5.4885e-01

 Column 7:

   2.3909e-01

s22 =

 Columns 1 through 6:

   9.3190e-01   2.2486e-01   7.7340e-01   5.8506e-01   7.1650e-01   8.3592e-01

 Column 7:

   9.7100e-01

km =

 Columns 1 through 6:

  -3.6272e-01   9.7439e-01  -6.3391e-01   8.1099e-01  -6.9759e-01   5.4885e-01

 Column 7:

  -2.3909e-01

Sm =

 Columns 1 through 6:

  -5.5143e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.1463e-02  -5.9173e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.5641e-01   1.8846e-01  -2.6315e-01   0.0000e+00   0.0000e+00   0.0000e+00
   2.1569e-01  -4.8601e-01   4.5384e-01  -3.4025e-01   0.0000e+00   0.0000e+00
  -4.7165e-01   9.9776e-01  -1.5044e+00   1.0747e+00  -5.8157e-01   0.0000e+00
   5.6622e-01  -1.7046e+00   2.8572e+00  -3.0711e+00   1.9591e+00  -8.1168e-01
  -5.3293e-01   1.9637e+00  -4.0556e+00   5.2940e+00  -4.7930e+00   2.7154e+00
   2.3909e-01  -1.2175e+00   3.2025e+00  -5.4802e+00   6.4507e+00  -5.4197e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -9.7100e-01   0.0000e+00
   2.9278e+00  -1.0000e+00

cm =

 Columns 1 through 6:

   1.7905e-01   1.9168e-01  -3.9563e-02  -3.7996e-01  -3.5656e-01  -1.9270e-01

 Columns 7 and 8:

  -6.6556e-02  -1.3687e-02

s10m =

 Columns 1 through 6:

   7.3077e-01  -1.4915e-01  -8.1995e-01  -6.0982e-01  -3.1302e-01  -1.0748e-01

 Column 7:

  -1.3687e-02

s11m =

 Columns 1 through 6:

   6.8262e-01   9.8881e-01   5.7244e-01   7.9254e-01   9.4975e-01   9.9421e-01

 Column 7:

   6.1922e-01

s20m =

 Columns 1 through 6:

  -3.6272e-01   9.7439e-01  -6.3391e-01   8.1099e-01  -6.9759e-01   5.4885e-01

 Column 7:

  -2.3909e-01

s00m =

 Columns 1 through 6:

   9.3190e-01   2.2486e-01   7.7340e-01   5.8506e-01   7.1650e-01   8.3592e-01

 Column 7:

   9.7100e-01

s02m =

 Columns 1 through 6:

   3.6272e-01  -9.7439e-01   6.3391e-01  -8.1099e-01   6.9759e-01  -5.4885e-01

 Column 7:

   2.3909e-01

s22m =

 Columns 1 through 6:

   9.3190e-01   2.2486e-01   7.7340e-01   5.8506e-01   7.1650e-01   8.3592e-01

 Column 7:

   9.7100e-01

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
stdxf =

 Columns 1 through 6:

   1.2532e+02   1.2501e+02   1.2843e+02   1.2857e+02   1.3100e+02   1.2894e+02

 Column 7:

   1.2866e+02

k =

 Columns 1 through 6:

  -2.8299e-01   9.8644e-01  -7.3636e-02   7.8065e-01   2.4364e-01   2.9087e-01

 Column 7:

   1.1369e-01

S =

 Columns 1 through 6:

   9.0447e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.6686e-02   9.4302e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   5.6682e-01  -3.2301e-01   5.7461e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -4.2427e-02   5.9221e-01  -3.6574e-01   5.7617e-01   0.0000e+00   0.0000e+00
   7.1969e-01  -5.2472e-01   1.6873e+00  -6.3820e-01   9.2191e-01   0.0000e+00
   2.3159e-01   5.8173e-01  -1.1716e-01   1.6079e+00  -4.7724e-01   9.5056e-01
   2.8899e-01   9.6972e-02   1.0968e+00  -1.5808e-01   1.8574e+00  -4.2839e-01
   1.1369e-01   2.4185e-01   3.1016e-01   1.0859e+00  -3.3588e-02   1.8806e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   9.9352e-01   0.0000e+00
  -3.9812e-01   1.0000e+00

k =

 Columns 1 through 6:

  -2.8299e-01   9.8644e-01  -7.3636e-02   7.8065e-01   2.4364e-01   2.9087e-01

 Column 7:

   1.1369e-01

S =

 Columns 1 through 6:

   9.0447e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.6686e-02   9.4302e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   5.6682e-01  -3.2301e-01   5.7461e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -4.2427e-02   5.9221e-01  -3.6574e-01   5.7617e-01   0.0000e+00   0.0000e+00
   7.1969e-01  -5.2472e-01   1.6873e+00  -6.3820e-01   9.2191e-01   0.0000e+00
   2.3159e-01   5.8173e-01  -1.1716e-01   1.6079e+00  -4.7724e-01   9.5056e-01
   2.8899e-01   9.6972e-02   1.0968e+00  -1.5808e-01   1.8574e+00  -4.2839e-01
   1.1369e-01   2.4185e-01   3.1016e-01   1.0859e+00  -3.3588e-02   1.8806e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   9.9352e-01   0.0000e+00
  -3.9812e-01   1.0000e+00

c =

 Columns 1 through 6:

  -2.2955e-01  -8.7552e-03   2.6614e-01  -1.2044e-01  -3.3385e-01   4.9552e-01

 Columns 7 and 8:

  -2.7118e-01   6.1456e-02

s10 =

 Columns 1 through 6:

  -3.8113e-02   7.5701e-01  -3.2409e-01  -6.6829e-01   7.0423e-01  -3.5961e-01

 Column 7:

   6.1456e-02

s11 =

 Columns 1 through 6:

  -9.9927e-01   6.5341e-01   9.4603e-01   7.4390e-01   7.0998e-01   9.3310e-01

 Column 7:

   7.5408e-01

s20 =

 Columns 1 through 6:

  -2.8299e-01   9.8644e-01  -7.3636e-02   7.8065e-01   2.4364e-01   2.9087e-01

 Column 7:

   1.1369e-01

s00 =

 Columns 1 through 6:

   9.5912e-01   1.6412e-01   9.9729e-01   6.2497e-01   9.6987e-01   9.5676e-01

 Column 7:

   9.9352e-01

s02 =

 Columns 1 through 6:

   2.8299e-01  -9.8644e-01   7.3636e-02  -7.8065e-01  -2.4364e-01  -2.9087e-01

 Column 7:

  -1.1369e-01

s22 =

 Columns 1 through 6:

   9.5912e-01   1.6412e-01   9.9729e-01   6.2497e-01   9.6987e-01   9.5676e-01

 Column 7:

   9.9352e-01

km =

 Columns 1 through 6:

  -2.8299e-01   9.8644e-01  -7.3636e-02   7.8065e-01   2.4364e-01   2.9087e-01

 Column 7:

   1.1369e-01

Sm =

 Columns 1 through 6:

  -9.0447e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.6686e-02  -9.4302e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -5.6682e-01   3.2301e-01  -5.7461e-01   0.0000e+00   0.0000e+00   0.0000e+00
   4.2427e-02  -5.9221e-01   3.6574e-01  -5.7617e-01   0.0000e+00   0.0000e+00
  -7.1969e-01   5.2472e-01  -1.6873e+00   6.3820e-01  -9.2191e-01   0.0000e+00
  -2.3159e-01  -5.8173e-01   1.1716e-01  -1.6079e+00   4.7724e-01  -9.5056e-01
  -2.8899e-01  -9.6972e-02  -1.0968e+00   1.5808e-01  -1.8574e+00   4.2839e-01
  -1.1369e-01  -2.4185e-01  -3.1016e-01  -1.0859e+00   3.3588e-02  -1.8806e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -9.9352e-01   0.0000e+00
   3.9812e-01  -1.0000e+00

cm =

 Columns 1 through 6:

   2.2955e-01   8.7552e-03  -2.6614e-01   1.2044e-01   3.3385e-01  -4.9552e-01

 Columns 7 and 8:

   2.7118e-01  -6.1456e-02

s10m =

 Columns 1 through 6:

   3.8113e-02  -7.5701e-01   3.2409e-01   6.6829e-01  -7.0423e-01   3.5961e-01

 Column 7:

  -6.1456e-02

s11m =

 Columns 1 through 6:

   9.9927e-01   6.5341e-01   9.4603e-01   7.4390e-01   7.0998e-01   9.3310e-01

 Column 7:

   7.5408e-01

s20m =

 Columns 1 through 6:

  -2.8299e-01   9.8644e-01  -7.3636e-02   7.8065e-01   2.4364e-01   2.9087e-01

 Column 7:

   1.1369e-01

s00m =

 Columns 1 through 6:

   9.5912e-01   1.6412e-01   9.9729e-01   6.2497e-01   9.6987e-01   9.5676e-01

 Column 7:

   9.9352e-01

s02m =

 Columns 1 through 6:

   2.8299e-01  -9.8644e-01   7.3636e-02  -7.8065e-01  -2.4364e-01  -2.9087e-01

 Column 7:

  -1.1369e-01

s22m =

 Columns 1 through 6:

   9.5912e-01   1.6412e-01   9.9729e-01   6.2497e-01   9.6987e-01   9.5676e-01

 Column 7:

   9.9352e-01

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
k =

 Columns 1 through 6:

  -8.4280e-01   9.8412e-01  -9.2820e-01   9.4426e-01  -9.2758e-01   8.5895e-01

 Column 7:

  -4.8851e-01

S =

 Columns 1 through 6:

   1.9535e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -3.0590e-03   3.6295e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   2.0124e-02  -3.4195e-02   2.0449e-02   0.0000e+00   0.0000e+00   0.0000e+00
  -5.1011e-02   1.3939e-01  -1.4210e-01   5.4957e-02   0.0000e+00   0.0000e+00
   1.5763e-01  -5.6253e-01   8.2318e-01  -5.7795e-01   1.6694e-01   0.0000e+00
  -4.1445e-01   1.8568e+00  -3.5493e+00   3.5999e+00  -1.9383e+00   4.4681e-01
   7.4948e-01  -4.0606e+00   9.6645e+00  -1.2885e+01   1.0145e+01  -4.4804e+00
  -4.8851e-01   3.3673e+00  -1.0333e+01   1.8290e+01  -2.0178e+01   1.3900e+01

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   8.7256e-01   0.0000e+00
  -5.5544e+00   1.0000e+00

c =

 Columns 1 through 6:

  -1.5000e-02   2.4955e-01   2.7252e-01   2.0692e-01   1.0782e-01   3.5239e-02

 Columns 7 and 8:

   9.9566e-03   2.6796e-03

s10 =

 Columns 1 through 6:

   9.9820e-01   7.3690e-01   4.8828e-01   2.4657e-01   8.0329e-02   2.2691e-02

 Column 7:

   2.6796e-03

s11 =

 Columns 1 through 6:

  -6.0000e-02   6.7601e-01   8.7268e-01   9.6913e-01   9.9677e-01   9.9974e-01

 Column 7:

   4.3880e-01

s20 =

 Columns 1 through 6:

  -8.4280e-01   9.8412e-01  -9.2820e-01   9.4426e-01  -9.2758e-01   8.5895e-01

 Column 7:

  -4.8851e-01

s00 =

 Columns 1 through 6:

   5.3823e-01   1.7749e-01   3.7209e-01   3.2921e-01   3.7362e-01   5.1207e-01

 Column 7:

   8.7256e-01

s02 =

 Columns 1 through 6:

   8.4280e-01  -9.8412e-01   9.2820e-01  -9.4426e-01   9.2758e-01  -8.5895e-01

 Column 7:

   4.8851e-01

s22 =

 Columns 1 through 6:

   5.3823e-01   1.7749e-01   3.7209e-01   3.2921e-01   3.7362e-01   5.1207e-01

 Column 7:

   8.7256e-01

km =

 Columns 1 through 6:

  -8.4280e-01   9.8412e-01  -9.2820e-01   9.4426e-01  -9.2758e-01   8.5895e-01

 Column 7:

  -4.8851e-01

Sm =

 Columns 1 through 6:

  -1.9535e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   3.0590e-03  -3.6295e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -2.0124e-02   3.4195e-02  -2.0449e-02   0.0000e+00   0.0000e+00   0.0000e+00
   5.1011e-02  -1.3939e-01   1.4210e-01  -5.4957e-02   0.0000e+00   0.0000e+00
  -1.5763e-01   5.6253e-01  -8.2318e-01   5.7795e-01  -1.6694e-01   0.0000e+00
   4.1445e-01  -1.8568e+00   3.5493e+00  -3.5999e+00   1.9383e+00  -4.4681e-01
  -7.4948e-01   4.0606e+00  -9.6645e+00   1.2885e+01  -1.0145e+01   4.4804e+00
   4.8851e-01  -3.3673e+00   1.0333e+01  -1.8290e+01   2.0178e+01  -1.3900e+01

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -8.7256e-01   0.0000e+00
   5.5544e+00  -1.0000e+00

cm =

 Columns 1 through 6:

   1.5000e-02  -2.4955e-01  -2.7252e-01  -2.0692e-01  -1.0782e-01  -3.5239e-02

 Columns 7 and 8:

  -9.9566e-03  -2.6796e-03

s10m =

 Columns 1 through 6:

  -9.9820e-01  -7.3690e-01  -4.8828e-01  -2.4657e-01  -8.0329e-02  -2.2691e-02

 Column 7:

  -2.6796e-03

s11m =

 Columns 1 through 6:

   6.0000e-02   6.7601e-01   8.7268e-01   9.6913e-01   9.9677e-01   9.9974e-01

 Column 7:

   4.3880e-01

s20m =

 Columns 1 through 6:

  -8.4280e-01   9.8412e-01  -9.2820e-01   9.4426e-01  -9.2758e-01   8.5895e-01

 Column 7:

  -4.8851e-01

s00m =

 Columns 1 through 6:

   5.3823e-01   1.7749e-01   3.7209e-01   3.2921e-01   3.7362e-01   5.1207e-01

 Column 7:

   8.7256e-01

s02m =

 Columns 1 through 6:

   8.4280e-01  -9.8412e-01   9.2820e-01  -9.4426e-01   9.2758e-01  -8.5895e-01

 Column 7:

   4.8851e-01

s22m =

 Columns 1 through 6:

   5.3823e-01   1.7749e-01   3.7209e-01   3.2921e-01   3.7362e-01   5.1207e-01

 Column 7:

   8.7256e-01

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
k =

 Columns 1 through 6:

  -8.0459e-01   9.9615e-01  -7.7401e-01   9.3306e-01  -5.8373e-01   4.1918e-01

 Column 7:

  -8.5391e-03

S =

 Columns 1 through 6:

   8.7457e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -1.1850e-02   1.4728e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   1.6726e-01  -2.6967e-01   1.6790e-01   0.0000e+00   0.0000e+00   0.0000e+00
  -2.0525e-01   5.9380e-01  -6.3035e-01   2.6517e-01   0.0000e+00   0.0000e+00
   6.8780e-01  -2.2055e+00   3.1908e+00  -2.2846e+00   7.3714e-01   0.0000e+00
  -5.2995e-01   2.4896e+00  -5.0103e+00   5.5154e+00  -3.3082e+00   9.0787e-01
   4.1917e-01  -2.1111e+00   5.2886e+00  -7.8318e+00   7.2243e+00  -3.8885e+00
  -8.5391e-03   4.5239e-01  -2.1729e+00   5.3557e+00  -7.8772e+00   7.2426e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   9.9996e-01   0.0000e+00
  -3.8922e+00   1.0000e+00

c =

 Columns 1 through 6:

   1.2085e-01   1.4176e-01  -1.8853e-01  -1.7954e-01   2.7302e-01   3.2201e-01

 Columns 7 and 8:

  -6.4574e-01   2.5098e-01

s10 =

 Columns 1 through 6:

   7.6101e-01  -7.1133e-01  -5.6086e-01   6.4891e-01   6.0777e-01  -7.7308e-01

 Column 7:

   2.5098e-01

s11 =

 Columns 1 through 6:

   6.4874e-01   7.0286e-01   8.2791e-01   7.6086e-01   7.9411e-01   6.3430e-01

 Column 7:

   8.3528e-01

s20 =

 Columns 1 through 6:

  -8.0459e-01   9.9615e-01  -7.7401e-01   9.3306e-01  -5.8373e-01   4.1918e-01

 Column 7:

  -8.5391e-03

s00 =

 Columns 1 through 6:

   5.9383e-01   8.7715e-02   6.3318e-01   3.5973e-01   8.1195e-01   9.0790e-01

 Column 7:

   9.9996e-01

s02 =

 Columns 1 through 6:

   8.0459e-01  -9.9615e-01   7.7401e-01  -9.3306e-01   5.8373e-01  -4.1918e-01

 Column 7:

   8.5391e-03

s22 =

 Columns 1 through 6:

   5.9383e-01   8.7715e-02   6.3318e-01   3.5973e-01   8.1195e-01   9.0790e-01

 Column 7:

   9.9996e-01

km =

 Columns 1 through 6:

  -8.0459e-01   9.9615e-01  -7.7401e-01   9.3306e-01  -5.8373e-01   4.1918e-01

 Column 7:

  -8.5391e-03

Sm =

 Columns 1 through 6:

  -8.7457e-03   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
   1.1850e-02  -1.4728e-02   0.0000e+00   0.0000e+00   0.0000e+00   0.0000e+00
  -1.6726e-01   2.6967e-01  -1.6790e-01   0.0000e+00   0.0000e+00   0.0000e+00
   2.0525e-01  -5.9380e-01   6.3035e-01  -2.6517e-01   0.0000e+00   0.0000e+00
  -6.8780e-01   2.2055e+00  -3.1908e+00   2.2846e+00  -7.3714e-01   0.0000e+00
   5.2995e-01  -2.4896e+00   5.0103e+00  -5.5154e+00   3.3082e+00  -9.0787e-01
  -4.1917e-01   2.1111e+00  -5.2886e+00   7.8318e+00  -7.2243e+00   3.8885e+00
   8.5391e-03  -4.5239e-01   2.1729e+00  -5.3557e+00   7.8772e+00  -7.2426e+00

 Columns 7 and 8:

   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
   0.0000e+00   0.0000e+00
  -9.9996e-01   0.0000e+00
   3.8922e+00  -1.0000e+00

cm =

 Columns 1 through 6:

  -1.2085e-01  -1.4176e-01   1.8853e-01   1.7954e-01  -2.7302e-01  -3.2201e-01

 Columns 7 and 8:

   6.4574e-01  -2.5098e-01

s10m =

 Columns 1 through 6:

  -7.6101e-01   7.1133e-01   5.6086e-01  -6.4891e-01  -6.0777e-01   7.7308e-01

 Column 7:

  -2.5098e-01

s11m =

 Columns 1 through 6:

  -6.4874e-01   7.0286e-01   8.2791e-01   7.6086e-01   7.9411e-01   6.3430e-01

 Column 7:

   8.3528e-01

s20m =

 Columns 1 through 6:

  -8.0459e-01   9.9615e-01  -7.7401e-01   9.3306e-01  -5.8373e-01   4.1918e-01

 Column 7:

  -8.5391e-03

s00m =

 Columns 1 through 6:

   5.9383e-01   8.7715e-02   6.3318e-01   3.5973e-01   8.1195e-01   9.0790e-01

 Column 7:

   9.9996e-01

s02m =

 Columns 1 through 6:

   8.0459e-01  -9.9615e-01   7.7401e-01  -9.3306e-01   5.8373e-01  -4.1918e-01

 Column 7:

   8.5391e-03

s22m =

 Columns 1 through 6:

   5.9383e-01   8.7715e-02   6.3318e-01   3.5973e-01   8.1195e-01   9.0790e-01

 Column 7:

   9.9996e-01

ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
ans =    0.0000e+00
EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match. Suppress m-file warnings.
#
echo "Running $descr"
echo "warning('off');" >> .octaverc

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $descr"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi


#
# this much worked
#
pass

