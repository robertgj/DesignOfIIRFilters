#!/bin/sh

prog=orthogonaliseTF_test.m

depends="orthogonaliseTF_test.m test_common.m \
schurexpand.oct schurdecomp.oct \
orthogonaliseTF.m tf2Abcd.m schurOneMscale.m tf2schurOneMlattice.m \
tf2schurNSlattice.m schurNSlattice2Abcd.oct schurNSscale.oct \
schurOneMlattice2Abcd.oct C1D1FToG0primeFprime.m FprimeToFdoubleprime.m \
factorFdoubleprime.m Abcd2tf.m KW.m optKW.m"
tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED ${0#$here"/"} $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED ${0#$here"/"} $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
max(max(abs(G0doubleprime - G0prime)))=0.000000
max(max(abs(Ftest - Fdoubleprime)))=0.000000
G0prime =
 Columns 1 through 8:
   1.0000        0        0        0        0        0        0        0
        0   1.0000        0        0        0        0        0        0
        0        0   1.0000        0        0        0        0        0
        0        0        0   1.0000        0        0        0        0
        0        0        0        0   1.0000        0        0        0
        0        0        0        0        0   1.0000        0        0
        0        0        0        0        0        0   1.0000        0
        0        0        0        0        0        0        0   1.0000
        0        0        0        0        0        0        0        0
   0.0000        0   0.0000   0.0000  -0.0000        0  -0.0000  -0.0000
 Columns 9 and 10:
        0        0
        0        0
        0        0
        0        0
        0        0
        0        0
        0        0
        0        0
   1.0000        0
   0.3155   0.0068

Tq =
{
  [1,1] =
   Columns 1 through 8:
     0.9998  -0.0209        0        0        0        0        0        0
     0.0209   0.9998        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [2,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9906  -0.1366        0        0        0        0        0
          0   0.1366   0.9906        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [3,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.9946  -0.1037        0        0        0        0
          0        0   0.1037   0.9946        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [4,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   0.9897  -0.1431        0        0        0
          0        0        0   0.1431   0.9897        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [5,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   0.9847  -0.1741        0        0
          0        0        0        0   0.1741   0.9847        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [6,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   0.9787  -0.2055        0
          0        0        0        0        0   0.2055   0.9787        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [7,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   0.9410  -0.3383
          0        0        0        0        0        0   0.3383   0.9410
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [8,1] =
   Columns 1 through 8:
     0.1756  -0.9845        0        0        0        0        0        0
     0.9845   0.1756        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [9,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.8424  -0.5388        0        0        0        0        0
          0   0.5388   0.8424        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [10,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.1061   0.9944        0        0        0        0
          0        0  -0.9944   0.1061        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [11,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   0.6262   0.7797        0        0        0
          0        0        0  -0.7797   0.6262        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [12,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   0.0789   0.9969        0        0
          0        0        0        0  -0.9969   0.0789        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [13,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   0.2247   0.9744        0
          0        0        0        0        0  -0.9744   0.2247        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [14,1] =
   Columns 1 through 8:
     0.9743  -0.2254        0        0        0        0        0        0
     0.2254   0.9743        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [15,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9984   0.0569        0        0        0        0        0
          0  -0.0569   0.9984        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [16,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.9836  -0.1805        0        0        0        0
          0        0   0.1805   0.9836        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [17,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   0.9906  -0.1369        0        0        0
          0        0        0   0.1369   0.9906        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [18,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   0.9775  -0.2107        0        0
          0        0        0        0   0.2107   0.9775        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [19,1] =
   Columns 1 through 8:
     0.2268   0.9739        0        0        0        0        0        0
    -0.9739   0.2268        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [20,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9343  -0.3566        0        0        0        0        0
          0   0.3566   0.9343        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [21,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.1317   0.9913        0        0        0        0
          0        0  -0.9913   0.1317        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [22,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   0.6754   0.7374        0        0        0
          0        0        0  -0.7374   0.6754        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [23,1] =
   Columns 1 through 8:
     0.9874  -0.1583        0        0        0        0        0        0
     0.1583   0.9874        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [24,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9979   0.0652        0        0        0        0        0
          0  -0.0652   0.9979        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [25,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.9827  -0.1852        0        0        0        0
          0        0   0.1852   0.9827        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [26,1] =
   Columns 1 through 8:
     0.1543   0.9880        0        0        0        0        0        0
    -0.9880   0.1543        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [27,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9225  -0.3859        0        0        0        0        0
          0   0.3859   0.9225        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [28,1] =
   Columns 1 through 8:
     0.9859  -0.1674        0        0        0        0        0        0
     0.1674   0.9859        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
}

Fq =
{
  [1,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   0.0502
          0        0        0        0        0        0        0   0.9987
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
    -0.9987        0
     0.0502        0
          0   1.0000
  [2,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   0.9836  -0.1803
          0        0        0        0        0        0   0.1803   0.9836
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [3,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   0.2344  -0.9722        0
          0        0        0        0        0   0.9722   0.2344        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [4,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   0.9869  -0.1612        0        0
          0        0        0        0   0.1612   0.9869        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [5,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   0.6803  -0.7330        0        0        0
          0        0        0   0.7330   0.6803        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [6,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.9888  -0.1491        0        0        0        0
          0        0   0.1491   0.9888        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [7,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9231   0.3847        0        0        0        0        0
          0  -0.3847   0.9231        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [8,1] =
   Columns 1 through 8:
     0.9881  -0.1540        0        0        0        0        0        0
     0.1540   0.9881        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [9,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     0.5960  -0.8030
     0.8030   0.5960
  [10,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   0.0431
          0        0        0        0        0        0        0  -0.9991
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     0.9991        0
     0.0431        0
          0   1.0000
  [11,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   0.9410  -0.3383
          0        0        0        0        0        0   0.3383   0.9410
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [12,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   0.2247   0.9744        0
          0        0        0        0        0  -0.9744   0.2247        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [13,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   0.9775  -0.2107        0        0
          0        0        0        0   0.2107   0.9775        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [14,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   0.6754   0.7374        0        0        0
          0        0        0  -0.7374   0.6754        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [15,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   1.0000        0        0        0        0        0        0
          0        0   0.9827  -0.1852        0        0        0        0
          0        0   0.1852   0.9827        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [16,1] =
   Columns 1 through 8:
     1.0000        0        0        0        0        0        0        0
          0   0.9225  -0.3859        0        0        0        0        0
          0   0.3859   0.9225        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
  [17,1] =
   Columns 1 through 8:
     0.9859  -0.1674        0        0        0        0        0        0
     0.1674   0.9859        0        0        0        0        0        0
          0        0   1.0000        0        0        0        0        0
          0        0        0   1.0000        0        0        0        0
          0        0        0        0   1.0000        0        0        0
          0        0        0        0        0   1.0000        0        0
          0        0        0        0        0        0   1.0000        0
          0        0        0        0        0        0        0   1.0000
          0        0        0        0        0        0        0        0
          0        0        0        0        0        0        0        0
   Columns 9 and 10:
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
          0        0
     1.0000        0
          0   1.0000
}

Fsign =
 Columns 1 through 8:
   1.0000   0.0000   0.0000  -0.0000   0.0000   0.0000  -0.0000   0.0000
   0.0000   1.0000  -0.0000   0.0000  -0.0000   0.0000  -0.0000   0.0000
  -0.0000   0.0000   1.0000        0  -0.0000   0.0000   0.0000   0.0000
   0.0000  -0.0000   0.0000   1.0000  -0.0000   0.0000  -0.0000  -0.0000
  -0.0000   0.0000  -0.0000   0.0000   1.0000  -0.0000  -0.0000  -0.0000
  -0.0000   0.0000   0.0000  -0.0000   0.0000   1.0000  -0.0000   0.0000
  -0.0000   0.0000  -0.0000   0.0000   0.0000   0.0000   1.0000   0.0000
   0.0000   0.0000   0.0000   0.0000  -0.0000  -0.0000   0.0000   1.0000
  -0.0000   0.0000   0.0000  -0.0000   0.0000   0.0000  -0.0000  -0.0000
  -0.0000  -0.0000  -0.0000  -0.0000   0.0000  -0.0000  -0.0000   0.0000
 Columns 9 and 10:
  -0.0000  -0.0000
  -0.0000   0.0000
  -0.0000   0.0000
  -0.0000   0.0000
  -0.0000  -0.0000
   0.0000  -0.0000
   0.0000  -0.0000
   0.0000  -0.0000
   1.0000  -0.0000
  -0.0000  -1.0000

Found 28 non-trivial rotations (of 28) in Tq
Found 17 non-trivial rotations (of 17) in Fq
max(abs(n-nn))=0.000000
max(abs(d-dd))=0.000000
ng = 2.8273
ngopt = 1.6393
EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match
#
echo "Running $prog"

octave-cli -q $prog >test.out 2>&1
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi


#
# this much worked
#
pass

