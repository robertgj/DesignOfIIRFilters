#!/bin/sh

prog=zolotarev_vlcek_zahradnik_test.m

depends="zolotarev_vlcek_zahradnik_test.m zolotarev_vlcek_zahradnik.m \
test_common.m zolotarev_chen_parks.m zolotarev_vlcek_unbehauen.m \
elliptic_F.m elliptic_E.m jacobi_Eta.m jacobi_Theta.m jacobi_Zeta.m \
jacobi_theta1.m jacobi_theta1k.m jacobi_theta2.m jacobi_theta2k.m \
jacobi_theta3.m jacobi_theta3k.m jacobi_theta4.m jacobi_theta4k.m \
jacobi_theta2p.m jacobi_theta4p.m jacobi_theta4kp.m \
carlson_RJ.m carlson_RD.m carlson_RC.m carlson_RF.m \
chebychevP.m chebychevT.m chebychevU.m \
chebychevP_backward_recurrence.m chebychevT_backward_recurrence.m \
chebychevU_backward_recurrence.m print_polynomial.m"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED ${0#$here"/"} $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED ${0#$here"/"} $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test_p_4_q_11_generator.ok << 'EOF'
Spq_4_11 = [  38786.9521326013,   4952.0784724136, -136236.7742741076, -17885.2310204815, ... 
             189461.1918963988,  25144.3377725513, -132143.2526806119, -17168.9266419172, ... 
              48227.1793650686,   5753.7134319685,  -8745.7208016871,   -836.9833835704, ... 
                681.3381263128,     41.5325084764,    -15.1250439406,     -0.3098594749 ];
EOF
if [ $? -ne 0 ]; then echo "Failed cat test_p_4_q_11_generator.ok"; fail; fi

cat > test_p_4_q_11_a_coef.ok << 'EOF'
a_4_11 = [   0.3018151112,   0.4512145672,   0.2822759289,   0.0868799820, ... 
            -0.0561809419,  -0.1053948923,  -0.0720513180,  -0.0045415003, ... 
             0.0453863810,   0.0518476231,   0.0229242778,  -0.0132284961, ... 
            -0.0312378770,  -0.0240752981,  -0.0030110098,   0.0144231969, ... 
             0.0529542655 ];
EOF
if [ $? -ne 0 ]; then echo "Failed cat test_p_4_q_11_a_coef.ok"; fail; fi

cat > test_p_4_q_11_h_coef.ok << 'EOF'
h_4_11 = [   0.0264771327,   0.0072115984,  -0.0015055049,  -0.0120376491, ... 
            -0.0156189385,  -0.0066142480,   0.0114621389,   0.0259238116, ... 
             0.0226931905,  -0.0022707502,  -0.0360256590,  -0.0526974461, ... 
            -0.0280904709,   0.0434399910,   0.1411379644,   0.2256072836, ... 
             0.3018151112,   0.2256072836,   0.1411379644,   0.0434399910, ... 
            -0.0280904709,  -0.0526974461,  -0.0360256590,  -0.0022707502, ... 
             0.0226931905,   0.0259238116,   0.0114621389,  -0.0066142480, ... 
            -0.0156189385,  -0.0120376491,  -0.0015055049,   0.0072115984, ... 
             0.0264771327 ];
EOF
if [ $? -ne 0 ]; then echo "Failed cat test_p_4_q_11_h_coef.ok"; fail; fi

cat > test_p_100_q_300_h_coef.ok << 'EOF'
h_100_300 = [   0.0021272290,   0.0000788549,   0.0000010155,  -0.0000798704, ... 
               -0.0001155145,  -0.0000831915,  -0.0000001310,   0.0000855564, ... 
                0.0001227135,   0.0000876462,  -0.0000008678,  -0.0000915244, ... 
               -0.0001301968,  -0.0000922186,   0.0000019879,   0.0000977841, ... 
                0.0001379711,   0.0000969083,  -0.0000032365,  -0.0001043451, ... 
               -0.0001460429,  -0.0001017147,   0.0000046210,   0.0001112175, ... 
                0.0001544188,   0.0001066372,  -0.0000061492,  -0.0001184113, ... 
               -0.0001631055,  -0.0001116750,   0.0000078289,   0.0001259372, ... 
                0.0001721099,   0.0001168270,  -0.0000096683,  -0.0001338057, ... 
               -0.0001814387,  -0.0001220923,   0.0000116760,   0.0001420278, ... 
                0.0001910989,   0.0001274695,  -0.0000138607,  -0.0001506147, ... 
               -0.0002010976,  -0.0001329574,   0.0000162314,   0.0001595779, ... 
                0.0002114419,   0.0001385545,  -0.0000187975,  -0.0001689292, ... 
               -0.0002221391,  -0.0001442592,   0.0000215686,   0.0001786806, ... 
                0.0002331966,   0.0001500698,  -0.0000245547,  -0.0001888446, ... 
               -0.0002446219,  -0.0001559843,   0.0000277661,   0.0001994340, ... 
                0.0002564227,   0.0001620007,  -0.0000312134,  -0.0002104617, ... 
               -0.0002686068,  -0.0001681170,   0.0000349077,   0.0002219413, ... 
                0.0002811823,   0.0001743308,  -0.0000388602,  -0.0002338867, ... 
               -0.0002941573,  -0.0001806398,   0.0000430828,   0.0002463121, ... 
                0.0003075403,   0.0001870414,  -0.0000475876,  -0.0002592322, ... 
               -0.0003213398,  -0.0001935330,   0.0000523872,   0.0002726624, ... 
                0.0003355649,   0.0002001117,  -0.0000574945,  -0.0002866183, ... 
               -0.0003502246,  -0.0002067746,   0.0000629232,   0.0003011162, ... 
                0.0003653285,   0.0002135187,  -0.0000686872,  -0.0003161729, ... 
               -0.0003808863,  -0.0002203409,   0.0000748009,   0.0003318059, ... 
                0.0003969082,   0.0002272377,  -0.0000812794,  -0.0003480332, ... 
               -0.0004134047,  -0.0002342059,   0.0000881384,   0.0003648739, ... 
                0.0004303868,   0.0002412419,  -0.0000953940,  -0.0003823474, ... 
               -0.0004478660,  -0.0002483420,   0.0001030632,   0.0004004741, ... 
                0.0004658542,   0.0002555025,  -0.0001111636,  -0.0004192755, ... 
               -0.0004843639,  -0.0002627196,   0.0001197134,   0.0004387736, ... 
                0.0005034083,   0.0002699892,  -0.0001287318,  -0.0004589920, ... 
               -0.0005230012,  -0.0002773073,   0.0001382387,   0.0004799549, ... 
                0.0005431570,   0.0002846697,  -0.0001482551,  -0.0005016880, ... 
               -0.0005638913,  -0.0002920721,   0.0001588027,   0.0005242182, ... 
                0.0005852201,   0.0002995102,  -0.0001699045,  -0.0005475739, ... 
               -0.0006071607,  -0.0003069795,   0.0001815845,   0.0005717851, ... 
                0.0006297312,   0.0003144755,  -0.0001938678,  -0.0005968831, ... 
               -0.0006529512,  -0.0003219936,   0.0002067812,   0.0006229016, ... 
                0.0006768411,   0.0003295290,  -0.0002203525,  -0.0006498758, ... 
               -0.0007014232,  -0.0003370771,   0.0002346114,   0.0006778433, ... 
                0.0007267208,   0.0003446329,  -0.0002495891,  -0.0007068441, ... 
               -0.0007527594,  -0.0003521915,   0.0002653186,   0.0007369206, ... 
                0.0007795658,   0.0003597481,  -0.0002818350,  -0.0007681183, ... 
               -0.0008071692,  -0.0003672976,   0.0002991756,   0.0008004856, ... 
                0.0008356009,   0.0003748348,  -0.0003173800,  -0.0008340745, ... 
               -0.0008648946,  -0.0003823548,   0.0003364906,   0.0008689406, ... 
                0.0008950868,   0.0003898524,  -0.0003565525,  -0.0009051436, ... 
               -0.0009262169,  -0.0003973223,   0.0003776141,   0.0009427481, ... 
                0.0009583275,   0.0004047594,  -0.0003997273,  -0.0009818234, ... 
               -0.0009914650,  -0.0004121585,   0.0004229477,   0.0010224445, ... 
                0.0010256799,   0.0004195142,  -0.0004473353,  -0.0010646927, ... 
               -0.0010610269,  -0.0004268214,   0.0004729550,   0.0011086561, ... 
                0.0010975660,   0.0004340748,  -0.0004998767,  -0.0011544303, ... 
               -0.0011353625,  -0.0004412690,   0.0005281763,   0.0012021197, ... 
                0.0011744882,   0.0004483988,  -0.0005579363,  -0.0012518382, ... 
               -0.0012150216,  -0.0004554590,   0.0005892466,   0.0013037102, ... 
                0.0012570490,   0.0004624444,  -0.0006222050,  -0.0013578723, ... 
               -0.0013006657,  -0.0004693496,   0.0006569189,   0.0014144745, ... 
                0.0013459765,   0.0004761695,  -0.0006935061,  -0.0014736821, ... 
               -0.0013930976,  -0.0004828990,   0.0007320960,   0.0015356776, ... 
                0.0014421577,   0.0004895329,  -0.0007728315,  -0.0016006632, ... 
               -0.0014932999,  -0.0004960661,   0.0008158707,   0.0016688630, ... 
                0.0015466836,   0.0005024937,  -0.0008613891,  -0.0017405271, ... 
               -0.0016024866,  -0.0005088106,   0.0009095820,   0.0018159343, ... 
                0.0016609086,   0.0005150118,  -0.0009606677,  -0.0018953972, ... 
               -0.0017221734,  -0.0005210927,   0.0010148906,   0.0019792671, ... 
                0.0017865335,   0.0005270484,  -0.0010725260,  -0.0020679400, ... 
               -0.0018542745,  -0.0005328741,   0.0011338844,   0.0021618646, ... 
                0.0019257205,   0.0005385654,  -0.0011993180,  -0.0022615505, ... 
               -0.0020012404,  -0.0005441176,   0.0012692278,   0.0023675793, ... 
                0.0020812567,   0.0005495263,  -0.0013440724,  -0.0024806179, ... 
               -0.0021662544,  -0.0005547872,   0.0014243788,   0.0026014342, ... 
                0.0022567935,   0.0005598960,  -0.0015107557,  -0.0027309173, ... 
               -0.0023535238,  -0.0005648487,   0.0016039101,   0.0028701019, ... 
                0.0024572030,   0.0005696411,  -0.0017046680,  -0.0030201999, ... 
               -0.0025687206,  -0.0005742695,   0.0018140006,   0.0031826391, ... 
                0.0026891270,   0.0005787300,  -0.0019330579,  -0.0033591142, ... 
               -0.0028196717,  -0.0005830189,   0.0020632114,   0.0035516510, ... 
                0.0029618522,   0.0005871328,  -0.0022061106,  -0.0037626924, ... 
               -0.0031174784,  -0.0005910684,   0.0023637569,   0.0039952104, ... 
                0.0032887586,   0.0005948222,  -0.0025386034,  -0.0042528576, ... 
               -0.0034784146,  -0.0005983913,   0.0027336887,   0.0045401734, ... 
                0.0036898399,   0.0006017726,  -0.0029528240,  -0.0048628703, ... 
               -0.0039273197,  -0.0006049635,   0.0032008543,   0.0052282380, ... 
                0.0041963440,   0.0006079611,  -0.0034840346,  -0.0056457284, ... 
               -0.0045040621,  -0.0006107631,   0.0038105829,   0.0061278196, ... 
                0.0048599601,   0.0006133671,  -0.0041915160,  -0.0066913323, ... 
               -0.0052768990,  -0.0006157708,   0.0046419504,   0.0073594975, ... 
                0.0057727615,   0.0006179724,  -0.0051832059,  -0.0081653306, ... 
               -0.0063731660,  -0.0006199699,   0.0058463497,   0.0091573867, ... 
                0.0071161551,   0.0006217616,  -0.0066784854,  -0.0104101206, ... 
               -0.0080607638,  -0.0006233462,   0.0077546319,   0.0120438099, ... 
                0.0093038135,   0.0006247222,  -0.0092019979,  -0.0142662117, ... 
               -0.0110158990,  -0.0006258884,   0.0112549184,   0.0174697622, ... 
                0.0135281805,   0.0006268440,  -0.0143976901,  -0.0224954050, ... 
               -0.0175794074,  -0.0006275880,   0.0198190478,   0.0315296039, ... 
                0.0252216712,   0.0006281199,  -0.0314248446,  -0.0525894133, ... 
               -0.0450737748,  -0.0006284392,   0.0739521746,   0.1578283792, ... 
                0.2236554533,   0.2527008775,   0.2236554533,   0.1578283792, ... 
                0.0739521746,  -0.0006284392,  -0.0450737748,  -0.0525894133, ... 
               -0.0314248446,   0.0006281199,   0.0252216712,   0.0315296039, ... 
                0.0198190478,  -0.0006275880,  -0.0175794074,  -0.0224954050, ... 
               -0.0143976901,   0.0006268440,   0.0135281805,   0.0174697622, ... 
                0.0112549184,  -0.0006258884,  -0.0110158990,  -0.0142662117, ... 
               -0.0092019979,   0.0006247222,   0.0093038135,   0.0120438099, ... 
                0.0077546319,  -0.0006233462,  -0.0080607638,  -0.0104101206, ... 
               -0.0066784854,   0.0006217616,   0.0071161551,   0.0091573867, ... 
                0.0058463497,  -0.0006199699,  -0.0063731660,  -0.0081653306, ... 
               -0.0051832059,   0.0006179724,   0.0057727615,   0.0073594975, ... 
                0.0046419504,  -0.0006157708,  -0.0052768990,  -0.0066913323, ... 
               -0.0041915160,   0.0006133671,   0.0048599601,   0.0061278196, ... 
                0.0038105829,  -0.0006107631,  -0.0045040621,  -0.0056457284, ... 
               -0.0034840346,   0.0006079611,   0.0041963440,   0.0052282380, ... 
                0.0032008543,  -0.0006049635,  -0.0039273197,  -0.0048628703, ... 
               -0.0029528240,   0.0006017726,   0.0036898399,   0.0045401734, ... 
                0.0027336887,  -0.0005983913,  -0.0034784146,  -0.0042528576, ... 
               -0.0025386034,   0.0005948222,   0.0032887586,   0.0039952104, ... 
                0.0023637569,  -0.0005910684,  -0.0031174784,  -0.0037626924, ... 
               -0.0022061106,   0.0005871328,   0.0029618522,   0.0035516510, ... 
                0.0020632114,  -0.0005830189,  -0.0028196717,  -0.0033591142, ... 
               -0.0019330579,   0.0005787300,   0.0026891270,   0.0031826391, ... 
                0.0018140006,  -0.0005742695,  -0.0025687206,  -0.0030201999, ... 
               -0.0017046680,   0.0005696411,   0.0024572030,   0.0028701019, ... 
                0.0016039101,  -0.0005648487,  -0.0023535238,  -0.0027309173, ... 
               -0.0015107557,   0.0005598960,   0.0022567935,   0.0026014342, ... 
                0.0014243788,  -0.0005547872,  -0.0021662544,  -0.0024806179, ... 
               -0.0013440724,   0.0005495263,   0.0020812567,   0.0023675793, ... 
                0.0012692278,  -0.0005441176,  -0.0020012404,  -0.0022615505, ... 
               -0.0011993180,   0.0005385654,   0.0019257205,   0.0021618646, ... 
                0.0011338844,  -0.0005328741,  -0.0018542745,  -0.0020679400, ... 
               -0.0010725260,   0.0005270484,   0.0017865335,   0.0019792671, ... 
                0.0010148906,  -0.0005210927,  -0.0017221734,  -0.0018953972, ... 
               -0.0009606677,   0.0005150118,   0.0016609086,   0.0018159343, ... 
                0.0009095820,  -0.0005088106,  -0.0016024866,  -0.0017405271, ... 
               -0.0008613891,   0.0005024937,   0.0015466836,   0.0016688630, ... 
                0.0008158707,  -0.0004960661,  -0.0014932999,  -0.0016006632, ... 
               -0.0007728315,   0.0004895329,   0.0014421577,   0.0015356776, ... 
                0.0007320960,  -0.0004828990,  -0.0013930976,  -0.0014736821, ... 
               -0.0006935061,   0.0004761695,   0.0013459765,   0.0014144745, ... 
                0.0006569189,  -0.0004693496,  -0.0013006657,  -0.0013578723, ... 
               -0.0006222050,   0.0004624444,   0.0012570490,   0.0013037102, ... 
                0.0005892466,  -0.0004554590,  -0.0012150216,  -0.0012518382, ... 
               -0.0005579363,   0.0004483988,   0.0011744882,   0.0012021197, ... 
                0.0005281763,  -0.0004412690,  -0.0011353625,  -0.0011544303, ... 
               -0.0004998767,   0.0004340748,   0.0010975660,   0.0011086561, ... 
                0.0004729550,  -0.0004268214,  -0.0010610269,  -0.0010646927, ... 
               -0.0004473353,   0.0004195142,   0.0010256799,   0.0010224445, ... 
                0.0004229477,  -0.0004121585,  -0.0009914650,  -0.0009818234, ... 
               -0.0003997273,   0.0004047594,   0.0009583275,   0.0009427481, ... 
                0.0003776141,  -0.0003973223,  -0.0009262169,  -0.0009051436, ... 
               -0.0003565525,   0.0003898524,   0.0008950868,   0.0008689406, ... 
                0.0003364906,  -0.0003823548,  -0.0008648946,  -0.0008340745, ... 
               -0.0003173800,   0.0003748348,   0.0008356009,   0.0008004856, ... 
                0.0002991756,  -0.0003672976,  -0.0008071692,  -0.0007681183, ... 
               -0.0002818350,   0.0003597481,   0.0007795658,   0.0007369206, ... 
                0.0002653186,  -0.0003521915,  -0.0007527594,  -0.0007068441, ... 
               -0.0002495891,   0.0003446329,   0.0007267208,   0.0006778433, ... 
                0.0002346114,  -0.0003370771,  -0.0007014232,  -0.0006498758, ... 
               -0.0002203525,   0.0003295290,   0.0006768411,   0.0006229016, ... 
                0.0002067812,  -0.0003219936,  -0.0006529512,  -0.0005968831, ... 
               -0.0001938678,   0.0003144755,   0.0006297312,   0.0005717851, ... 
                0.0001815845,  -0.0003069795,  -0.0006071607,  -0.0005475739, ... 
               -0.0001699045,   0.0002995102,   0.0005852201,   0.0005242182, ... 
                0.0001588027,  -0.0002920721,  -0.0005638913,  -0.0005016880, ... 
               -0.0001482551,   0.0002846697,   0.0005431570,   0.0004799549, ... 
                0.0001382387,  -0.0002773073,  -0.0005230012,  -0.0004589920, ... 
               -0.0001287318,   0.0002699892,   0.0005034083,   0.0004387736, ... 
                0.0001197134,  -0.0002627196,  -0.0004843639,  -0.0004192755, ... 
               -0.0001111636,   0.0002555025,   0.0004658542,   0.0004004741, ... 
                0.0001030632,  -0.0002483420,  -0.0004478660,  -0.0003823474, ... 
               -0.0000953940,   0.0002412419,   0.0004303868,   0.0003648739, ... 
                0.0000881384,  -0.0002342059,  -0.0004134047,  -0.0003480332, ... 
               -0.0000812794,   0.0002272377,   0.0003969082,   0.0003318059, ... 
                0.0000748009,  -0.0002203409,  -0.0003808863,  -0.0003161729, ... 
               -0.0000686872,   0.0002135187,   0.0003653285,   0.0003011162, ... 
                0.0000629232,  -0.0002067746,  -0.0003502246,  -0.0002866183, ... 
               -0.0000574945,   0.0002001117,   0.0003355649,   0.0002726624, ... 
                0.0000523872,  -0.0001935330,  -0.0003213398,  -0.0002592322, ... 
               -0.0000475876,   0.0001870414,   0.0003075403,   0.0002463121, ... 
                0.0000430828,  -0.0001806398,  -0.0002941573,  -0.0002338867, ... 
               -0.0000388602,   0.0001743308,   0.0002811823,   0.0002219413, ... 
                0.0000349077,  -0.0001681170,  -0.0002686068,  -0.0002104617, ... 
               -0.0000312134,   0.0001620007,   0.0002564227,   0.0001994340, ... 
                0.0000277661,  -0.0001559843,  -0.0002446219,  -0.0001888446, ... 
               -0.0000245547,   0.0001500698,   0.0002331966,   0.0001786806, ... 
                0.0000215686,  -0.0001442592,  -0.0002221391,  -0.0001689292, ... 
               -0.0000187975,   0.0001385545,   0.0002114419,   0.0001595779, ... 
                0.0000162314,  -0.0001329574,  -0.0002010976,  -0.0001506147, ... 
               -0.0000138607,   0.0001274695,   0.0001910989,   0.0001420278, ... 
                0.0000116760,  -0.0001220923,  -0.0001814387,  -0.0001338057, ... 
               -0.0000096683,   0.0001168270,   0.0001721099,   0.0001259372, ... 
                0.0000078289,  -0.0001116750,  -0.0001631055,  -0.0001184113, ... 
               -0.0000061492,   0.0001066372,   0.0001544188,   0.0001112175, ... 
                0.0000046210,  -0.0001017147,  -0.0001460429,  -0.0001043451, ... 
               -0.0000032365,   0.0000969083,   0.0001379711,   0.0000977841, ... 
                0.0000019879,  -0.0000922186,  -0.0001301968,  -0.0000915244, ... 
               -0.0000008678,   0.0000876462,   0.0001227135,   0.0000855564, ... 
               -0.0000001310,  -0.0000831915,  -0.0001155145,  -0.0000798704, ... 
                0.0000010155,   0.0000788549,   0.0021272290 ];
EOF
if [ $? -ne 0 ]; then echo "Failed cat test_p_100_q_300_h_coef.ok"; fail; fi

cat > test_as_120_fp_0_15_h_coef.ok << 'EOF'
h = [  -0.0000003617,  -0.0000001988,   0.0000001296,   0.0000004806, ... 
        0.0000004085,  -0.0000002110,  -0.0000008630,  -0.0000007555, ... 
        0.0000003073,   0.0000014340,   0.0000013019,  -0.0000004070, ... 
       -0.0000022536,  -0.0000021286,   0.0000004887,   0.0000033922, ... 
        0.0000033399,  -0.0000005171,  -0.0000049305,  -0.0000050666, ... 
        0.0000004387,   0.0000069589,   0.0000074705,  -0.0000001764, ... 
       -0.0000095755,  -0.0000107482,  -0.0000003765,   0.0000128841, ... 
        0.0000151347,   0.0000013635,  -0.0000169901,  -0.0000209071, ... 
       -0.0000029721,   0.0000219963,   0.0000283873,   0.0000054419, ... 
       -0.0000279964,  -0.0000379442,  -0.0000090738,   0.0000350684, ... 
        0.0000499946,   0.0000142388,  -0.0000432648,  -0.0000650037, ... 
       -0.0000213870,   0.0000526034,   0.0000834832,   0.0000310573, ... 
       -0.0000630552,  -0.0001059886,  -0.0000438863,   0.0000745315, ... 
        0.0001331148,   0.0000606166,  -0.0000868696,  -0.0001654890, ... 
       -0.0000821051,   0.0000998177,   0.0002037630,   0.0001093300, ... 
       -0.0001130182,  -0.0002486024,  -0.0001433964,   0.0001259908, ... 
        0.0003006751,   0.0001855417,  -0.0001381145,  -0.0003606364, ... 
       -0.0002371388,   0.0001486097,   0.0004291147,   0.0002996988, ... 
       -0.0001565193,  -0.0005066934,  -0.0003748726,   0.0001606899, ... 
        0.0005938941,   0.0004644514,  -0.0001597531,  -0.0006911576, ... 
       -0.0005703676,   0.0001521054,   0.0007988251,   0.0006946967, ... 
       -0.0001358882,  -0.0009171201,  -0.0008396593,   0.0001089661, ... 
        0.0010461307,   0.0010076288,  -0.0000689016,  -0.0011857934, ... 
       -0.0012011417,   0.0000129272,   0.0013358790,   0.0014229176, ... 
        0.0000620903,  -0.0014959805,  -0.0016758893,  -0.0001596947, ... 
        0.0016655047,   0.0019632497,   0.0002838998,  -0.0018436667, ... 
       -0.0022885202,  -0.0004392711,   0.0020294884,   0.0026556514, ... 
        0.0006310371,  -0.0022218015,  -0.0030691674,  -0.0008652468, ... 
        0.0024192541,   0.0035343726,   0.0011489933,  -0.0026203230, ... 
       -0.0040576495,  -0.0014907350,   0.0028233291,   0.0046468884, ... 
        0.0019007636,  -0.0030264581,  -0.0053121160,  -0.0023918979, ... 
        0.0032277849,   0.0060664321,   0.0029805307,  -0.0034253018, ... 
       -0.0069274349,  -0.0036882486,   0.0036169494,   0.0079194534, ... 
        0.0045444105,  -0.0038006503,  -0.0090771678,  -0.0055904053, ... 
        0.0039743447,   0.0104517352,   0.0068869942,  -0.0041360269, ... 
       -0.0121217010,  -0.0085276814,   0.0042837813,   0.0142137171, ... 
        0.0106647695,  -0.0044158185,  -0.0169451751,  -0.0135647434, ... 
        0.0045305093,   0.0207216175,   0.0177403508,  -0.0046264162, ... 
       -0.0263934992,  -0.0243204276,   0.0047023217,   0.0360905799, ... 
        0.0363706913,  -0.0047572525,  -0.0570599933,  -0.0661580463, ... 
        0.0047904989,   0.1400465808,   0.2731720449,   0.3285318459, ... 
        0.2731720449,   0.1400465808,   0.0047904989,  -0.0661580463, ... 
       -0.0570599933,  -0.0047572525,   0.0363706913,   0.0360905799, ... 
        0.0047023217,  -0.0243204276,  -0.0263934992,  -0.0046264162, ... 
        0.0177403508,   0.0207216175,   0.0045305093,  -0.0135647434, ... 
       -0.0169451751,  -0.0044158185,   0.0106647695,   0.0142137171, ... 
        0.0042837813,  -0.0085276814,  -0.0121217010,  -0.0041360269, ... 
        0.0068869942,   0.0104517352,   0.0039743447,  -0.0055904053, ... 
       -0.0090771678,  -0.0038006503,   0.0045444105,   0.0079194534, ... 
        0.0036169494,  -0.0036882486,  -0.0069274349,  -0.0034253018, ... 
        0.0029805307,   0.0060664321,   0.0032277849,  -0.0023918979, ... 
       -0.0053121160,  -0.0030264581,   0.0019007636,   0.0046468884, ... 
        0.0028233291,  -0.0014907350,  -0.0040576495,  -0.0026203230, ... 
        0.0011489933,   0.0035343726,   0.0024192541,  -0.0008652468, ... 
       -0.0030691674,  -0.0022218015,   0.0006310371,   0.0026556514, ... 
        0.0020294884,  -0.0004392711,  -0.0022885202,  -0.0018436667, ... 
        0.0002838998,   0.0019632497,   0.0016655047,  -0.0001596947, ... 
       -0.0016758893,  -0.0014959805,   0.0000620903,   0.0014229176, ... 
        0.0013358790,   0.0000129272,  -0.0012011417,  -0.0011857934, ... 
       -0.0000689016,   0.0010076288,   0.0010461307,   0.0001089661, ... 
       -0.0008396593,  -0.0009171201,  -0.0001358882,   0.0006946967, ... 
        0.0007988251,   0.0001521054,  -0.0005703676,  -0.0006911576, ... 
       -0.0001597531,   0.0004644514,   0.0005938941,   0.0001606899, ... 
       -0.0003748726,  -0.0005066934,  -0.0001565193,   0.0002996988, ... 
        0.0004291147,   0.0001486097,  -0.0002371388,  -0.0003606364, ... 
       -0.0001381145,   0.0001855417,   0.0003006751,   0.0001259908, ... 
       -0.0001433964,  -0.0002486024,  -0.0001130182,   0.0001093300, ... 
        0.0002037630,   0.0000998177,  -0.0000821051,  -0.0001654890, ... 
       -0.0000868696,   0.0000606166,   0.0001331148,   0.0000745315, ... 
       -0.0000438863,  -0.0001059886,  -0.0000630552,   0.0000310573, ... 
        0.0000834832,   0.0000526034,  -0.0000213870,  -0.0000650037, ... 
       -0.0000432648,   0.0000142388,   0.0000499946,   0.0000350684, ... 
       -0.0000090738,  -0.0000379442,  -0.0000279964,   0.0000054419, ... 
        0.0000283873,   0.0000219963,  -0.0000029721,  -0.0000209071, ... 
       -0.0000169901,   0.0000013635,   0.0000151347,   0.0000128841, ... 
       -0.0000003765,  -0.0000107482,  -0.0000095755,  -0.0000001764, ... 
        0.0000074705,   0.0000069589,   0.0000004387,  -0.0000050666, ... 
       -0.0000049305,  -0.0000005171,   0.0000033399,   0.0000033922, ... 
        0.0000004887,  -0.0000021286,  -0.0000022536,  -0.0000004070, ... 
        0.0000013019,   0.0000014340,   0.0000003073,  -0.0000007555, ... 
       -0.0000008630,  -0.0000002110,   0.0000004085,   0.0000004806, ... 
        0.0000001296,  -0.0000001988,  -0.0000003617 ];
EOF
if [ $? -ne 0 ]; then echo "Failed cat test_as_120_fp_0_15_h_coef.ok"; fail; fi

#
# run and see if the results match
#
echo "Running $prog"

octave-cli -q $prog >test.out 2>&1
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

nstr="zolotarev_vlcek_zahradnik_test"

diff -Bb test_p_4_q_11_generator.ok $nstr"_p_4_q_11_generator_coef.m"
if [ $? -ne 0 ]; then echo "Failed diff -Bb test_p_4_q_11_generator.ok"; fail; fi

diff -Bb test_p_4_q_11_a_coef.ok $nstr"_p_4_q_11_a_coef.m"
if [ $? -ne 0 ]; then echo "Failed diff -Bb test_p_4_q_11_a_coef.ok"; fail; fi

diff -Bb test_p_4_q_11_h_coef.ok $nstr"_p_4_q_11_h_coef.m"
if [ $? -ne 0 ]; then echo "Failed diff -Bb test_p_4_q_11_h_coef.ok"; fail; fi

diff -Bb test_p_100_q_300_h_coef.ok $nstr"_p_100_q_300_h_coef.m"
if [ $? -ne 0 ]; then echo "Failed diff -Bb test_p_100_q_300_h_coef.ok";
                      fail; fi

diff -Bb test_as_120_fp_0_15_h_coef.ok $nstr"_as_120_fp_0_15_h_coef.m"
if [ $? -ne 0 ]; then echo "Failed diff -Bb test_as_120_fp_0_15_h_coef.ok";
                      fail; fi

#
# this much worked
#
pass

