#!/bin/sh

prog=goldfarb_idnani_fir_minimum_phase_test.m

depends="goldfarb_idnani_fir_minimum_phase_test.m \
test_common.m goldfarb_idnani.m iirE.m iirA.m iirP.m iirT.m Aerror.m \
Perror.m Terror.m xConstraints.m tf2x.m zp2x.m fixResultNaN.m updateWchol.m 
armijo_kim.m invSVD.m sqp_bfgs.m updateWbfgs.m qroots.m qzsolve.oct"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
maxiter =    2.5000e+03
tol =    1.0000e-03
fapl =    1.0000e-01
fapu =    2.0000e-01
dBap =    3.0000e+00
Wap =    1.0000e+00
fasl =    5.0000e-02
fasu =    2.5000e-01
dBas =    2.0000e+01
Wasl =    1.0000e+00
Wasu =    1.0000e+00
N =    4.1000e+01
R =    1.0000e+00
Initial x0 = [ -0.000553 -0.548448 -1.823326 0.264871 0.787381 0.788032 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.268984 1.270032 3.775417 0.761172 0.779415 1.106564 1.818770 2.309947 0.072378 0.207264 0.300219 1.584821 1.679377 1.975570 2.140277 2.484143 2.663426 2.849519 3.042980 1.106564 0.779415 0.761172 ]
ans =   -1.0000e+00
Active constraints are [  ]
Step 1: Trying constraint 77 at g(77) = [ -2.775417 ]
Step 2a: step direction in primal space d = [ 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 -1.123477 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ]
Step 2b)ii): full step length t2 = 2.470382
Step 2b)iii): selecting step length t = 2.470382
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000553 -0.548448 -1.823326 0.264871 0.787381 0.788032 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.268984 1.270032 1.000000 0.761172 0.779415 1.106564 1.818770 2.309947 0.072378 0.207264 0.300219 1.584821 1.679377 1.975570 2.140277 2.484143 2.663426 2.849519 3.042980 1.106564 0.779415 0.761172 ]
f(x) =0.662508
Adding constraint 77
Active constraints are [ 77 ]
Step 1: Trying constraint 17 at g(17) = [ -0.823326 ]
Step 2a: step direction in primal space d = [ -0.000047 -0.071789 4.449903 -0.066485 -0.017862 -0.018270 0.018656 0.030487 0.012671 0.010942 0.008928 0.011010 0.014229 0.023114 0.027112 0.033204 0.035270 0.036689 0.037449 0.014374 0.014098 -0.000000 0.018602 -0.002290 0.005811 0.114690 0.000000 -0.000000 -0.000000 -0.000000 0.045052 0.062700 0.628015 0.000000 0.000000 0.000000 0.000000 0.000000 0.005811 -0.002290 0.022324 ]
Step 2a: step direction in dual space r = [ -0.063493 ]
Step 2b)ii): full step length t2 = 0.185021
Step 2b)iii): selecting step length t = 0.185021
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000562 -0.561731 -1.000000 0.252570 0.784077 0.784652 1.003452 1.005641 1.002344 1.002025 1.001652 1.002037 1.002633 1.004277 1.005016 1.006144 1.006526 1.006788 1.006929 1.271643 1.272641 1.000000 0.764614 0.778991 1.107639 1.839990 2.309947 0.072378 0.207264 0.300219 1.593157 1.690978 2.091766 2.140277 2.484143 2.663426 2.849519 3.042980 1.107639 0.778991 0.765303 ]
f(x) =0.660183
Adding constraint 17
Active constraints are [ 77 17 ]
Step 1: Trying constraint 3 at g(3) = [ -0.730256 ]
Step 2a: step direction in primal space d = [ 0.000002 0.002531 0.000000 0.002365 0.000875 0.001165 -0.000670 -0.001078 -0.000459 -0.000397 -0.000324 -0.000399 -0.000514 -0.000823 -0.000964 -0.001169 -0.001237 -0.001284 -0.001309 -0.000690 -0.000585 0.000000 -0.000306 0.001097 -0.000886 -0.002745 -0.000000 0.000000 0.000000 -0.000000 -0.000956 -0.001483 -0.000792 -0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.000906 0.001120 0.131777 ]
Step 2a: step direction in dual space r = [ 0.011345 0.003726 ]
Step 2b)i): partial step length t1 = 49.662250
Step 2b)ii): full step length t2 = 45.140099
Step 2b)iii): selecting step length t = 45.140099
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000493 -0.447499 -1.000000 0.359335 0.823553 0.837251 0.973195 0.956987 0.981628 0.984117 0.987031 0.984022 0.979423 0.967146 0.961523 0.953380 0.950665 0.948812 0.947824 1.240484 1.246218 1.000000 0.750816 0.828493 1.067659 1.716083 2.309947 0.072378 0.207264 0.300219 1.550023 1.624020 2.056016 2.140276 2.484143 2.663426 2.849519 3.042980 1.066727 0.829564 6.713731 ]
f(x) =0.639777
Adding constraint 3
Active constraints are [ 77 17 3 ]
Step 1: Trying constraint 4 at g(4) = [ -0.010746 ]
Step 2a: step direction in primal space d = [ -0.000002 -0.004561 -0.000000 -0.008548 -0.003302 -0.002793 0.001242 0.001299 0.000489 0.000422 0.000344 0.001361 0.001196 0.001049 0.001207 0.001374 0.001431 0.001471 0.001493 0.001240 0.001512 -0.000000 0.004815 -0.000002 0.001956 -0.014526 -0.000000 -0.000000 -0.000000 -0.000000 -0.012302 -0.010976 -0.008621 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.001745 0.000073 0.004340 ]
Step 2a: step direction in dual space r = [ -0.000259 -0.001038 0.670955 ]
Step 2b)i): partial step length t1 = 67.277363
Step 2b)ii): full step length t2 = 5.282717
Step 2b)iii): selecting step length t = 5.282717
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000501 -0.471593 -1.000000 0.314178 0.806111 0.822495 0.979757 0.963848 0.984209 0.986345 0.988848 0.991213 0.985743 0.972686 0.967899 0.960637 0.958226 0.956583 0.955708 1.247034 1.254204 1.000000 0.776253 0.828485 1.077992 1.639347 2.309947 0.072378 0.207264 0.300219 1.485036 1.566037 2.010471 2.140276 2.484143 2.663426 2.849519 3.042980 1.075943 0.829948 6.736655 ]
f(x) =0.638124
Adding constraint 4
Active constraints are [ 77 17 3 4 ]
Step 1: Trying constraint 5 at g(5) = [ -0.008434 ]
Step 2a: step direction in primal space d = [ -0.000006 -0.014939 -0.000000 -0.020689 -0.005763 -0.005539 0.003420 0.004792 0.001774 0.001533 0.001251 0.002282 0.002533 0.006420 0.004925 0.004954 0.005135 0.005274 0.005353 0.003051 0.003203 -0.000000 0.008497 -0.000066 0.002419 0.044028 -0.000000 -0.000000 -0.000000 -0.000000 0.004052 0.015670 -0.260061 -0.000000 -0.000000 0.000000 0.000000 0.000000 0.002317 -0.000033 0.024204 ]
Step 2a: step direction in dual space r = [ -0.004567 -0.005418 0.122968 -0.740234 ]
Step 2b)i): partial step length t1 = 338.264988
Step 2b)ii): full step length t2 = 0.466004
Step 2b)iii): selecting step length t = 0.466004
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000504 -0.478555 -1.000000 0.304537 0.803425 0.819913 0.981351 0.966081 0.985036 0.987059 0.989431 0.992276 0.986923 0.975678 0.970194 0.962946 0.960619 0.959041 0.958203 1.248455 1.255696 1.000000 0.780212 0.828454 1.079119 1.659865 2.309947 0.072378 0.207264 0.300219 1.486924 1.573339 1.889282 2.140276 2.484143 2.663426 2.849519 3.042980 1.077023 0.829932 6.747935 ]
f(x) =0.637884
Adding constraint 5
Active constraints are [ 77 17 3 4 5 ]
Step 1: Trying constraint 6 at g(6) = [ -0.001892 ]
Step 2a: step direction in primal space d = [ 0.000002 0.000503 0.000000 -0.000133 0.000144 0.000165 -0.000683 0.004587 -0.000485 -0.000419 -0.000341 -0.000378 -0.000521 0.001867 -0.000719 0.000016 -0.001078 -0.001282 -0.001352 -0.000357 -0.000334 0.000000 0.000311 0.000097 -0.000017 0.000223 0.000000 0.000000 0.000000 0.000000 -0.001087 -0.000572 0.011440 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.000021 0.000098 0.000528 ]
Step 2a: step direction in dual space r = [ 0.003126 0.001687 0.036465 -0.133314 -0.212410 ]
Step 2b)i): partial step length t1 = 14.736563
Step 2b)ii): full step length t2 = 12.683205
Step 2b)iii): selecting step length t = 12.683205
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000480 -0.472181 -1.000000 0.302848 0.805252 0.822002 0.972693 1.024263 0.978885 0.981749 0.985101 0.987480 0.980315 0.999355 0.961079 0.963150 0.946951 0.942785 0.941061 1.243927 1.251457 1.000000 0.784161 0.829684 1.078901 1.662693 2.309947 0.072378 0.207264 0.300219 1.473136 1.566082 2.034373 2.140276 2.484143 2.663426 2.849519 3.042980 1.076751 0.831170 6.754637 ]
f(x) =0.637824
Adding constraint 6
Active constraints are [ 77 17 3 4 5 6 ]
Step 1: Trying constraint 76 at g(76) = [ -0.251457 ]
Step 2a: step direction in primal space d = [ 0.000002 -0.010563 -0.000000 -0.015767 -0.003900 -0.003607 -0.000011 0.019810 -0.000521 -0.000449 -0.000365 0.001501 0.000081 0.011129 0.001137 0.005236 0.000147 -0.000716 -0.000973 0.001004 -0.042089 0.000000 0.006764 -0.000061 0.001892 0.028651 0.000000 -0.000000 -0.000000 -0.000000 -0.010185 0.005974 0.022881 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.001786 -0.000039 -0.010033 ]
Step 2a: step direction in dual space r = [ -0.006512 -0.004316 1.044024 -1.918045 -0.306009 -1.270793 ]
Step 2b)i): partial step length t1 = 39.343749
Step 2b)ii): full step length t2 = 5.974448
Step 2b)iii): selecting step length t = 5.974448
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000466 -0.535288 -1.000000 0.208646 0.781953 0.800451 0.972627 1.142615 0.975772 0.979066 0.982919 0.996445 0.980796 1.065842 0.967873 0.994433 0.947828 0.938510 0.935249 1.249923 1.000000 1.000000 0.824573 0.829320 1.090206 1.833867 2.309948 0.072378 0.207264 0.300219 1.412289 1.601773 2.171074 2.140277 2.484142 2.663426 2.849519 3.042980 1.087424 0.830936 6.694697 ]
f(x) =0.637701
Adding constraint 76
Active constraints are [ 77 17 3 4 5 6 76 ]
Step 1: Trying constraint 69 at g(69) = [ -0.065842 ]
Step 2a: step direction in primal space d = [ -0.000094 -0.036932 0.000000 -0.008148 -0.010913 -0.011407 0.029811 -0.165490 0.024053 0.020760 0.016928 -0.004454 0.026475 -0.282204 0.036560 0.010189 0.054695 0.064066 0.067368 0.018804 -0.000000 -0.000000 -0.007486 -0.004180 0.002727 -0.081434 -0.000001 -0.000000 -0.000000 -0.000000 0.007659 0.007003 -0.241541 -0.000000 0.000001 0.000000 0.000000 0.000000 0.002641 -0.001710 0.048334 ]
Step 2a: step direction in dual space r = [ -0.026509 -0.016192 -1.185519 2.409736 0.793751 6.379180 -0.331133 ]
Step 2b)i): partial step length t1 = 3.178385
Step 2b)ii): full step length t2 = 0.233314
Step 2b)iii): selecting step length t = 0.233314
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000488 -0.543904 -1.000000 0.206745 0.779407 0.797789 0.979582 1.104004 0.981384 0.983910 0.986868 0.995406 0.986973 1.000000 0.976403 0.996810 0.960589 0.953458 0.950967 1.254310 1.000000 1.000000 0.822826 0.828345 1.090842 1.814867 2.309948 0.072378 0.207264 0.300219 1.414076 1.603407 2.114719 2.140277 2.484142 2.663426 2.849519 3.042980 1.088040 0.830537 6.705974 ]
f(x) =0.637532
Adding constraint 69
Active constraints are [ 77 17 3 4 5 6 76 69 ]
Step 1: Trying constraint 75 at g(75) = [ -0.254310 ]
Step 2a: step direction in primal space d = [ 0.000000 -0.002373 0.000000 0.002112 0.001748 0.001362 -0.001386 0.038205 -0.000090 -0.000077 -0.000062 0.001706 -0.000737 0.000000 0.000354 0.005402 0.000206 -0.000124 -0.000190 -0.046364 0.000000 0.000000 -0.002192 -0.000131 -0.001336 0.011359 0.000000 0.000000 0.000000 0.000000 0.014048 0.014500 0.051121 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.001131 -0.001290 -0.007660 ]
Step 2a: step direction in dual space r = [ -0.017879 -0.010230 0.519004 -0.246387 0.312427 5.303698 -0.034405 -0.066614 ]
Step 2b)i): partial step length t1 = 3.542272
Step 2b)ii): full step length t2 = 5.485125
Step 2b)iii): selecting step length t = 3.542272
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000488 -0.552310 -1.000000 0.214227 0.785598 0.802614 0.974672 1.239338 0.981066 0.983637 0.986647 1.001448 0.984364 1.000000 0.977659 1.015946 0.961320 0.953020 0.950293 1.090078 1.000000 1.000000 0.815062 0.827882 1.086109 1.855104 2.309948 0.072378 0.207264 0.300219 1.463837 1.654770 2.295803 2.140277 2.484142 2.663426 2.849519 3.042980 1.084035 0.825969 6.678841 ]
f(x) =0.636476
Dropping constraint 6
Step 2a: step direction in primal space d = [ 0.000002 -0.026661 0.000000 -0.026222 -0.006297 -0.006205 0.001199 0.173585 -0.000797 -0.000687 -0.000558 0.007348 -0.001083 -0.000000 0.002954 0.027092 0.001682 -0.000573 -0.001125 -0.208061 0.000000 0.000000 0.009286 -0.001390 0.002965 0.038733 0.000001 -0.000000 -0.000000 -0.000000 -0.022204 0.022017 0.330096 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.006163 -0.012285 -0.132510 ]
Step 2a: step direction in dual space r = [ -0.012163 -0.006080 3.961995 -1.359557 -0.660822 0.039002 -0.070203 ]
Step 2b)i): partial step length t1 = 8.398928
Step 2b)ii): full step length t2 = 0.432939
Step 2b)iii): selecting step length t = 0.432939
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000487 -0.563852 -1.000000 0.202875 0.782871 0.799928 0.975191 1.314490 0.980721 0.983339 0.986405 1.004629 0.983895 1.000000 0.978938 1.027676 0.962048 0.952772 0.949806 1.000000 1.000000 1.000000 0.819082 0.827280 1.087392 1.871873 2.309949 0.072378 0.207264 0.300219 1.454224 1.664302 2.438714 2.140277 2.484142 2.663426 2.849519 3.042980 1.086703 0.820650 6.621472 ]
f(x) =0.635602
Adding constraint 75
Active constraints are [ 77 17 3 4 5 76 69 75 ]
Step 1: Trying constraint 2 at g(2) = [ -0.002418 ]
Step 2a: step direction in primal space d = [ -0.000002 -0.002144 0.000000 -0.002048 -0.001555 -0.001644 -0.000980 -0.001374 0.000533 0.000482 0.000436 0.000658 0.000649 0.000000 0.001021 0.000752 0.001312 0.001448 0.001502 0.000000 -0.000000 -0.000000 0.000645 -0.000387 0.000462 -0.002129 -0.000000 0.000000 0.000000 0.000000 0.001410 0.000547 -0.039155 -0.000000 0.000000 0.000000 0.000000 0.000000 0.001622 -0.002450 0.041568 ]
Step 2a: step direction in dual space r = [ -0.002509 -0.000994 1.115023 0.034363 0.125307 0.001254 0.003518 0.003591 ]
Step 2b)i): partial step length t1 = 28.305440
Step 2b)ii): full step length t2 = 3.722704
Step 2b)iii): selecting step length t = 3.722704
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000495 -0.571835 -1.000000 0.195252 0.777083 0.793806 0.971543 1.309375 0.982704 0.985132 0.988027 1.007080 0.986313 1.000000 0.982739 1.030476 0.966931 0.958162 0.955396 1.000000 1.000000 1.000000 0.821482 0.825841 1.089111 1.863946 2.309949 0.072378 0.207264 0.300219 1.459472 1.666337 2.292952 2.140277 2.484142 2.663426 2.849519 3.042980 1.092741 0.811528 6.776217 ]
f(x) =0.634091
Adding constraint 2
Active constraints are [ 77 17 3 4 5 76 69 75 2 ]
Step 1: Trying constraint 71 at g(71) = [ -0.030476 ]
Step 2a: step direction in primal space d = [ -0.000007 -0.004082 -0.000000 0.002397 -0.000483 -0.000387 0.003463 -0.001247 0.001285 0.001101 0.000886 -0.000862 0.000888 -0.000000 0.002145 -0.306009 0.003753 0.004005 0.004127 -0.000000 -0.000000 -0.000000 -0.003483 -0.000805 -0.000040 0.009505 0.000000 -0.000000 -0.000000 -0.000000 -0.000497 0.007353 0.265138 0.000000 0.000000 0.000000 0.000000 0.000000 0.005106 -0.008015 0.003169 ]
Step 2a: step direction in dual space r = [ -0.024935 -0.012247 4.742815 -0.571196 -0.218004 -0.045679 -0.030658 -0.075630 1.946171 ]
Step 2b)i): partial step length t1 = 1.912835
Step 2b)ii): full step length t2 = 0.099591
Step 2b)iii): selecting step length t = 0.099591
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000496 -0.572242 -1.000000 0.195490 0.777035 0.793768 0.971888 1.309250 0.982832 0.985241 0.988115 1.006994 0.986401 1.000000 0.982952 1.000000 0.967305 0.958561 0.955807 1.000000 1.000000 1.000000 0.821135 0.825761 1.089108 1.864892 2.309949 0.072378 0.207264 0.300219 1.459423 1.667070 2.319358 2.140277 2.484142 2.663426 2.849519 3.042980 1.093249 0.810730 6.776533 ]
f(x) =0.634046
Adding constraint 71
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 ]
Step 1: Trying constraint 67 at g(67) = [ -0.006994 ]
Step 2a: step direction in primal space d = [ 0.000009 0.007503 -0.000000 0.012753 0.004751 0.004359 -0.005922 0.023359 -0.002789 -0.002413 -0.001976 -0.108092 -0.004113 0.000000 -0.004731 -0.000000 -0.006263 -0.007287 -0.007631 -0.000000 0.000000 0.000000 -0.006372 0.000005 -0.002487 0.014588 0.000000 0.000000 0.000000 0.000000 0.012733 0.013462 0.156397 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.001521 -0.005374 0.001671 ]
Step 2a: step direction in dual space r = [ -0.013838 -0.006024 3.602888 -0.136392 0.065606 0.035118 0.005304 0.007731 1.637091 0.002752 ]
Step 2b)i): partial step length t1 = 2.155581
Step 2b)ii): full step length t2 = 0.064705
Step 2b)iii): selecting step length t = 0.064705
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000495 -0.571756 -1.000000 0.196316 0.777342 0.794050 0.971505 1.310762 0.982651 0.985085 0.987988 1.000000 0.986135 1.000000 0.982646 1.000000 0.966900 0.958090 0.955313 1.000000 1.000000 1.000000 0.820723 0.825761 1.088947 1.865836 2.309949 0.072378 0.207264 0.300219 1.460247 1.667941 2.329477 2.140277 2.484142 2.663426 2.849519 3.042980 1.093348 0.810382 6.776641 ]
f(x) =0.634041
Adding constraint 67
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 ]
Step 1: Trying constraint 63 at g(63) = [ -0.310762 ]
Step 2a: step direction in primal space d = [ -0.000124 -0.029165 -0.000000 0.014157 -0.008063 -0.008732 0.040434 -0.594865 0.032063 0.027687 0.022599 -0.000000 0.034548 -0.000000 0.045949 -0.000000 0.071012 0.084460 0.089061 0.000000 -0.000000 0.000000 -0.022346 -0.005384 0.000672 -0.098822 -0.000002 -0.000000 -0.000000 -0.000000 0.011452 0.000219 -0.130434 -0.000001 0.000001 0.000000 0.000000 0.000000 -0.003580 0.002228 -0.000201 ]
Step 2a: step direction in dual space r = [ -0.000240 -0.004271 -4.919796 -1.311963 0.428511 -0.431189 0.542403 -0.894492 -2.728251 0.005670 -0.247993 ]
Step 2b)i): partial step length t1 = 0.902076
Step 2b)ii): full step length t2 = 0.522407
Step 2b)iii): selecting step length t = 0.522407
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000560 -0.586992 -1.000000 0.203711 0.773130 0.789488 0.992628 1.000000 0.999401 0.999549 0.999793 1.000000 1.004183 1.000000 1.006650 1.000000 1.003997 1.002212 1.001839 1.000000 1.000000 1.000000 0.809049 0.822949 1.089298 1.814211 2.309947 0.072378 0.207264 0.300219 1.466229 1.668055 2.261337 2.140277 2.484143 2.663426 2.849519 3.042980 1.091478 0.811546 6.776536 ]
f(x) =0.633937
Adding constraint 63
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 63 ]
Step 1: Trying constraint 73 at g(73) = [ -0.002212 ]
Step 2a: step direction in primal space d = [ 0.000012 -0.000837 -0.000000 0.000081 0.000770 0.001005 -0.004169 0.000000 -0.003001 -0.002592 -0.002118 0.000000 -0.004134 -0.000000 -0.004261 -0.000000 -0.005923 -0.348827 -0.008216 -0.000000 -0.000000 -0.000000 -0.000939 -0.000039 -0.000224 0.035079 0.000000 0.000000 0.000000 0.000000 -0.004995 0.009950 0.395669 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.007051 -0.010056 0.004173 ]
Step 2a: step direction in dual space r = [ -0.032769 -0.015762 7.018050 -0.729955 -0.356150 0.033779 -0.135387 -0.042945 3.009469 -0.011544 0.028448 -0.150710 ]
Step 2b)i): partial step length t1 = 1.610986
Step 2b)ii): full step length t2 = 0.006341
Step 2b)iii): selecting step length t = 0.006341
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000560 -0.586998 -1.000000 0.203712 0.773135 0.789494 0.992602 1.000000 0.999382 0.999532 0.999780 1.000000 1.004157 1.000000 1.006623 1.000000 1.003959 1.000000 1.001787 1.000000 1.000000 1.000000 0.809043 0.822949 1.089296 1.814434 2.309947 0.072378 0.207264 0.300219 1.466197 1.668118 2.263846 2.140277 2.484143 2.663426 2.849519 3.042980 1.091522 0.811482 6.776562 ]
f(x) =0.633934
Adding constraint 73
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 63 73 ]
Step 1: Trying constraint 74 at g(74) = [ -0.001787 ]
Step 2a: step direction in primal space d = [ 0.000012 -0.000732 -0.000000 0.000073 0.000799 0.001035 -0.004361 0.000000 -0.003129 -0.002702 -0.002208 0.000000 -0.004270 -0.000000 -0.004441 0.000000 -0.006201 -0.000000 -0.356803 -0.000000 -0.000000 -0.000000 -0.000876 -0.000029 -0.000223 0.034863 0.000000 0.000000 0.000000 0.000000 -0.004894 0.009842 0.398586 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.007136 -0.010175 0.004210 ]
Step 2a: step direction in dual space r = [ -0.033039 -0.015862 7.089675 -0.716934 -0.343076 0.036770 -0.138668 -0.042937 3.051079 -0.011599 0.029263 -0.154800 0.025455 ]
Step 2b)i): partial step length t1 = 0.249105
Step 2b)ii): full step length t2 = 0.005008
Step 2b)iii): selecting step length t = 0.005008
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000560 -0.587001 -1.000000 0.203712 0.773139 0.789500 0.992580 1.000000 0.999366 0.999519 0.999769 1.000000 1.004135 1.000000 1.006601 1.000000 1.003928 1.000000 1.000000 1.000000 1.000000 1.000000 0.809039 0.822948 1.089295 1.814608 2.309947 0.072378 0.207264 0.300219 1.466173 1.668167 2.265843 2.140277 2.484143 2.663426 2.849519 3.042980 1.091558 0.811431 6.776583 ]
f(x) =0.633931
Adding constraint 74
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 63 73 74 ]
Step 1: Trying constraint 72 at g(72) = [ -0.003928 ]
Step 2a: step direction in primal space d = [ 0.000009 -0.001347 0.000000 0.000197 0.000513 0.000707 -0.003157 0.000000 -0.002211 -0.001909 -0.001559 0.000000 -0.003202 -0.000000 -0.003108 0.000000 -0.332193 0.000000 0.000000 -0.000000 0.000000 0.000000 -0.001166 -0.000145 -0.000172 0.029923 0.000000 0.000000 0.000000 0.000000 -0.004090 0.009133 0.353199 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.006418 -0.009214 0.003817 ]
Step 2a: step direction in dual space r = [ -0.029576 -0.014267 6.280920 -0.675718 -0.311698 0.020452 -0.111098 -0.038169 2.678370 -0.010562 0.022553 -0.121592 0.018147 0.019041 ]
Step 2b)i): partial step length t1 = 0.263022
Step 2b)ii): full step length t2 = 0.011825
Step 2b)iii): selecting step length t = 0.011825
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000560 -0.587017 -1.000000 0.203715 0.773145 0.789508 0.992542 1.000000 0.999340 0.999496 0.999750 1.000000 1.004098 1.000000 1.006564 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.809025 0.822947 1.089293 1.814962 2.309947 0.072378 0.207264 0.300219 1.466125 1.668275 2.270019 2.140277 2.484143 2.663426 2.849519 3.042980 1.091634 0.811322 6.776628 ]
f(x) =0.633926
Adding constraint 72
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 63 73 74 72 ]
Step 1: Trying constraint 70 at g(70) = [ -0.006564 ]
Step 2a: step direction in primal space d = [ 0.000006 0.000282 0.000000 0.002430 0.000828 0.000946 -0.002363 -0.000000 -0.001532 -0.001322 -0.001077 0.000000 -0.002379 -0.000000 -0.254520 0.000000 -0.000000 -0.000000 0.000000 -0.000000 0.000000 0.000000 -0.002047 -0.000188 -0.000360 0.021816 0.000000 0.000000 0.000000 0.000000 -0.003119 0.006672 0.274566 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.004897 -0.007402 0.002968 ]
Step 2a: step direction in dual space r = [ -0.022204 -0.010671 4.898472 -0.564234 -0.302473 0.008672 -0.073328 -0.023745 2.085829 -0.005867 0.018268 -0.078380 0.012911 0.013483 0.010525 ]
Step 2b)i): partial step length t1 = 0.354730
Step 2b)ii): full step length t2 = 0.025789
Step 2b)iii): selecting step length t = 0.025789
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000560 -0.587010 -1.000000 0.203777 0.773166 0.789532 0.992481 1.000000 0.999301 0.999462 0.999723 1.000000 1.004036 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.808972 0.822942 1.089284 1.815525 2.309947 0.072378 0.207264 0.300219 1.466044 1.668447 2.277100 2.140277 2.484143 2.663426 2.849519 3.042980 1.091760 0.811131 6.776705 ]
f(x) =0.633916
Adding constraint 70
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 63 73 74 72 70 ]
Step 1: Trying constraint 68 at g(68) = [ -0.004036 ]
Step 2a: step direction in primal space d = [ 0.000005 0.001988 0.000000 0.003698 0.001387 0.001408 -0.002394 -0.000000 -0.001424 -0.001228 -0.000999 0.000000 -0.134454 0.000000 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 -0.000000 0.000000 -0.002213 -0.000034 -0.000666 0.012917 0.000000 0.000000 0.000000 0.000000 -0.002187 0.005308 0.160475 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.002645 -0.004499 0.001663 ]
Step 2a: step direction in dual space r = [ -0.012648 -0.006024 2.978209 -0.427581 -0.105722 0.015175 -0.049011 -0.006488 1.259394 -0.001874 0.017311 -0.055538 0.011861 0.012281 0.010144 0.009954 ]
Step 2b)i): partial step length t1 = 0.361133
Step 2b)ii): full step length t2 = 0.030019
Step 2b)iii): selecting step length t = 0.030019
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000559 -0.586950 -1.000000 0.203888 0.773208 0.789575 0.992410 1.000000 0.999258 0.999425 0.999693 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.808906 0.822941 1.089264 1.815912 2.309947 0.072378 0.207264 0.300219 1.465979 1.668607 2.281917 2.140277 2.484143 2.663426 2.849519 3.042980 1.091840 0.810996 6.776755 ]
f(x) =0.633910
Adding constraint 68
Active constraints are [ 77 17 3 4 5 76 69 75 2 71 67 63 73 74 72 70 68 ]
All constraints satisfied. Feasible solution found.
EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match
#
echo "Running octave-cli -q " $prog

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi


#
# this much worked
#
pass
