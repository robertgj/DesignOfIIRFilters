#!/bin/sh

prog=goldfarb_idnani_fir_minimum_phase_test.m

depends="goldfarb_idnani_fir_minimum_phase_test.m \
test_common.m goldfarb_idnani.m iirE.m iirA.m iirP.m iirT.m Aerror.m \
Perror.m Terror.m xConstraints.m tf2x.m fixResultNaN.m updateWchol.m 
armijo_kim.m invSVD.m sqp_bfgs.m updateWbfgs.m qroots.m qzsolve.oct"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
maxiter =    2.5000e+03
tol =    1.0000e-03
fapl =    1.0000e-01
fapu =    2.0000e-01
dBap =    3.0000e+00
Wap =    1.0000e+00
fasl =    5.0000e-02
fasu =    2.5000e-01
dBas =    2.0000e+01
Wasl =    1.0000e+00
Wasu =    1.0000e+00
N =    4.1000e+01
R =    1.0000e+00
Initial x0 = [ -0.000553 -1.823326 -0.548448 3.775417 1.270032 1.268984 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.788032 0.787381 0.264871 0.761172 0.779415 1.106564 3.042980 2.849519 2.663426 2.484143 2.140277 1.975570 1.679377 1.584821 0.300219 0.207264 0.072378 2.309947 1.818770 1.106564 0.779415 0.761172 ]
ans =   -1.0000e+00
Active constraints are [ ]
Step 1: Trying constraint 59 at g(59) = [ -2.775417 ]
Step 2a: step direction in primal space d = [ 0.000000 0.000000 0.000000 -1.123477 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ]
Step 2b)ii): full step length t2 = 2.470382
Step 2b)iii): selecting step length t = 2.470382
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000553 -1.823326 -0.548448 1.000000 1.270032 1.268984 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.788032 0.787381 0.264871 0.761172 0.779415 1.106564 3.042980 2.849519 2.663426 2.484143 2.140277 1.975570 1.679377 1.584821 0.300219 0.207264 0.072378 2.309947 1.818770 1.106564 0.779415 0.761172 ]
f(x) =0.662508
Adding constraint 59
Active constraints are [ 59 ]
Step 1: Trying constraint 16 at g(16) = [ -0.823326 ]
Step 2a: step direction in primal space d = [ -0.000047 4.449903 -0.071789 -0.000000 0.014098 0.014374 0.037449 0.036689 0.035270 0.033204 0.027112 0.023114 0.014229 0.011010 0.008928 0.010942 0.012671 0.030487 0.018656 -0.018270 -0.017862 -0.066485 0.022324 -0.002290 0.005811 0.000000 0.000000 0.000000 0.000000 0.000000 0.628015 0.062700 0.045052 -0.000000 -0.000000 -0.000000 0.000000 0.114690 0.005811 -0.002290 0.018602 ]
Step 2a: step direction in dual space r = [ -0.063493 ]
Step 2b)ii): full step length t2 = 0.185021
Step 2b)iii): selecting step length t = 0.185021
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000562 -1.000000 -0.561731 1.000000 1.272641 1.271643 1.006929 1.006788 1.006526 1.006144 1.005016 1.004277 1.002633 1.002037 1.001652 1.002025 1.002344 1.005641 1.003452 0.784652 0.784077 0.252570 0.765303 0.778991 1.107639 3.042980 2.849519 2.663426 2.484143 2.140277 2.091766 1.690978 1.593157 0.300219 0.207264 0.072378 2.309947 1.839990 1.107639 0.778991 0.764614 ]
f(x) =0.660183
Adding constraint 16
Active constraints are [ 59 16 ]
Step 1: Trying constraint 3 at g(3) = [ -0.730256 ]
Step 2a: step direction in primal space d = [ 0.000002 -0.000000 0.002531 0.000000 -0.000585 -0.000690 -0.001309 -0.001284 -0.001237 -0.001169 -0.000964 -0.000823 -0.000514 -0.000399 -0.000324 -0.000397 -0.000459 -0.001078 -0.000670 0.001165 0.000875 0.002365 0.131777 0.001120 -0.000906 -0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.000792 -0.001483 -0.000956 -0.000000 0.000000 0.000000 -0.000000 -0.002745 -0.000886 0.001097 -0.000306 ]
Step 2a: step direction in dual space r = [ 0.011345 0.003726 ]
Step 2b)i): partial step length t1 = 49.662250
Step 2b)ii): full step length t2 = 45.140099
Step 2b)iii): selecting step length t = 45.140099
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000493 -1.000000 -0.447499 1.000000 1.246218 1.240484 0.947824 0.948812 0.950665 0.953380 0.961523 0.967146 0.979423 0.984022 0.987031 0.984117 0.981628 0.956987 0.973195 0.837251 0.823553 0.359335 6.713731 0.829564 1.066727 3.042980 2.849519 2.663426 2.484143 2.140276 2.056016 1.624020 1.550023 0.300219 0.207264 0.072378 2.309947 1.716083 1.067659 0.828493 0.750816 ]
f(x) =0.639777
Adding constraint 3
Active constraints are [ 59 16 3 ]
Step 1: Trying constraint 4 at g(4) = [ -0.010746 ]
Step 2a: step direction in primal space d = [ -0.000002 -0.000000 -0.004561 0.000000 0.001512 0.001240 0.001493 0.001471 0.001431 0.001374 0.001207 0.001049 0.001196 0.001361 0.000344 0.000422 0.000489 0.001299 0.001242 -0.002793 -0.003302 -0.008548 0.004340 0.000073 0.001745 0.000000 0.000000 -0.000000 -0.000000 -0.000000 -0.008621 -0.010976 -0.012302 -0.000000 -0.000000 -0.000000 -0.000000 -0.014526 0.001956 -0.000002 0.004815 ]
Step 2a: step direction in dual space r = [ -0.000259 -0.001038 0.670955 ]
Step 2b)i): partial step length t1 = 67.277363
Step 2b)ii): full step length t2 = 5.282717
Step 2b)iii): selecting step length t = 5.282717
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000501 -1.000000 -0.471593 1.000000 1.254204 1.247034 0.955708 0.956583 0.958226 0.960637 0.967899 0.972686 0.985743 0.991213 0.988848 0.986345 0.984209 0.963848 0.979757 0.822495 0.806111 0.314178 6.736655 0.829948 1.075943 3.042980 2.849519 2.663426 2.484143 2.140276 2.010471 1.566037 1.485036 0.300219 0.207264 0.072378 2.309947 1.639347 1.077992 0.828485 0.776253 ]
f(x) =0.638124
Adding constraint 4
Active constraints are [ 59 16 3 4 ]
Step 1: Trying constraint 5 at g(5) = [ -0.008434 ]
Step 2a: step direction in primal space d = [ -0.000006 0.000000 -0.014939 -0.000000 0.003203 0.003051 0.005353 0.005274 0.005135 0.004954 0.004925 0.006420 0.002533 0.002282 0.001251 0.001533 0.001774 0.004792 0.003420 -0.005539 -0.005763 -0.020689 0.024204 -0.000033 0.002317 0.000000 0.000000 0.000000 -0.000000 -0.000000 -0.260061 0.015670 0.004052 -0.000000 -0.000000 -0.000000 -0.000000 0.044028 0.002419 -0.000066 0.008497 ]
Step 2a: step direction in dual space r = [ -0.004567 -0.005418 0.122968 -0.740234 ]
Step 2b)i): partial step length t1 = 338.264988
Step 2b)ii): full step length t2 = 0.466004
Step 2b)iii): selecting step length t = 0.466004
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000504 -1.000000 -0.478555 1.000000 1.255696 1.248455 0.958203 0.959041 0.960619 0.962946 0.970194 0.975678 0.986923 0.992276 0.989431 0.987059 0.985036 0.966081 0.981351 0.819913 0.803425 0.304537 6.747935 0.829932 1.077023 3.042980 2.849519 2.663426 2.484143 2.140276 1.889282 1.573339 1.486924 0.300219 0.207264 0.072378 2.309947 1.659865 1.079119 0.828454 0.780212 ]
f(x) =0.637884
Adding constraint 5
Active constraints are [ 59 16 3 4 5 ]
Step 1: Trying constraint 6 at g(6) = [ -0.001892 ]
Step 2a: step direction in primal space d = [ 0.000002 0.000000 0.000503 0.000000 -0.000334 -0.000357 -0.001352 -0.001282 -0.001078 0.000016 -0.000719 0.001867 -0.000521 -0.000378 -0.000341 -0.000419 -0.000485 0.004587 -0.000683 0.000165 0.000144 -0.000133 0.000528 0.000098 -0.000021 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.011440 -0.000572 -0.001087 0.000000 0.000000 0.000000 0.000000 0.000223 -0.000017 0.000097 0.000311 ]
Step 2a: step direction in dual space r = [ 0.003126 0.001687 0.036465 -0.133314 -0.212410 ]
Step 2b)i): partial step length t1 = 14.736563
Step 2b)ii): full step length t2 = 12.683205
Step 2b)iii): selecting step length t = 12.683205
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000480 -1.000000 -0.472181 1.000000 1.251457 1.243927 0.941061 0.942785 0.946951 0.963150 0.961079 0.999355 0.980315 0.987480 0.985101 0.981749 0.978885 1.024263 0.972693 0.822002 0.805252 0.302848 6.754637 0.831170 1.076751 3.042980 2.849519 2.663426 2.484143 2.140276 2.034373 1.566082 1.473136 0.300219 0.207264 0.072378 2.309947 1.662693 1.078901 0.829684 0.784161 ]
f(x) =0.637824
Adding constraint 6
Active constraints are [ 59 16 3 4 5 6 ]
Step 1: Trying constraint 73 at g(73) = [ -0.024263 ]
Step 2a: step direction in primal space d = [ -0.000163 0.000000 0.011536 -0.000000 0.019810 0.022340 0.108784 0.101558 0.080204 -0.019027 0.043920 -0.064241 0.039947 0.023027 0.028368 0.034798 0.040326 -0.246715 0.050857 0.006551 0.008814 0.095025 -0.037289 -0.007933 -0.006979 0.000000 0.000000 0.000001 0.000002 -0.000001 -0.293131 -0.042953 0.083306 -0.000000 -0.000000 -0.000000 -0.000003 -0.297076 -0.007675 -0.007801 -0.061467 ]
Step 2a: step direction in dual space r = [ -0.140366 -0.073146 -5.056037 10.026567 4.693123 81.384980 ]
Step 2b)i): partial step length t1 = 0.155842
Step 2b)ii): full step length t2 = 0.098346
Step 2b)iii): selecting step length t = 0.098346
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000496 -1.000000 -0.471047 1.000000 1.253405 1.246124 0.951760 0.952772 0.954839 0.961279 0.965398 0.993037 0.984244 0.989745 0.987891 0.985172 0.982851 1.000000 0.977694 0.822646 0.806119 0.312193 6.750970 0.830389 1.076065 3.042980 2.849519 2.663426 2.484143 2.140276 2.005545 1.561858 1.481329 0.300219 0.207264 0.072378 2.309947 1.633477 1.078146 0.828917 0.778116 ]
f(x) =0.637783
Adding constraint 73
Active constraints are [ 59 16 3 4 5 6 73 ]
Step 1: Trying constraint 61 at g(61) = [ -0.246124 ]
Step 2a: step direction in primal space d = [ -0.000011 0.000000 -0.009204 -0.000000 0.002846 -0.043046 0.008151 0.007825 0.006946 0.003175 0.004884 0.006206 0.003366 0.002984 0.002003 0.002456 0.002845 0.000000 0.004281 -0.003053 -0.003142 -0.007568 -0.012201 -0.000695 0.001194 0.000000 0.000000 0.000000 0.000000 -0.000000 -0.000355 0.002097 -0.001633 -0.000000 -0.000000 -0.000000 -0.000000 0.003204 0.001258 -0.000717 0.001554 ]
Step 2a: step direction in dual space r = [ -0.019139 -0.010940 0.593386 -0.872046 0.087830 5.781693 -0.032682 ]
Step 2b)i): partial step length t1 = 0.809333
Step 2b)ii): full step length t2 = 5.717672
Step 2b)iii): selecting step length t = 0.809333
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000505 -1.000000 -0.478495 1.000000 1.255708 1.211285 0.958357 0.959106 0.960460 0.963849 0.969351 0.998059 0.986968 0.992160 0.989512 0.987159 0.985153 1.000000 0.981159 0.820175 0.803576 0.306068 6.741096 0.829827 1.077031 3.042980 2.849519 2.663426 2.484143 2.140276 2.005258 1.563555 1.480007 0.300219 0.207264 0.072378 2.309947 1.636070 1.079164 0.828337 0.779374 ]
f(x) =0.637756
Dropping constraint 6
Step 2a: step direction in primal space d = [ -0.000042 0.000000 -0.051120 -0.000000 0.013230 -0.215942 0.031666 0.030726 0.028419 0.019471 0.021427 0.030948 0.013549 0.013208 0.007577 0.009288 0.010760 0.000000 0.017196 -0.018023 -0.018265 -0.052351 -0.082327 -0.003170 0.007518 0.000000 0.000000 0.000000 0.000000 -0.000000 0.020879 0.015149 -0.019191 -0.000000 -0.000000 -0.000000 -0.000000 0.048569 0.007896 -0.003337 0.015546 ]
Step 2a: step direction in dual space r = [ -0.010619 -0.006387 1.258845 -1.829050 -0.175170 -0.064385 ]
Step 2b)i): partial step length t1 = 32.643292
Step 2b)ii): full step length t2 = 0.978433
Step 2b)iii): selecting step length t = 0.978433
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000546 -1.000000 -0.528512 1.000000 1.268653 1.000000 0.989340 0.989169 0.988266 0.982900 0.990316 1.028340 1.000224 1.005083 0.996925 0.996247 0.995682 1.000000 0.997984 0.802541 0.785704 0.254845 6.660544 0.826726 1.084387 3.042980 2.849519 2.663426 2.484143 2.140276 2.025686 1.578378 1.461230 0.300219 0.207264 0.072378 2.309946 1.683592 1.086889 0.825071 0.794585 ]
f(x) =0.637598
Adding constraint 61
Active constraints are [ 59 16 3 4 5 73 61 ]
Step 1: Trying constraint 67 at g(67) = [ -0.028340 ]
Step 2a: step direction in primal space d = [ -0.000030 0.000000 -0.009038 -0.000000 0.005302 0.000000 0.021062 0.020041 0.017111 0.001285 0.011149 -0.246710 0.007939 0.005146 0.005275 0.006469 0.007495 0.000000 0.010324 -0.002642 -0.002524 0.001793 -0.008329 -0.001549 0.001139 0.000000 0.000000 0.000000 0.000000 -0.000000 0.046489 0.000784 0.002999 -0.000000 -0.000000 -0.000000 -0.000000 -0.019221 0.000486 -0.001537 -0.004904 ]
Step 2a: step direction in dual space r = [ -0.007761 -0.004896 0.331368 -1.073328 -0.088870 0.248104 -0.137390 ]
Step 2b)i): partial step length t1 = 0.756913
Step 2b)ii): full step length t2 = 0.114873
Step 2b)iii): selecting step length t = 0.114873
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000549 -1.000000 -0.529551 1.000000 1.269262 1.000000 0.991759 0.991471 0.990232 0.983047 0.991597 1.000000 1.001136 1.005675 0.997531 0.996990 0.996543 1.000000 0.999170 0.802237 0.785415 0.255051 6.659587 0.826548 1.084518 3.042980 2.849519 2.663426 2.484143 2.140276 2.031027 1.578468 1.461574 0.300219 0.207264 0.072378 2.309946 1.681384 1.086945 0.824895 0.794021 ]
f(x) =0.637586
Adding constraint 67
Active constraints are [ 59 16 3 4 5 73 61 67 ]
Step 1: Trying constraint 68 at g(68) = [ -0.001136 ]
Step 2a: step direction in primal space d = [ 0.000020 0.000000 -0.009618 -0.000000 -0.001688 -0.000000 -0.012838 -0.011772 -0.008532 0.006558 -0.003730 -0.000000 -0.137348 -0.003725 -0.003433 -0.004213 -0.004885 -0.000000 -0.006128 -0.002553 -0.002919 -0.021427 0.021138 0.001032 0.002269 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.099196 0.019047 -0.013695 0.000000 0.000000 0.000000 0.000001 0.073932 0.001419 0.001055 0.010593 ]
Step 2a: step direction in dual space r = [ -0.009022 -0.005722 0.487739 -1.292154 -0.168060 -0.121942 -0.057078 -0.034232 ]
Step 2b)i): partial step length t1 = 81.648361
Step 2b)ii): full step length t2 = 0.008274
Step 2b)iii): selecting step length t = 0.008274
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000549 -1.000000 -0.529630 1.000000 1.269248 1.000000 0.991653 0.991374 0.990161 0.983101 0.991566 1.000000 1.000000 1.005644 0.997503 0.996956 0.996502 1.000000 0.999119 0.802216 0.785390 0.254874 6.659762 0.826556 1.084537 3.042980 2.849519 2.663426 2.484143 2.140276 2.031847 1.578626 1.461461 0.300219 0.207264 0.072378 2.309946 1.681996 1.086957 0.824904 0.794109 ]
f(x) =0.637584
Adding constraint 68
Active constraints are [ 59 16 3 4 5 73 61 67 68 ]
Step 1: Trying constraint 69 at g(69) = [ -0.005644 ]
Step 2a: step direction in primal space d = [ 0.000012 0.000000 -0.002957 0.000000 -0.001868 0.000000 -0.007846 -0.007247 -0.005430 0.003161 -0.002732 0.000000 -0.000000 -0.105702 -0.002064 -0.002533 -0.002937 -0.000000 -0.004203 0.000475 0.000539 -0.006497 0.009600 0.000511 0.000362 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.075749 0.019155 -0.000323 0.000000 0.000000 0.000000 0.000000 0.053213 -0.000538 0.000591 0.002620 ]
Step 2a: step direction in dual space r = [ -0.006710 -0.004293 0.426326 -1.040744 -0.143375 -0.073397 -0.051782 -0.021589 0.028094 ]
Step 2b)i): partial step length t1 = 0.294491
Step 2b)ii): full step length t2 = 0.053393
Step 2b)iii): selecting step length t = 0.053393
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000549 -1.000000 -0.529788 1.000000 1.269148 1.000000 0.991234 0.990987 0.989871 0.983270 0.991420 1.000000 1.000000 1.000000 0.997393 0.996820 0.996345 1.000000 0.998895 0.802242 0.785419 0.254527 6.660275 0.826583 1.084556 3.042980 2.849519 2.663426 2.484143 2.140276 2.035892 1.579648 1.461444 0.300219 0.207264 0.072378 2.309946 1.684837 1.086928 0.824935 0.794249 ]
f(x) =0.637581
Adding constraint 69
Active constraints are [ 59 16 3 4 5 73 61 67 68 69 ]
Step 1: Trying constraint 2 at g(2) = [ -0.001571 ]
Step 2a: step direction in primal space d = [ 0.000001 0.000000 0.000897 -0.000000 -0.000008 0.000000 -0.000909 -0.000867 -0.000751 -0.000270 -0.000508 -0.000000 -0.000000 -0.000000 -0.000223 -0.000280 -0.000327 -0.000000 -0.000441 -0.000526 -0.000442 0.000893 0.013950 -0.000395 0.001849 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.003186 0.000187 0.000413 0.000000 0.000000 0.000000 0.000000 0.001119 0.000186 -0.000388 -0.000489 ]
Step 2a: step direction in dual space r = [ -0.002656 -0.000646 1.181666 0.055587 0.029707 -0.002335 0.016010 0.000287 0.002654 0.002239 ]
Step 2b)i): partial step length t1 = 2.551890
Step 2b)ii): full step length t2 = 7.401924
Step 2b)iii): selecting step length t = 2.551890
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000545 -1.000000 -0.527499 1.000000 1.269129 1.000000 0.988915 0.988775 0.987954 0.982581 0.990124 1.000000 1.000000 1.000000 0.996824 0.996106 0.995511 1.000000 0.997769 0.800900 0.784291 0.256807 6.695874 0.825577 1.089274 3.042980 2.849519 2.663426 2.484143 2.140276 2.044023 1.580126 1.462498 0.300219 0.207264 0.072378 2.309946 1.687694 1.087404 0.823945 0.793001 ]
f(x) =0.637135
Dropping constraint 68
Step 2a: step direction in primal space d = [ 0.000006 0.000000 0.003657 0.000000 -0.000017 -0.000000 -0.004079 -0.003883 -0.003336 -0.001029 -0.002224 0.000000 -0.001787 0.000000 -0.001005 -0.001260 -0.001473 0.000000 -0.001980 -0.002343 -0.002040 0.003488 0.054997 -0.001726 0.008268 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.016243 0.001106 0.001593 0.000000 0.000000 0.000000 0.000000 0.005971 0.000892 -0.001689 -0.001939 ]
Step 2a: step direction in dual space r = [ -0.003355 -0.000878 1.315042 0.044751 0.033231 -0.002930 0.019202 0.000136 0.002281 ]
Step 2b)i): partial step length t1 = 20.899527
Step 2b)ii): full step length t2 = 1.207258
Step 2b)iii): selecting step length t = 1.207258
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000538 -1.000000 -0.523084 1.000000 1.269108 1.000000 0.983991 0.984087 0.983927 0.981338 0.987439 1.000000 0.997843 1.000000 0.995611 0.994585 0.993733 1.000000 0.995378 0.798072 0.781828 0.261019 6.762270 0.823493 1.099255 3.042980 2.849519 2.663426 2.484143 2.140276 2.063633 1.581462 1.464421 0.300219 0.207264 0.072378 2.309946 1.694902 1.088480 0.821907 0.790661 ]
f(x) =0.636187
Adding constraint 2
Active constraints are [ 59 16 3 4 5 73 61 67 69 2 ]
Step 1: Trying constraint 60 at g(60) = [ -0.269108 ]
Step 2a: step direction in primal space d = [ 0.000010 0.000000 -0.009916 -0.000000 -0.043310 0.000000 -0.005699 -0.005102 -0.003242 0.005656 -0.000793 -0.000000 -0.009956 0.000000 -0.001583 -0.001945 -0.002256 0.000000 -0.002704 -0.002972 -0.003306 -0.017386 -0.000096 0.000289 0.003075 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.076229 0.013865 -0.013853 0.000000 0.000000 0.000000 0.000000 0.053805 0.001542 0.000333 0.007655 ]
Step 2a: step direction in dual space r = [ -0.008941 -0.005575 0.853519 -1.692887 -0.231953 -0.070619 -0.045869 -0.023291 0.010486 0.045143 ]
Step 2b)i): partial step length t1 = 4.284526
Step 2b)ii): full step length t2 = 6.213508
Step 2b)iii): selecting step length t = 4.284526
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000497 -1.000000 -0.565569 1.000000 1.083544 1.000000 0.959573 0.962226 0.970038 1.005571 0.984043 1.000000 0.955186 1.000000 0.988827 0.986252 0.984067 1.000000 0.983793 0.785338 0.767664 0.186529 6.761859 0.824729 1.112428 3.042980 2.849519 2.663426 2.484142 2.140277 2.390239 1.640868 1.405067 0.300219 0.207264 0.072378 2.309948 1.925430 1.095086 0.823334 0.823457 ]
f(x) =0.634130
Dropping constraint 69
Step 2a: step direction in primal space d = [ 0.000004 0.000000 -0.025311 0.000000 -0.162405 0.000000 -0.001859 -0.001163 0.001211 0.013836 0.002961 0.000000 0.014061 0.028801 -0.000854 -0.001117 -0.001324 0.000000 0.006728 -0.017217 -0.017601 -0.029475 -0.000339 -0.015990 0.038100 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.263283 0.046929 0.001539 0.000000 0.000000 0.000000 0.000000 0.000944 0.007904 -0.006636 0.006519 ]
Step 2a: step direction in dual space r = [ -0.030435 -0.013232 8.159907 -0.097495 -1.902981 0.060542 0.027624 -0.008776 2.735874 ]
Step 2b)i): partial step length t1 = 1.303325
Step 2b)ii): full step length t2 = 0.514420
Step 2b)iii): selecting step length t = 0.514420
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000495 -1.000000 -0.578589 1.000000 1.000000 1.000000 0.958616 0.961628 0.970660 1.012689 0.985566 1.000000 0.962420 1.014816 0.988388 0.985678 0.983386 1.000000 0.987254 0.776481 0.758610 0.171367 6.761684 0.816504 1.132028 3.042980 2.849519 2.663426 2.484142 2.140277 2.525676 1.665010 1.405858 0.300219 0.207264 0.072378 2.309948 1.925915 1.099152 0.819920 0.826810 ]
f(x) =0.633631
Adding constraint 60
Active constraints are [ 59 16 3 4 5 73 61 67 2 60 ]
Step 1: Trying constraint 69 at g(69) = [ -0.014816 ]
Step 2a: step direction in primal space d = [ -0.000008 -0.000000 -0.068188 0.000000 -0.000000 0.000000 0.010673 0.011343 0.013887 0.027901 0.014590 0.000000 -0.007012 -0.105912 0.001924 0.002363 0.002741 -0.000000 0.011267 -0.030887 -0.033492 -0.106004 0.000521 -0.008499 0.019502 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.025656 -0.028531 -0.200599 -0.000000 -0.000000 -0.000000 0.000001 -0.016869 0.017915 -0.000951 0.051525 ]
Step 2a: step direction in dual space r = [ -0.032542 -0.014760 4.251217 6.492981 -0.580371 -0.081767 0.067909 -0.023515 2.620870 0.060172 ]
Step 2b)i): partial step length t1 = 0.823522
Step 2b)ii): full step length t2 = 0.139890
Step 2b)iii): selecting step length t = 0.139890
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000496 -1.000000 -0.588128 1.000000 1.000000 1.000000 0.960109 0.963215 0.972603 1.016592 0.987607 1.000000 0.961439 1.000000 0.988657 0.986008 0.983769 1.000000 0.988830 0.772161 0.753925 0.156538 6.761757 0.815315 1.134756 3.042980 2.849519 2.663426 2.484142 2.140277 2.529265 1.661018 1.377796 0.300219 0.207264 0.072378 2.309948 1.923555 1.101658 0.819787 0.834018 ]
f(x) =0.633456
Adding constraint 69
Active constraints are [ 59 16 3 4 5 73 61 67 2 60 69 ]
Step 1: Trying constraint 65 at g(65) = [ -0.016592 ]
Step 2a: step direction in primal space d = [ -0.000007 0.000000 0.006650 -0.000000 -0.000000 -0.000000 0.003463 0.003196 0.002479 -0.308796 0.000263 0.000000 0.017368 -0.000000 0.000913 0.001076 0.001229 0.000000 -0.000125 -0.000501 0.000930 0.024510 0.001470 -0.009812 0.013140 0.000000 0.000000 0.000000 0.000000 0.000000 0.336541 0.012564 -0.002387 0.000000 0.000000 0.000000 -0.000000 -0.001926 -0.001273 -0.004408 -0.015513 ]
Step 2a: step direction in dual space r = [ -0.026757 -0.013037 2.733208 1.018620 0.177738 0.001284 -0.027124 -0.009816 0.509442 -0.028494 -0.024505 ]
Step 2b)i): partial step length t1 = 3.517006
Step 2b)ii): full step length t2 = 0.053731
Step 2b)iii): selecting step length t = 0.053731
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000497 -1.000000 -0.587771 1.000000 1.000000 1.000000 0.960295 0.963387 0.972736 1.000000 0.987621 1.000000 0.962372 1.000000 0.988706 0.986066 0.983835 1.000000 0.988824 0.772134 0.753975 0.157855 6.761836 0.814788 1.135462 3.042980 2.849519 2.663426 2.484142 2.140277 2.547348 1.661694 1.377668 0.300219 0.207264 0.072378 2.309948 1.923452 1.101589 0.819550 0.833185 ]
f(x) =0.633434
Adding constraint 65
Active constraints are [ 59 16 3 4 5 73 61 67 2 60 69 65 ]
All constraints satisfied. Feasible solution found.
EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match
#
echo "Running octave-cli -q " $prog

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi


#
# this much worked
#
pass
