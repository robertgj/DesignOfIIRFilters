#!/bin/sh

prog=goldfarb_idnani_fir_minimum_phase_test.m

depends="goldfarb_idnani_fir_minimum_phase_test.m \
test_common.m goldfarb_idnani.m iirE.m iirA.m iirP.m iirT.m Aerror.m \
Perror.m Terror.m xConstraints.m tf2x.m fixResultNaN.m updateWchol.m 
armijo_kim.m invSVD.m sqp_bfgs.m updateWbfgs.m"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
maxiter =    2.5000e+03
tol =    1.0000e-03
fapl =    1.0000e-01
fapu =    2.0000e-01
dBap =    3.0000e+00
Wap =    1.0000e+00
fasl =    5.0000e-02
fasu =    2.5000e-01
dBas =    2.0000e+01
Wasl =    1.0000e+00
Wasu =    1.0000e+00
N =    4.1000e+01
R =    1.0000e+00
Initial x0 = [ -0.000553 -1.823326 -0.548448 3.775417 1.268984 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.270032 1.000000 1.000000 1.000000 0.788032 0.787381 0.264871 0.761172 1.106564 3.042980 2.849519 2.663426 2.484143 2.309947 2.140277 1.975570 1.818770 1.679377 1.584821 0.779415 0.072378 0.207264 0.300219 1.106564 0.779415 0.761172 ]
ans =   -1.0000e+00
Active constraints are [ ]
Step 1: Trying constraint 59 at g(59) = [ -2.775417 ]
Step 2a: step direction in primal space d = [ 0.000000 0.000000 0.000000 -1.123477 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 ]
Step 2b)ii): full step length t2 = 2.470382
Step 2b)iii): selecting step length t = 2.470382
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000553 -1.823326 -0.548448 1.000000 1.268984 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.270032 1.000000 1.000000 1.000000 0.788032 0.787381 0.264871 0.761172 1.106564 3.042980 2.849519 2.663426 2.484143 2.309947 2.140277 1.975570 1.818770 1.679377 1.584821 0.779415 0.072378 0.207264 0.300219 1.106564 0.779415 0.761172 ]
f(x) =0.662508
Adding constraint 59
Active constraints are [ 59 ]
Step 1: Trying constraint 16 at g(16) = [ -0.823326 ]
Step 2a: step direction in primal space d = [ -0.000047 4.449903 -0.071789 0.000000 0.014374 0.037449 0.036689 0.035270 0.033204 0.030487 0.027112 0.023114 0.018656 0.014229 0.011010 0.014098 0.012671 0.010942 0.008928 -0.018270 -0.017862 -0.066485 0.022324 0.005811 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000 0.628015 0.114690 0.062700 0.045052 -0.002290 -0.000000 -0.000000 -0.000000 0.005811 -0.002290 0.018602 ]
Step 2a: step direction in dual space r = [ -0.063493 ]
Step 2b)ii): full step length t2 = 0.185021
Step 2b)iii): selecting step length t = 0.185021
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000562 -1.000000 -0.561731 1.000000 1.271643 1.006929 1.006788 1.006526 1.006144 1.005641 1.005016 1.004277 1.003452 1.002633 1.002037 1.272641 1.002344 1.002025 1.001652 0.784652 0.784077 0.252570 0.765303 1.107639 3.042980 2.849519 2.663426 2.484143 2.309947 2.140277 2.091766 1.839990 1.690978 1.593157 0.778991 0.072378 0.207264 0.300219 1.107639 0.778991 0.764614 ]
f(x) =0.660183
Adding constraint 16
Active constraints are [ 59 16 ]
Step 1: Trying constraint 3 at g(3) = [ -0.730256 ]
Step 2a: step direction in primal space d = [ 0.000002 0.000000 0.002531 0.000000 -0.000690 -0.001309 -0.001284 -0.001237 -0.001169 -0.001078 -0.000964 -0.000823 -0.000670 -0.000514 -0.000399 -0.000585 -0.000459 -0.000397 -0.000324 0.001165 0.000875 0.002365 0.131777 -0.000906 -0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.000792 -0.002745 -0.001483 -0.000956 0.001120 0.000000 0.000000 -0.000000 -0.000886 0.001097 -0.000306 ]
Step 2a: step direction in dual space r = [ 0.011345 0.003726 ]
Step 2b)i): partial step length t1 = 49.662250
Step 2b)ii): full step length t2 = 45.140099
Step 2b)iii): selecting step length t = 45.140099
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000493 -1.000000 -0.447499 1.000000 1.240484 0.947824 0.948812 0.950665 0.953380 0.956987 0.961523 0.967146 0.973195 0.979423 0.984022 1.246218 0.981628 0.984117 0.987031 0.837251 0.823553 0.359335 6.713731 1.066727 3.042980 2.849519 2.663426 2.484143 2.309947 2.140276 2.056016 1.716083 1.624020 1.550023 0.829564 0.072378 0.207264 0.300219 1.067659 0.828493 0.750816 ]
f(x) =0.639777
Adding constraint 3
Active constraints are [ 59 16 3 ]
Step 1: Trying constraint 4 at g(4) = [ -0.010746 ]
Step 2a: step direction in primal space d = [ -0.000002 -0.000000 -0.004561 -0.000000 0.001240 0.001493 0.001471 0.001431 0.001374 0.001299 0.001207 0.001049 0.001242 0.001196 0.001361 0.001512 0.000489 0.000422 0.000344 -0.002793 -0.003302 -0.008548 0.004340 0.001745 0.000000 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 -0.008621 -0.014526 -0.010976 -0.012302 0.000073 -0.000000 -0.000000 -0.000000 0.001956 -0.000002 0.004815 ]
Step 2a: step direction in dual space r = [ -0.000259 -0.001038 0.670955 ]
Step 2b)i): partial step length t1 = 67.277363
Step 2b)ii): full step length t2 = 5.282717
Step 2b)iii): selecting step length t = 5.282717
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000501 -1.000000 -0.471593 1.000000 1.247034 0.955708 0.956583 0.958226 0.960637 0.963848 0.967899 0.972686 0.979757 0.985743 0.991213 1.254204 0.984209 0.986345 0.988848 0.822495 0.806111 0.314178 6.736655 1.075943 3.042980 2.849519 2.663426 2.484143 2.309947 2.140276 2.010471 1.639347 1.566037 1.485036 0.829948 0.072378 0.207264 0.300219 1.077992 0.828485 0.776253 ]
f(x) =0.638124
Adding constraint 4
Active constraints are [ 59 16 3 4 ]
Step 1: Trying constraint 5 at g(5) = [ -0.008434 ]
Step 2a: step direction in primal space d = [ -0.000006 -0.000000 -0.014939 0.000000 0.003051 0.005353 0.005274 0.005135 0.004954 0.004792 0.004925 0.006420 0.003420 0.002533 0.002282 0.003203 0.001774 0.001533 0.001251 -0.005539 -0.005763 -0.020689 0.024204 0.002317 0.000000 0.000000 0.000000 -0.000000 -0.000000 -0.000000 -0.260061 0.044028 0.015670 0.004052 -0.000033 -0.000000 -0.000000 -0.000000 0.002419 -0.000066 0.008497 ]
Step 2a: step direction in dual space r = [ -0.004567 -0.005418 0.122968 -0.740234 ]
Step 2b)i): partial step length t1 = 338.264988
Step 2b)ii): full step length t2 = 0.466004
Step 2b)iii): selecting step length t = 0.466004
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000504 -1.000000 -0.478555 1.000000 1.248455 0.958203 0.959041 0.960619 0.962946 0.966081 0.970194 0.975678 0.981351 0.986923 0.992276 1.255696 0.985036 0.987059 0.989431 0.819913 0.803425 0.304537 6.747935 1.077023 3.042980 2.849519 2.663426 2.484143 2.309947 2.140276 1.889282 1.659865 1.573339 1.486924 0.829932 0.072378 0.207264 0.300219 1.079119 0.828454 0.780212 ]
f(x) =0.637884
Adding constraint 5
Active constraints are [ 59 16 3 4 5 ]
Step 1: Trying constraint 6 at g(6) = [ -0.001892 ]
Step 2a: step direction in primal space d = [ 0.000002 0.000000 0.000503 -0.000000 -0.000357 -0.001352 -0.001282 -0.001078 0.000016 0.004587 -0.000719 0.001867 -0.000683 -0.000521 -0.000378 -0.000334 -0.000485 -0.000419 -0.000341 0.000165 0.000144 -0.000133 0.000528 -0.000021 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.011440 0.000223 -0.000572 -0.001087 0.000098 0.000000 0.000000 0.000000 -0.000017 0.000097 0.000311 ]
Step 2a: step direction in dual space r = [ 0.003126 0.001687 0.036465 -0.133314 -0.212410 ]
Step 2b)i): partial step length t1 = 14.736563
Step 2b)ii): full step length t2 = 12.683205
Step 2b)iii): selecting step length t = 12.683205
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000480 -1.000000 -0.472181 1.000000 1.243927 0.941061 0.942785 0.946951 0.963150 1.024263 0.961079 0.999355 0.972693 0.980315 0.987480 1.251457 0.978885 0.981749 0.985101 0.822002 0.805252 0.302848 6.754637 1.076751 3.042980 2.849519 2.663426 2.484143 2.309947 2.140276 2.034373 1.662693 1.566082 1.473136 0.831170 0.072378 0.207264 0.300219 1.078901 0.829684 0.784161 ]
f(x) =0.637824
Adding constraint 6
Active constraints are [ 59 16 3 4 5 6 ]
Step 1: Trying constraint 71 at g(71) = [ -0.251457 ]
Step 2a: step direction in primal space d = [ 0.000002 -0.000000 -0.010563 -0.000000 0.001004 -0.000973 -0.000716 0.000147 0.005236 0.019810 0.001137 0.011129 -0.000011 0.000081 0.001501 -0.042089 -0.000521 -0.000449 -0.000365 -0.003607 -0.003900 -0.015767 -0.010033 0.001786 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.022881 0.028651 0.005974 -0.010185 -0.000039 -0.000000 -0.000000 -0.000000 0.001892 -0.000061 0.006764 ]
Step 2a: step direction in dual space r = [ -0.006512 -0.004316 1.044024 -1.918045 -0.306009 -1.270793 ]
Step 2b)i): partial step length t1 = 39.343749
Step 2b)ii): full step length t2 = 5.974448
Step 2b)iii): selecting step length t = 5.974448
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000466 -1.000000 -0.535288 1.000000 1.249923 0.935249 0.938510 0.947828 0.994433 1.142615 0.967873 1.065842 0.972627 0.980796 0.996445 1.000000 0.975772 0.979066 0.982919 0.800451 0.781953 0.208646 6.694697 1.087424 3.042980 2.849519 2.663426 2.484142 2.309948 2.140277 2.171074 1.833867 1.601773 1.412289 0.830936 0.072378 0.207264 0.300219 1.090206 0.829320 0.824573 ]
f(x) =0.637701
Adding constraint 71
Active constraints are [ 59 16 3 4 5 6 71 ]
Step 1: Trying constraint 65 at g(65) = [ -0.142615 ]
Step 2a: step direction in primal space d = [ -0.000215 0.000000 -0.086964 0.000000 0.044339 0.154894 0.147355 0.125839 0.019260 -0.696226 0.084584 -0.165490 0.069216 0.061857 -0.004757 0.000000 0.055242 0.047679 0.038879 -0.029726 -0.029182 -0.029431 0.128690 0.008308 0.000000 0.000000 0.000001 0.000002 -0.000003 -0.000001 -0.726125 -0.196806 0.002577 0.002613 -0.002347 -0.000000 -0.000000 -0.000000 0.008798 -0.009326 -0.010693 ]
Step 2a: step direction in dual space r = [ -0.038903 -0.024355 -3.301808 5.151530 1.881900 8.718363 -0.660841 ]
Step 2b)i): partial step length t1 = 2.325608
Step 2b)ii): full step length t2 = 0.204841
Step 2b)iii): selecting step length t = 0.204841
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000510 -1.000000 -0.553101 1.000000 1.259005 0.966978 0.968694 0.973605 0.998378 1.000000 0.985200 1.031943 0.986805 0.993467 0.995471 1.000000 0.987088 0.988833 0.990883 0.794361 0.775975 0.202617 6.721058 1.089126 3.042980 2.849519 2.663426 2.484142 2.309947 2.140277 2.022334 1.793553 1.602301 1.412824 0.830455 0.072378 0.207264 0.300219 1.092008 0.827410 0.822382 ]
f(x) =0.637166
Adding constraint 65
Active constraints are [ 59 16 3 4 5 6 71 65 ]
Step 1: Trying constraint 67 at g(67) = [ -0.031943 ]
Step 2a: step direction in primal space d = [ -0.000041 -0.000000 -0.008968 -0.000000 0.007000 0.029204 0.027732 0.023557 0.004575 0.000000 0.015411 -0.244872 0.013880 0.010962 -0.003436 -0.000000 0.010459 0.009027 0.007361 -0.001517 -0.000978 0.009901 0.002297 -0.000600 0.000000 0.000000 0.000000 0.000000 -0.000001 -0.000000 -0.004675 -0.043522 0.003424 0.014886 -0.001364 -0.000000 -0.000000 -0.000000 -0.000726 -0.002025 -0.009503 ]
Step 2a: step direction in dual space r = [ -0.019263 -0.011142 -0.361125 1.304972 0.502721 11.556002 -0.173909 0.263978 ]
Step 2b)i): partial step length t1 = 0.775978
Step 2b)ii): full step length t2 = 0.130448
Step 2b)iii): selecting step length t = 0.130448
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000515 -1.000000 -0.554271 1.000000 1.259918 0.970788 0.972312 0.976678 0.998975 1.000000 0.987210 1.000000 0.988616 0.994897 0.995022 1.000000 0.988452 0.990010 0.991843 0.794164 0.775848 0.203909 6.721357 1.089048 3.042980 2.849519 2.663426 2.484142 2.309947 2.140277 2.021724 1.787875 1.602748 1.414766 0.830277 0.072378 0.207264 0.300219 1.091913 0.827146 0.821143 ]
f(x) =0.637164
Adding constraint 67
Active constraints are [ 59 16 3 4 5 6 71 65 67 ]
Step 1: Trying constraint 60 at g(60) = [ -0.259918 ]
Step 2a: step direction in primal space d = [ -0.000013 -0.000000 -0.005947 0.000000 -0.043836 0.009113 0.008774 0.007965 0.007635 0.000000 0.005849 0.000000 0.003948 0.003056 0.003279 0.000000 0.003199 0.002761 0.002253 -0.000128 0.000227 0.002226 -0.003001 -0.000633 0.000000 0.000000 0.000000 0.000000 -0.000000 -0.000000 0.002644 -0.001724 0.011027 0.014147 -0.001287 -0.000000 -0.000000 -0.000000 -0.000791 -0.000686 -0.003061 ]
Step 2a: step direction in dual space r = [ -0.022673 -0.012874 0.246536 -0.114419 0.504924 14.375307 -0.073289 -0.024579 -0.023579 ]
Step 2b)i): partial step length t1 = 1.181342
Step 2b)ii): full step length t2 = 5.929345
Step 2b)iii): selecting step length t = 1.181342
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000530 -1.000000 -0.561297 1.000000 1.208133 0.981553 0.982677 0.986087 1.007994 1.000000 0.994119 1.000000 0.993280 0.998508 0.998897 1.000000 0.992231 0.993273 0.994504 0.794012 0.776115 0.206539 6.717813 1.088300 3.042980 2.849519 2.663426 2.484143 2.309947 2.140277 2.024847 1.785838 1.615774 1.431478 0.828757 0.072378 0.207264 0.300219 1.090978 0.826335 0.817526 ]
f(x) =0.637089
Dropping constraint 6
Step 2a: step direction in primal space d = [ -0.000056 0.000000 -0.045332 0.000000 -0.202682 0.041957 0.040615 0.037571 0.037455 -0.000000 0.028306 0.000000 0.019732 0.015481 0.017053 -0.000000 0.014490 0.012508 0.010202 -0.010721 -0.010238 -0.023965 -0.056324 0.003377 0.000000 0.000000 0.000000 0.000000 -0.000001 -0.000000 0.014056 0.011509 0.035210 -0.003773 -0.009520 -0.000000 -0.000000 -0.000000 0.002838 -0.003470 0.002440 ]
Step 2a: step direction in dual space r = [ -0.013809 -0.007774 2.005508 -2.177602 -0.642021 -0.005258 -0.046785 -0.042820 ]
Step 2b)i): partial step length t1 = 17.586851
Step 2b)ii): full step length t2 = 1.026895
Step 2b)iii): selecting step length t = 1.026895
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000588 -1.000000 -0.607848 1.000000 1.000000 1.024638 1.024384 1.024669 1.046457 1.000000 1.023187 1.000000 1.013543 1.014405 1.016408 1.000000 1.007111 1.006118 1.004981 0.783004 0.765602 0.181929 6.659974 1.091768 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.039281 1.797657 1.651931 1.427604 0.818981 0.072378 0.207264 0.300219 1.093892 0.822772 0.820032 ]
f(x) =0.635032
Adding constraint 60
Active constraints are [ 59 16 3 4 5 71 65 67 60 ]
Step 1: Trying constraint 74 at g(74) = [ -0.004981 ]
Step 2a: step direction in primal space d = [ 0.000003 0.000000 -0.000611 0.000000 0.000000 -0.002279 -0.002126 -0.001651 0.000869 -0.000000 -0.001161 0.000000 -0.001633 -0.001302 -0.004462 0.000000 -0.000822 -0.000709 -0.083602 0.000672 0.000785 -0.000341 0.000420 0.000039 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.068061 0.024321 0.009309 0.001925 -0.000640 0.000000 0.000000 0.000000 -0.000579 0.000137 -0.000517 ]
Step 2a: step direction in dual space r = [ -0.005415 -0.003209 0.400540 -0.369233 -0.256277 -0.005279 -0.047422 -0.032269 -0.047420 ]
Step 2b)i): partial step length t1 = 82.915974
Step 2b)ii): full step length t2 = 0.059574
Step 2b)iii): selecting step length t = 0.059574
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000588 -1.000000 -0.607884 1.000000 1.000000 1.024503 1.024258 1.024571 1.046509 1.000000 1.023117 1.000000 1.013445 1.014327 1.016142 1.000000 1.007062 1.006075 1.000000 0.783044 0.765649 0.181909 6.659999 1.091770 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.043336 1.799106 1.652486 1.427719 0.818943 0.072378 0.207264 0.300219 1.093858 0.822780 0.820001 ]
f(x) =0.635032
Adding constraint 74
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 ]
Step 1: Trying constraint 73 at g(73) = [ -0.006075 ]
Step 2a: step direction in primal space d = [ 0.000004 0.000000 -0.000546 -0.000000 0.000000 -0.002894 -0.002704 -0.002116 0.000985 0.000000 -0.001499 0.000000 -0.002060 -0.001635 -0.005399 -0.000000 -0.001042 -0.102650 -0.000000 0.000884 0.001024 -0.000190 0.000025 0.000026 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.085685 0.029430 0.011191 0.002203 -0.000784 0.000000 0.000000 0.000000 -0.000730 0.000170 -0.000709 ]
Step 2a: step direction in dual space r = [ -0.006555 -0.003876 0.491656 -0.443991 -0.312307 -0.005941 -0.057996 -0.039326 -0.057506 0.009222 ]
Step 2b)i): partial step length t1 = 6.460182
Step 2b)ii): full step length t2 = 0.059185
Step 2b)iii): selecting step length t = 0.059185
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000588 -1.000000 -0.607917 1.000000 1.000000 1.024331 1.024098 1.024446 1.046567 1.000000 1.023029 1.000000 1.013323 1.014230 1.015823 1.000000 1.007000 1.000000 1.000000 0.783096 0.765710 0.181897 6.660000 1.091772 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.048407 1.800848 1.653148 1.427849 0.818896 0.072378 0.207264 0.300219 1.093815 0.822790 0.819959 ]
f(x) =0.635034
Adding constraint 73
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 ]
Step 1: Trying constraint 70 at g(70) = [ -0.015823 ]
Step 2a: step direction in primal space d = [ 0.000022 0.000000 0.039996 0.000000 -0.000000 -0.018356 -0.017904 -0.016830 -0.013109 0.000000 -0.013710 -0.000000 -0.012466 -0.010754 -0.101372 -0.000000 -0.006151 -0.000000 0.000000 0.021466 0.024174 0.064417 -0.023675 -0.012250 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.229406 0.060503 0.054615 0.095299 0.000817 0.000000 0.000000 0.000000 -0.013247 0.000734 -0.031939 ]
Step 2a: step direction in dual space r = [ -0.000819 -0.000089 -0.016505 1.388187 0.000323 0.016627 -0.006753 0.019137 -0.037287 0.053779 0.053523 ]
Step 2b)i): partial step length t1 = 1.097620
Step 2b)ii): full step length t2 = 0.156084
Step 2b)iii): selecting step length t = 0.156084
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000584 -1.000000 -0.601674 1.000000 1.000000 1.021466 1.021303 1.021819 1.044521 1.000000 1.020889 1.000000 1.011378 1.012552 1.000000 1.000000 1.006040 1.000000 1.000000 0.786446 0.769483 0.191952 6.656305 1.089860 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.084214 1.810291 1.661673 1.442724 0.819024 0.072378 0.207264 0.300219 1.091747 0.822905 0.814974 ]
f(x) =0.635254
Adding constraint 70
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 ]
Step 1: Trying constraint 72 at g(72) = [ -0.006040 ]
Step 2a: step direction in primal space d = [ 0.000005 -0.000000 -0.000679 -0.000000 0.000000 -0.003519 -0.003292 -0.002595 0.001059 -0.000000 -0.001842 -0.000000 -0.002364 -0.001788 -0.000000 0.000000 -0.119097 0.000000 0.000000 0.000559 0.000612 -0.001223 -0.004129 0.000474 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.114355 0.028042 0.008448 -0.003392 -0.001023 0.000000 0.000000 0.000000 -0.000408 0.000171 0.000037 ]
Step 2a: step direction in dual space r = [ -0.007138 -0.004133 0.617459 -0.362281 -0.354798 -0.003173 -0.068447 -0.046304 -0.061003 0.009440 0.009689 0.011396 ]
Step 2b)i): partial step length t1 = 5.246214
Step 2b)ii): full step length t2 = 0.050713
Step 2b)iii): selecting step length t = 0.050713
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000584 -1.000000 -0.601708 1.000000 1.000000 1.021288 1.021136 1.021687 1.044575 1.000000 1.020795 1.000000 1.011258 1.012461 1.000000 1.000000 1.000000 1.000000 1.000000 0.786475 0.769514 0.191890 6.656096 1.089884 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.090013 1.811713 1.662101 1.442552 0.818972 0.072378 0.207264 0.300219 1.091726 0.822913 0.814976 ]
f(x) =0.635253
Adding constraint 72
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 ]
Step 1: Trying constraint 2 at g(2) = [ -0.001935 ]
Step 2a: step direction in primal space d = [ 0.000000 0.000000 0.000174 -0.000000 -0.000000 -0.000026 -0.000025 -0.000028 -0.000066 0.000000 0.000027 0.000000 0.000121 0.000073 0.000000 0.000000 -0.000000 -0.000000 0.000000 -0.000772 -0.000682 0.000561 0.029609 0.001803 0.000000 0.000000 0.000000 0.000000 -0.000000 -0.000000 -0.007413 -0.003138 -0.000849 0.001036 -0.003035 0.000000 0.000000 0.000000 0.000194 -0.000312 -0.000256 ]
Step 2a: step direction in dual space r = [ -0.002832 -0.000843 1.413310 0.035384 0.069270 0.012196 0.001231 0.000616 0.014888 0.000161 0.000135 -0.000430 -0.000055 ]
Step 2b)i): partial step length t1 = 23.441024
Step 2b)ii): full step length t2 = 3.533688
Step 2b)iii): selecting step length t = 3.533688
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000583 -1.000000 -0.601095 1.000000 1.000000 1.021197 1.021048 1.021589 1.044340 1.000000 1.020890 1.000000 1.011686 1.012719 1.000000 1.000000 1.000000 1.000000 1.000000 0.783748 0.767103 0.193870 6.760724 1.096255 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.063817 1.800626 1.659101 1.446213 0.808248 0.072378 0.207264 0.300219 1.092413 0.821811 0.814070 ]
f(x) =0.634078
Adding constraint 2
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 ]
Step 1: Trying constraint 69 at g(69) = [ -0.012719 ]
Step 2a: step direction in primal space d = [ 0.000006 -0.000000 0.000113 -0.000000 0.000000 -0.003927 -0.003685 -0.002942 0.000928 0.000000 -0.002168 0.000000 -0.002791 -0.134569 -0.000000 0.000000 -0.000000 -0.000000 0.000000 0.001301 0.001423 0.000800 0.000296 0.000549 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.124267 0.036123 0.013320 -0.004381 -0.001667 0.000000 0.000000 0.000000 -0.000947 0.000183 -0.001396 ]
Step 2a: step direction in dual space r = [ -0.009047 -0.005213 1.058267 -0.690184 -0.448951 -0.006365 -0.072468 -0.049226 -0.060987 0.011592 0.011870 0.015635 0.013922 0.256349 ]
Step 2b)i): partial step length t1 = 3.656462
Step 2b)ii): full step length t2 = 0.094519
Step 2b)iii): selecting step length t = 0.094519
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000583 -1.000000 -0.601084 1.000000 1.000000 1.020826 1.020699 1.021311 1.044428 1.000000 1.020685 1.000000 1.011422 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.783871 0.767238 0.193946 6.760753 1.096307 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.075562 1.804040 1.660360 1.445799 0.808091 0.072378 0.207264 0.300219 1.092323 0.821828 0.813938 ]
f(x) =0.634077
Adding constraint 69
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 ]
Step 1: Trying constraint 68 at g(68) = [ -0.011422 ]
Step 2a: step direction in primal space d = [ 0.000008 0.000000 0.001417 0.000000 0.000000 -0.005580 -0.005259 -0.004286 0.000813 0.000000 -0.003238 -0.000000 -0.177370 -0.000000 -0.000000 -0.000000 0.000000 -0.000000 0.000000 0.001820 0.001952 0.002376 0.000406 0.000933 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.192041 0.034274 0.012131 -0.005694 -0.002419 0.000000 0.000000 0.000000 -0.001149 0.000209 -0.001966 ]
Step 2a: step direction in dual space r = [ -0.011604 -0.006417 1.513200 -0.715474 -0.506549 0.001615 -0.082488 -0.060551 -0.071323 0.015620 0.016071 0.027202 0.019311 0.438925 0.021968 ]
Step 2b)i): partial step length t1 = 2.567953
Step 2b)ii): full step length t2 = 0.064398
Step 2b)iii): selecting step length t = 0.064398
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000582 -1.000000 -0.600993 1.000000 1.000000 1.020466 1.020361 1.021035 1.044480 1.000000 1.020477 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.783988 0.767363 0.194099 6.760779 1.096367 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.087929 1.806247 1.661142 1.445433 0.807935 0.072378 0.207264 0.300219 1.092249 0.821842 0.813811 ]
f(x) =0.634075
Adding constraint 68
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 68 ]
Step 1: Trying constraint 66 at g(66) = [ -0.020477 ]
Step 2a: step direction in primal space d = [ 0.000006 0.000000 -0.001276 0.000000 0.000000 -0.004536 -0.004227 -0.003260 0.001811 0.000000 -0.254651 0.000000 -0.000000 -0.000000 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.000947 0.001068 -0.000551 0.000570 0.001627 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.225245 0.050703 0.016129 -0.006685 -0.003147 0.000000 0.000000 0.000000 -0.000839 0.000090 -0.001230 ]
Step 2a: step direction in dual space r = [ -0.015045 -0.008605 1.620499 -0.891540 -0.794336 -0.024924 -0.100451 -0.069323 -0.112161 0.011589 0.012066 0.018284 0.015728 0.342306 0.018580 0.016837 ]
Step 2b)i): partial step length t1 = 3.074003
Step 2b)ii): full step length t2 = 0.080412
Step 2b)iii): selecting step length t = 0.080412
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000582 -1.000000 -0.601095 1.000000 1.000000 1.020101 1.020021 1.020773 1.044626 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.784064 0.767449 0.194055 6.760824 1.096498 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.106042 1.810324 1.662439 1.444895 0.807682 0.072378 0.207264 0.300219 1.092182 0.821849 0.813712 ]
f(x) =0.634069
Adding constraint 66
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 68 66 ]
Step 1: Trying constraint 64 at g(64) = [ -0.044626 ]
Step 2a: step direction in primal space d = [ -0.000003 0.000000 -0.004504 0.000000 -0.000000 0.002429 0.002398 0.002385 -0.306489 -0.000000 0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.000000 -0.000000 0.000000 -0.000075 0.000122 -0.000223 0.000686 0.002094 0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.231999 0.044917 0.017249 -0.005785 -0.004076 -0.000000 -0.000000 0.000000 -0.000663 -0.000449 -0.002750 ]
Step 2a: step direction in dual space r = [ -0.017371 -0.009975 1.629544 -1.043090 -0.716610 -0.074585 -0.028498 -0.031512 -0.167187 -0.010540 -0.010071 -0.000832 -0.006284 0.262597 -0.002555 -0.004085 -0.005233 ]
Step 2b)i): partial step length t1 = 13.151984
Step 2b)ii): full step length t2 = 0.145604
Step 2b)iii): selecting step length t = 0.145604
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000582 -1.000000 -0.601751 1.000000 1.000000 1.020455 1.020370 1.021120 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.784053 0.767467 0.194022 6.760924 1.096803 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.139822 1.816864 1.664950 1.444053 0.807088 0.072378 0.207264 0.300219 1.092085 0.821783 0.813312 ]
f(x) =0.634045
Adding constraint 64
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 68 66 64 ]
Step 1: Trying constraint 63 at g(63) = [ -0.021120 ]
Step 2a: step direction in primal space d = [ 0.000013 0.000000 0.001789 -0.000000 0.000000 -0.008843 -0.008323 -0.334718 0.000000 0.000000 0.000000 -0.000000 0.000000 0.000000 -0.000000 0.000000 -0.000000 0.000000 -0.000000 0.001953 0.002181 0.003028 0.000889 0.002955 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.343081 0.055505 0.016517 -0.007300 -0.005938 0.000000 0.000000 0.000000 -0.001331 0.000012 -0.002656 ]
Step 2a: step direction in dual space r = [ -0.020265 -0.011022 2.511457 -0.992102 -0.803797 -0.009500 -0.152086 -0.100841 -0.137409 0.019769 0.020472 0.033083 0.026080 0.616273 0.028856 0.027276 0.017601 -0.004884 ]
Step 2b)i): partial step length t1 = 1.840371
Step 2b)ii): full step length t2 = 0.063099
Step 2b)iii): selecting step length t = 0.063099
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000581 -1.000000 -0.601638 1.000000 1.000000 1.019897 1.019845 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.784177 0.767605 0.194213 6.760981 1.096989 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.161470 1.820367 1.665992 1.443592 0.806714 0.072378 0.207264 0.300219 1.092001 0.821784 0.813144 ]
f(x) =0.634033
Adding constraint 63
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 68 66 64 63 ]
Step 1: Trying constraint 62 at g(62) = [ -0.019845 ]
Step 2a: step direction in primal space d = [ 0.000016 0.000000 0.003977 0.000000 0.000000 -0.011255 -0.351797 0.000000 0.000000 0.000000 -0.000000 0.000000 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 -0.000000 -0.000000 0.002526 0.002791 0.005178 0.000985 0.003468 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.378053 0.052888 0.014945 -0.006973 -0.007063 0.000000 0.000000 0.000000 -0.001541 0.000004 -0.003270 ]
Step 2a: step direction in dual space r = [ -0.021383 -0.011373 2.859459 -0.953953 -0.752804 0.003887 -0.173500 -0.113149 -0.138137 0.025185 0.025951 0.040543 0.032101 0.766250 0.034653 0.033229 0.022092 -0.003847 0.027815 ]
Step 2b)i): partial step length t1 = 1.443932
Step 2b)ii): full step length t2 = 0.056409
Step 2b)iii): selecting step length t = 0.056409
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000580 -1.000000 -0.601414 1.000000 1.000000 1.019262 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.784319 0.767762 0.194505 6.761036 1.097185 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.182796 1.823350 1.666835 1.443199 0.806315 0.072378 0.207264 0.300219 1.091914 0.821784 0.812960 ]
f(x) =0.634019
Adding constraint 62
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 68 66 64 63 62 ]
Step 1: Trying constraint 61 at g(61) = [ -0.019262 ]
Step 2a: step direction in primal space d = [ 0.000017 -0.000000 0.005186 0.000000 -0.000000 -0.360209 -0.000000 -0.000000 0.000000 0.000000 -0.000000 0.000000 -0.000000 -0.000000 0.000000 0.000000 -0.000000 0.000000 -0.000000 0.002739 0.003035 0.006745 0.001050 0.003903 -0.000000 -0.000000 -0.000000 -0.000000 0.000000 0.000000 0.391260 0.047387 0.013143 -0.006205 -0.007950 0.000000 0.000000 0.000000 -0.001614 -0.000082 -0.003806 ]
Step 2a: step direction in dual space r = [ -0.021848 -0.011418 3.077510 -0.898781 -0.670338 0.009632 -0.176478 -0.114093 -0.133102 0.026129 0.026911 0.043255 0.033249 0.871650 0.035631 0.034470 0.023075 -0.003322 0.029113 0.034699 ]
Step 2b)i): partial step length t1 = 1.339617
Step 2b)ii): full step length t2 = 0.053475
Step 2b)iii): selecting step length t = 0.053475
Step 2c)iii): Step in primal and dual space.
Next x = [ -0.000580 -1.000000 -0.601137 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 1.000000 0.784466 0.767924 0.194866 6.761092 1.097394 3.042980 2.849519 2.663426 2.484143 2.309946 2.140276 2.203718 1.825884 1.667538 1.442867 0.805890 0.072378 0.207264 0.300219 1.091828 0.821780 0.812756 ]
f(x) =0.634003
Adding constraint 61
Active constraints are [ 59 16 3 4 5 71 65 67 60 74 73 70 72 2 69 68 66 64 63 62 61 ]
All constraints satisfied. Feasible solution found.
EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match
#
echo "Running octave-cli -q " $prog

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi


#
# this much worked
#
pass
