#!/bin/sh

prog=complementaryFIRlattice_test.m
depends="complementaryFIRlattice_test.m test_common.m \
print_polynomial.m complementaryFIRlatticeFilter.m crossWelch.m KW.m \
complementaryFIRlattice2Abcd.m Abcd2tf.m complementaryFIRlattice.m \
minphase.m direct_form_scale.m complementaryFIRdecomp.oct"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED ${0#$here"/"} $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED ${0#$here"/"} $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.brz.ok << 'EOF'
brz = [  -0.00020943,   0.00012020,   0.00129951,   0.00160257, ... 
         -0.00171500,  -0.00682233,  -0.00509864,   0.00872438, ... 
          0.02217082,   0.01042209,  -0.03109532,  -0.06073529, ... 
         -0.01550975,   0.12126308,   0.28012388,   0.35091789, ... 
          0.28012388,   0.12126308,  -0.01550975,  -0.06073529, ... 
         -0.03109532,   0.01042209,   0.02217082,   0.00872438, ... 
         -0.00509864,  -0.00682233,  -0.00171500,   0.00160257, ... 
          0.00129951,   0.00012020,  -0.00020943 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.brz.ok"; fail; fi

cat > test.brzc.ok << 'EOF'
brzc = [   0.34183053,  -0.65764032,   0.17115236,   0.25827458, ... 
           0.05725727,  -0.10262613,  -0.11167509,  -0.02827755, ... 
           0.04484085,   0.05615428,   0.02209269,  -0.01388107, ... 
          -0.02547166,  -0.01584536,  -0.00196617,   0.00457938, ... 
           0.00356440,   0.00036866,  -0.00116782,  -0.00082782, ... 
          -0.00004192,   0.00027633,   0.00017111,   0.00000637, ... 
          -0.00004620,  -0.00002474,  -0.00000122,   0.00000393, ... 
           0.00000142,  -0.00000010,  -0.00000013 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.brzc.ok"; fail; fi

cat > test.krz.ok << 'EOF'
krz = [   0.99999981,   0.99999966,   0.99999683,   0.99994584, ... 
          0.99989530,   0.99999974,   0.99956561,   0.99904361, ... 
          0.99999337,   0.99717346,   0.99514281,   0.99975035, ... 
          0.97757947,   0.98842633,   0.86647944,   0.49700630, ... 
          0.86647944,   0.98842633,   0.97757947,   0.99975035, ... 
          0.99514281,   0.99717346,   0.99999337,   0.99904361, ... 
          0.99956561,   0.99999974,   0.99989530,   0.99994584, ... 
          0.99999683,   0.99999966,  -0.00061267 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.krz.ok"; fail; fi

cat > test.krzhat.ok << 'EOF'
krzhat = [   0.00061267,   0.00082706,  -0.00251720,  -0.01040738, ... 
            -0.01447039,  -0.00072607,   0.02947201,   0.04372494, ... 
             0.00364087,  -0.07513388,  -0.09844184,   0.02234379, ... 
             0.21056680,   0.15170164,  -0.49921276,  -0.86774693, ... 
            -0.49921276,   0.15170164,   0.21056680,   0.02234379, ... 
            -0.09844184,  -0.07513388,   0.00364087,   0.04372494, ... 
             0.02947201,  -0.00072607,  -0.01447039,  -0.01040738, ... 
            -0.00251720,   0.00082706,   0.99999981 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.krzhat.ok"; fail; fi

cat > test.ykrz.ok << 'EOF'
ykrz = [       2.8334,      -0.6415,     -16.3611,     -27.7821, ... 
               2.7324,      78.7173,     118.0854,      -2.8133, ... 
            -266.5904,    -368.4040,      46.8955,     816.4795, ... 
             961.9250,    -681.0337,   -4156.3378,   -7722.5410, ... 
           -8863.9647,   -6374.3066,   -1585.0613,    2598.2264, ... 
            3967.6195,    2462.9114,    -418.6449,   -3339.5422, ... 
           -6073.4455,   -8861.6029,  -11148.5622,  -11391.5002, ... 
           -8419.4578,   -3082.5240,    1722.8156,    3137.9708, ... 
             803.8821,   -2710.9124,   -4087.8225,   -2154.3419, ... 
            1234.6105,    3005.0391,    1646.2191,   -1607.3525, ... 
           -4125.5646,   -4412.9429,   -3413.4411,   -3323.3786, ... 
           -5084.4951,   -7174.2761,   -7115.6560,   -4144.6503, ... 
             -17.8861,    2977.6982,    4417.2730,    5654.1022, ... 
            7483.3482,    8713.3595,    7520.5594,    3872.1300, ... 
             -54.1571,   -1931.5496,   -1389.1021,      54.0327, ... 
             757.3989,     267.9823,    -853.6350,   -2026.3394, ... 
           -3224.2362,   -4730.0734,   -6526.4264,   -8071.6258, ... 
           -8711.1368,   -8443.1436,   -8027.6709,   -8077.1170, ... 
           -8059.5225,   -6691.0631,   -3693.0309,    -802.7958, ... 
            -292.7034,   -2342.3865,   -4512.5755,   -4357.2276, ... 
           -2198.8425,    -587.5757,    -997.8161,   -2022.1352, ... 
           -1455.0026,     541.4956,    1505.7462,      90.7905, ... 
           -1711.3141,    -726.2409,    3306.0026,    6829.8427, ... 
            6045.7080,     940.6988,   -4549.2640,   -6118.0476, ... 
           -2582.4601,    3531.3806,    8074.2631,    8068.4416, ... 
            3637.8006,   -2008.7403,   -4870.4463,   -3509.2140, ... 
            -508.9438,     -49.3917,   -3466.7656,   -7399.5050, ... 
           -6954.9766,    -950.3113,    6319.4211,    8897.7357, ... 
            4786.1416,   -2250.5986,   -6276.7762,   -4366.4883, ... 
            1514.6671,    6984.5182,    8934.7907,    7070.8339, ... 
            2955.8542,   -1515.1259,   -4708.5677,   -5389.4528, ... 
           -3257.6826,     427.3847,    3380.9148,    4069.1332, ... 
            3117.4120,    2685.3565,    4246.4308,    7026.0711, ... 
            8753.8961,    7976.7813,    5426.0089,    3071.5622, ... 
            1923.9808,    1078.0618,    -876.2538,   -3641.4631, ... 
           -4847.7535,   -2297.4238,    3406.2578,    8792.6254, ... 
           10319.5069,    7268.8919,    1901.5006,   -2814.3946, ... 
           -5263.3041,   -5321.4453,   -3505.5200,    -794.2974, ... 
            1033.5609,      42.3985,   -4044.7035,   -8879.2425, ... 
          -10987.8444,   -8639.0878,   -3132.2159,    2717.2971, ... 
            7017.3843,    9646.4261,   11079.1934,   11305.6679, ... 
           10215.3441,    8660.3871,    8158.7382,    9268.9292, ... 
           10599.5691,   10008.3894,    6837.9012,    2626.1336, ... 
            -444.2890,   -1463.9740,   -1108.4276,    -528.0532, ... 
            -449.9339,   -1121.7461,   -2379.6477,   -3515.2585, ... 
           -3671.5087,   -2897.8116,   -2466.4951,   -3521.6151, ... 
           -5427.9191,   -6109.7862,   -4296.2598,    -934.4221, ... 
            1936.6867,    3343.6405,    3910.4182,    4540.7788, ... 
            5237.7898,    5371.6272,    4456.7272,    2379.1176, ... 
            -715.9195,   -4127.8582,   -6473.1028,   -6576.1948, ... 
           -4752.1767,   -2787.9536,   -2254.9064,   -3057.6246, ... 
           -3934.1843,   -4140.0392,   -4128.9899,   -4474.2143, ... 
           -4685.0115,   -3623.4741,   -1048.9528,    1716.0615, ... 
            2998.3633,    2586.6691,    2114.1924,    3440.7037, ... 
            6731.0411,   10151.8697,   11524.0435,   10265.2278, ... 
            7667.7904,    5458.3672,    4276.0575,    3639.5970, ... 
            3064.0843,    2728.1457,    2928.5176,    3300.4506, ... 
            3030.9939,    1819.2662,     249.9770,    -894.2609, ... 
           -1405.3236,   -1564.1889,   -1595.1777,   -1629.7525, ... 
           -2152.7456,   -3852.1498,   -6600.4765,   -8750.8211, ... 
           -8028.5519,   -3554.7054,    2904.9920,    7802.7585, ... 
            8240.2650,    4038.1483,   -2191.2579,   -6987.6335, ... 
           -8447.5938,   -7138.8693,   -4872.7127,   -2662.4616, ... 
             -22.3979,    3696.6419,    7456.8319,    8501.1738 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ykrz.ok"; fail; fi

cat > test.ykrzhat.ok << 'EOF'
ykrzhat = [   -4624.6253,    7289.9287,   -2137.0590,    -380.8464, ... 
               1862.1159,   -2150.0190,   -7837.1141,    6334.0556, ... 
              10781.5689,  -12674.4901,    -380.1885,    5102.4309, ... 
              -2136.9867,    -818.3391,    -461.0702,    5810.3304, ... 
              -1777.2628,  -10584.5772,    8882.1575,    -130.4104, ... 
               3656.3296,   -1489.8271,   -5188.7086,   -1456.6437, ... 
               1785.5532,    5540.4023,   -4932.7985,    6284.9460, ... 
              -4741.1055,   -2597.6983,    1987.9532,   -3022.5678, ... 
               5286.6411,    7802.2846,  -13534.8820,    2956.5745, ... 
              -5597.5425,   14296.0047,   -3136.9150,   -6199.9831, ... 
              -1260.5076,    4421.4474,   -3420.5783,    7171.2795, ... 
               1715.7816,  -14398.8223,    5441.8914,    8500.2761, ... 
              -6787.7193,     177.1284,     860.8115,    -932.1176, ... 
               2719.3515,   -4974.6463,    -138.4021,    3162.3739, ... 
               6001.2110,  -13538.2048,    2689.3831,    9803.1937, ... 
              -5310.7087,    2010.4966,   -9727.9144,    5591.6407, ... 
               5015.6744,   -1745.0651,   -1911.4913,    4757.8600, ... 
             -12800.4303,    4015.4098,   12654.9295,   -2619.2903, ... 
              -5719.9187,  -10842.0284,    9719.8693,   14533.6231, ... 
              -9315.3870,  -10483.3410,    -192.7173,   11299.2964, ... 
              -3418.6059,    3446.1648,     311.9657,   -9012.3562, ... 
               4036.8278,   -1809.0994,    2287.4375,    2482.7434, ... 
              -2013.3065,    3639.9817,    -741.8887,  -10572.4221, ... 
                995.9825,    7080.0419,    7551.1124,   -1042.9117, ... 
             -13957.9318,    2905.3607,    -801.5919,    5573.3711, ... 
               3288.9590,    4143.9237,   -9596.4310,   -5567.6699, ... 
                997.5883,   11249.9950,   -2510.8231,   -5549.8743, ... 
               5430.6820,   -1982.5344,      87.6272,   -5249.5551, ... 
               8293.8757,   -5173.8238,   -2859.6696,    8866.5883, ... 
                943.5245,   -5620.1043,   -5784.3886,    8773.5058, ... 
              -6224.8619,    6897.6599,   -2393.5724,    2919.0948, ... 
             -11951.0123,   10630.8818,   -1484.8125,   -1051.8574, ... 
               5131.7987,   -5515.7300,   -2889.8500,   -5981.3202, ... 
              19059.8873,  -10542.1056,    5613.9459,  -11451.5613, ... 
               4124.2304,    5440.6270,   -2644.0039,   -4504.2106, ... 
                781.1256,    6211.6271,   -2470.1294,    2031.9975, ... 
              -1744.0296,   -7655.9876,    6726.4828,     538.4999, ... 
               1828.9984,    -820.6940,      74.9145,   -5880.6924, ... 
               7660.8780,    -765.8073,    -673.7848,   -3738.3224, ... 
              -1018.8903,    3850.9257,    9148.4448,  -15247.5939, ... 
              11276.4363,  -13031.7213,    9151.3971,   -2364.1249, ... 
               6627.7332,  -13746.4966,    4879.2222,   11318.9830, ... 
             -11235.1632,   -2248.4036,    -735.6083,    7279.0036, ... 
               7773.2878,  -15438.1594,    1905.1206,    1273.4319, ... 
               4079.9365,    3905.0011,   -7313.2370,   -1699.3328, ... 
               -231.5178,   12394.3499,  -11866.0081,    -829.9791, ... 
               2393.5890,    6608.1723,     302.4894,  -14064.9538, ... 
               5068.3043,    7997.3162,   -3040.0070,   -2940.4655, ... 
              -1569.9259,    7446.4008,   -8311.3164,   -1561.1651, ... 
              12915.1903,   -4517.6989,  -12801.7737,    9514.8375, ... 
               6480.3456,   -5378.7556,    -805.6525,      67.5084, ... 
                125.3347,     -44.5576,   -2389.4240,    7081.2891, ... 
                  8.7134,   -5922.6357,    -619.4149,     593.4532, ... 
               7122.3759,   -2830.6560,   -8517.7424,    8798.8657, ... 
              -3351.1557,     699.8651,    4888.0140,  -11700.6014, ... 
               6178.1895,    1508.1881,     466.2285,   -5631.0708, ... 
               3140.3473,   -1337.6098,    6498.5028,   -3420.1422, ... 
              -3787.6297,    1099.3121,     179.4451,   -1833.9599, ... 
               4440.1506,     418.0056,      56.6207,   -3350.9418, ... 
               1374.8134,   -6539.0282,    9800.3533,    -183.8526, ... 
              -1657.5243,   -1870.2152,   -5559.1276,    7936.2455, ... 
               -508.7407,   -1246.7813,    7174.8210,  -10336.2514, ... 
               -650.0120,   -2320.8525,    6167.5008,    8634.0294, ... 
              -3220.0739,   -6458.2025,   -9555.2305,   13802.6670 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ykrzhat.ok"; fail; fi

cat > test.stdxxkrz.ok << 'EOF'
stdxxkrz = [       5.0190,       8.4552,      22.2163,      88.1882, ... 
                 148.2266,     148.3880,     282.6890,     456.4574, ... 
                 457.4836,     765.1512,    1107.3478,    1122.1635, ... 
                2024.1323,    2322.0802,    4410.8412,    6332.9978, ... 
                4892.0885,    5100.5333,    4776.3706,    4731.2845, ... 
                4762.5221,    4669.8182,    4674.4177,    4682.2263, ... 
                4660.1320,    4660.4763,    4662.8012,    4659.1408, ... 
                4658.0704,    4658.1744 ];
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.stdxxkrz.ok"; fail; fi

cat > test.ypkrz.ok << 'EOF'
ypkrz = [       2.8334,      -0.6415,     -16.3611,     -27.7821, ... 
                2.7324,      78.7173,     118.0854,      -2.8133, ... 
             -266.5904,    -368.4040,      46.8955,     816.4795, ... 
              961.9250,    -681.0337,   -4156.3378,   -7722.5410, ... 
            -8863.9647,   -6374.3066,   -1585.0613,    2598.2264, ... 
             3967.6195,    2462.9114,    -418.6449,   -3339.5422, ... 
            -6073.4455,   -8861.6029,  -11148.5622,  -11391.5002, ... 
            -8419.4578,   -3082.5240,    1722.8156,    3137.9708, ... 
              803.8821,   -2710.9124,   -4087.8225,   -2154.3419, ... 
             1234.6105,    3005.0391,    1646.2191,   -1607.3525, ... 
            -4125.5646,   -4412.9429,   -3413.4411,   -3323.3786, ... 
            -5084.4951,   -7174.2761,   -7115.6560,   -4144.6503, ... 
              -17.8861,    2977.6982,    4417.2730,    5654.1022, ... 
             7483.3482,    8713.3595,    7520.5594,    3872.1300, ... 
              -54.1571,   -1931.5496,   -1389.1021,      54.0327, ... 
              757.3989,     267.9823,    -853.6350,   -2026.3394, ... 
            -3224.2362,   -4730.0734,   -6526.4264,   -8071.6258, ... 
            -8711.1368,   -8443.1436,   -8027.6709,   -8077.1170, ... 
            -8059.5225,   -6691.0631,   -3693.0309,    -802.7958, ... 
             -292.7034,   -2342.3865,   -4512.5755,   -4357.2276, ... 
            -2198.8425,    -587.5757,    -997.8161,   -2022.1352, ... 
            -1455.0026,     541.4956,    1505.7462,      90.7905, ... 
            -1711.3141,    -726.2409,    3306.0026,    6829.8427, ... 
             6045.7080,     940.6988,   -4549.2640,   -6118.0476, ... 
            -2582.4601,    3531.3806,    8074.2631,    8068.4416, ... 
             3637.8006,   -2008.7403,   -4870.4463,   -3509.2140, ... 
             -508.9438,     -49.3917,   -3466.7656,   -7399.5050, ... 
            -6954.9766,    -950.3113,    6319.4211,    8897.7357, ... 
             4786.1416,   -2250.5986,   -6276.7762,   -4366.4883, ... 
             1514.6671,    6984.5182,    8934.7907,    7070.8339, ... 
             2955.8542,   -1515.1259,   -4708.5677,   -5389.4528, ... 
            -3257.6826,     427.3847,    3380.9148,    4069.1332, ... 
             3117.4120,    2685.3565,    4246.4308,    7026.0711, ... 
             8753.8961,    7976.7813,    5426.0089,    3071.5622, ... 
             1923.9808,    1078.0618,    -876.2538,   -3641.4631, ... 
            -4847.7535,   -2297.4238,    3406.2578,    8792.6254, ... 
            10319.5069,    7268.8919,    1901.5006,   -2814.3946, ... 
            -5263.3041,   -5321.4453,   -3505.5200,    -794.2974, ... 
             1033.5609,      42.3985,   -4044.7035,   -8879.2425, ... 
           -10987.8444,   -8639.0878,   -3132.2159,    2717.2971, ... 
             7017.3843,    9646.4261,   11079.1934,   11305.6679, ... 
            10215.3441,    8660.3871,    8158.7382,    9268.9292, ... 
            10599.5691,   10008.3894,    6837.9012,    2626.1336, ... 
             -444.2890,   -1463.9740,   -1108.4276,    -528.0532, ... 
             -449.9339,   -1121.7461,   -2379.6477,   -3515.2585, ... 
            -3671.5087,   -2897.8116,   -2466.4951,   -3521.6151, ... 
            -5427.9191,   -6109.7862,   -4296.2598,    -934.4221, ... 
             1936.6867,    3343.6405,    3910.4182,    4540.7788, ... 
             5237.7898,    5371.6272,    4456.7272,    2379.1176, ... 
             -715.9195,   -4127.8582,   -6473.1028,   -6576.1948, ... 
            -4752.1767,   -2787.9536,   -2254.9064,   -3057.6246, ... 
            -3934.1843,   -4140.0392,   -4128.9899,   -4474.2143, ... 
            -4685.0115,   -3623.4741,   -1048.9528,    1716.0615, ... 
             2998.3633,    2586.6691,    2114.1924,    3440.7037, ... 
             6731.0411,   10151.8697,   11524.0435,   10265.2278, ... 
             7667.7904,    5458.3672,    4276.0575,    3639.5970, ... 
             3064.0843,    2728.1457,    2928.5176,    3300.4506, ... 
             3030.9939,    1819.2662,     249.9770,    -894.2609, ... 
            -1405.3236,   -1564.1889,   -1595.1777,   -1629.7525, ... 
            -2152.7456,   -3852.1498,   -6600.4765,   -8750.8211, ... 
            -8028.5519,   -3554.7054,    2904.9920,    7802.7585, ... 
             8240.2650,    4038.1483,   -2191.2579,   -6987.6335, ... 
            -8447.5938,   -7138.8693,   -4872.7127,   -2662.4616, ... 
              -22.3979,    3696.6419,    7456.8319,    8501.1738 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ypkrz.ok"; fail; fi

cat > test.ypkrzhat.ok << 'EOF'
ypkrzhat = [       0.0017,       0.0020,      -0.0177,      -0.0584, ... 
                  -0.0145,       0.2979,       0.7406,       0.3887, ... 
                  -1.8016,      -4.5626,      -2.7750,       7.8977, ... 
                  20.1348,      11.2960,     -34.3236,     -83.3570, ... 
                 -42.5400,     162.5042,     445.7617,     513.0694, ... 
                  72.9525,    -762.9830,   -1290.2626,    -663.1818, ... 
                1115.7678,    2561.4189,    1544.3076,   -2205.2873, ... 
               -4375.4757,    4436.6493,   -4134.9323,    5555.6001, ... 
                2855.1926,   -6228.8216,   -5939.7701,    9660.6919, ... 
                2877.7280,  -10891.8433,    7921.2772,     304.8306, ... 
               -6810.8851,    -621.9729,    4068.9161,    8257.7476, ... 
               -5195.7103,   -7715.8139,    5547.7623,   -5239.8561, ... 
                6616.9249,     487.0552,   -1491.5568,    -764.7985, ... 
               -1355.2742,    -614.8708,   -2755.8963,    9794.2010, ... 
               -4479.9773,    -342.5594,   -3391.0316,   -3791.5361, ... 
               10214.7272,    3730.6708,  -12127.8720,    2820.0308, ... 
               -5559.6058,   14364.4226,   -6562.9948,    -820.9356, ... 
                -421.5620,    -986.5412,   -2096.8044,   10386.2838, ... 
               -4184.9894,   -9443.5615,   11161.3734,     366.3717, ... 
               -7523.3408,    4177.6859,     163.8122,     253.4245, ... 
                 557.1647,   -5680.1383,    4400.6872,    5442.7474, ... 
               -1148.1454,  -14611.6808,    8735.0211,    5799.2177, ... 
               -2989.3724,    2517.2380,  -10813.0685,    5801.1053, ... 
                  15.9486,    1156.0915,    4067.4718,   -2069.8875, ... 
              -15669.8352,   11556.4307,   11421.3590,   -4014.7575, ... 
               -8955.4166,  -11001.2141,   13315.3635,    9274.0723, ... 
               -7961.9178,   -1784.5985,    1144.9851,     879.1068, ... 
               -7971.4018,    7634.3331,     886.3092,   -1346.0120, ... 
                6299.7939,   -7557.2394,   -2611.5832,   -2532.4910, ... 
                3476.3307,   12140.0953,   -1271.3936,  -12498.2727, ... 
               -2921.3834,    1984.3874,    8076.1711,    2324.0071, ... 
               -4201.3349,    3248.1581,   -9945.2483,    1359.8576, ... 
                3906.5614,    5633.7449,   -7070.0632,    -655.6177, ... 
                2813.5347,    5280.1895,   -8699.1143,   -1393.3778, ... 
                5316.2178,   -2952.8584,    2656.0293,      21.6955, ... 
                5675.7409,  -12312.3881,     664.1469,    8774.2284, ... 
               -1072.3733,   -3040.2333,   -1402.7042,    3049.9484, ... 
               -8359.6489,   10564.4840,    -662.1884,    2026.2402, ... 
              -10281.4569,    8052.8892,   -8463.3153,    5810.6181, ... 
                7612.3670,   -5792.4421,   -3692.8272,   -1941.3878, ... 
               13425.1648,  -13268.2083,    7151.9831,  -11807.5351, ... 
               10967.2177,    3329.4198,   -3626.8374,   -3873.7029, ... 
                -333.5632,    1392.6410,   -1599.3435,    5733.5404, ... 
               -3549.7115,   -4638.5876,    6095.5566,   -2548.9937, ... 
                3121.8785,   -1482.6419,   -3214.1998,   -4092.8222, ... 
                9430.3507,    -815.3830,    1234.2688,   -5186.3615, ... 
               -1166.1103,    4517.1882,    3184.5671,   -9456.0159, ... 
               12430.1048,  -13843.1400,   13069.1185,   -5467.4416, ... 
                1131.2128,  -12857.3612,   15323.2340,    5604.7128, ... 
              -12993.1202,    -569.6012,   -1669.4907,    9721.8806, ... 
                2545.8374,  -12517.9488,    6011.2688,   -2502.8848, ... 
                4446.7834,     598.7426,   -7372.5254,    2109.4509, ... 
                4679.6600,    7036.7058,  -16007.1592,    3225.9237, ... 
                3130.8446,    7280.0421,   -4325.6652,  -10019.2039, ... 
                9371.0939,    1237.7087,   -4504.0802,     781.9184, ... 
                1416.4913,    1200.0060,  -11427.7283,    8204.2141, ... 
               11083.1765,  -11653.4998,   -6546.8627,   10223.5258, ... 
               -2372.2903,   -3815.2774,    4631.7103,     819.2290, ... 
               -1577.7427,   -3333.4141,    -485.1097,    8119.3474, ... 
               -2846.6218,   -4467.4231,     475.8660,    2312.7540, ... 
                5899.6655,   -6195.1216,   -2821.5698,    7571.9682, ... 
               -6271.3575,    4836.6695,    -779.9378,   -9854.4678, ... 
               11069.8443,     133.7643,     820.1161,   -4913.3389, ... 
                 785.5836,   -3302.3624,    5637.2119,   -3236.4445 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ypkrzhat.ok"; fail; fi

cat > test.stdxxpkrz.ok << 'EOF'
stdxxpkrz = [    8191.9985,    8191.7544,    8191.7259,    8190.5674, ... 
                 8189.4707,    8189.4669,    8185.8980,    8178.0252, ... 
                 8177.9290,    8154.2493,    8114.6843,    8112.6349, ... 
                 7935.4905,    7853.2310,    6900.1892,    5193.8935, ... 
                 6567.0882,    6406.2457,    6651.0788,    6682.8605, ... 
                 6660.4084,    6725.4858,    6722.2668,    6716.6226, ... 
                 6731.7086,    6731.1666,    6728.8930,    6731.4059, ... 
                 6731.3333,    6731.1013 ];
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.stdxxpkrz.ok"; fail; fi

#
# run and see if the results match
#
echo "Running $prog"

octave --no-gui -q $prog >test.out 2>&1
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.brz.ok complementaryFIRlattice_test_brz_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.brz.ok"; fail; fi

diff -Bb test.brzc.ok complementaryFIRlattice_test_brzc_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.brzc.ok"; fail; fi

diff -Bb test.krz.ok complementaryFIRlattice_test_krz_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.krz.ok"; fail; fi

diff -Bb test.krzhat.ok complementaryFIRlattice_test_krzhat_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.krzhat.ok"; fail; fi

diff -Bb test.ykrz.ok complementaryFIRlattice_test_ykrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ykrz.ok"; fail; fi

diff -Bb test.ykrzhat.ok complementaryFIRlattice_test_ykrzhat.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ykrzhat.ok"; fail; fi

diff -Bb test.stdxxkrz.ok complementaryFIRlattice_test_stdxxkrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.stdxxkrz.ok"; fail; fi

diff -Bb test.ypkrz.ok complementaryFIRlattice_test_ypkrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ypkrz.ok"; fail; fi

diff -Bb test.ypkrzhat.ok complementaryFIRlattice_test_ypkrzhat.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ypkrzhat.ok"; fail; fi

diff -Bb test.stdxxpkrz.ok complementaryFIRlattice_test_stdxxpkrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.stdxxpkrz.ok"; fail; fi

#
# this much worked
#
pass

