#!/bin/sh

prog=complementaryFIRlattice_lowpass_test.m
depends="complementaryFIRlattice_lowpass_test.m test_common.m \
print_polynomial.m complementaryFIRlatticeFilter.m crossWelch.m KW.m \
complementaryFIRlattice2Abcd.m Abcd2tf.m complementaryFIRlattice.m \
minphase.m complementaryFIRdecomp.oct"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.brz.ok << 'EOF'
brz = [  -0.00020943,   0.00012020,   0.00129951,   0.00160257, ... 
         -0.00171500,  -0.00682233,  -0.00509864,   0.00872438, ... 
          0.02217082,   0.01042209,  -0.03109532,  -0.06073529, ... 
         -0.01550975,   0.12126308,   0.28012388,   0.35091789, ... 
          0.28012388,   0.12126308,  -0.01550975,  -0.06073529, ... 
         -0.03109532,   0.01042209,   0.02217082,   0.00872438, ... 
         -0.00509864,  -0.00682233,  -0.00171500,   0.00160257, ... 
          0.00129951,   0.00012020,  -0.00020943 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.brz.ok"; fail; fi
cat > test.brzc.ok << 'EOF'
brzc = [   0.34183056,  -0.65764032,   0.17115230,   0.25827457, ... 
           0.05725731,  -0.10262610,  -0.11167508,  -0.02827757, ... 
           0.04484083,   0.05615427,   0.02209269,  -0.01388107, ... 
          -0.02547166,  -0.01584536,  -0.00196617,   0.00457938, ... 
           0.00356440,   0.00036866,  -0.00116782,  -0.00082782, ... 
          -0.00004192,   0.00027633,   0.00017111,   0.00000637, ... 
          -0.00004620,  -0.00002474,  -0.00000122,   0.00000393, ... 
           0.00000142,  -0.00000010,  -0.00000013 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.brzc.ok"; fail; fi
cat > test.krz.ok << 'EOF'
krz = [   0.99999981,   0.99999966,   0.99999683,   0.99994584, ... 
          0.99989530,   0.99999974,   0.99956561,   0.99904361, ... 
          0.99999337,   0.99717346,   0.99514281,   0.99975035, ... 
          0.97757947,   0.98842634,   0.86647943,   0.49700634, ... 
          0.86647943,   0.98842634,   0.97757947,   0.99975035, ... 
          0.99514281,   0.99717346,   0.99999337,   0.99904361, ... 
          0.99956561,   0.99999974,   0.99989530,   0.99994584, ... 
          0.99999683,   0.99999966,  -0.00061267 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.krz.ok"; fail; fi
cat > test.krzhat.ok << 'EOF'
krzhat = [   0.00061267,   0.00082706,  -0.00251720,  -0.01040738, ... 
            -0.01447039,  -0.00072607,   0.02947200,   0.04372493, ... 
             0.00364085,  -0.07513388,  -0.09844181,   0.02234382, ... 
             0.21056680,   0.15170160,  -0.49921277,  -0.86774691, ... 
            -0.49921277,   0.15170160,   0.21056680,   0.02234382, ... 
            -0.09844181,  -0.07513388,   0.00364085,   0.04372493, ... 
             0.02947200,  -0.00072607,  -0.01447039,  -0.01040738, ... 
            -0.00251720,   0.00082706,   0.99999981 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.krzhat.ok"; fail; fi
cat > test.ykrz.ok << 'EOF'
ykrz = [       2.8334,      -0.6415,     -16.3611,     -27.7821, ... 
               2.7324,      78.7173,     118.0854,      -2.8133, ... 
            -266.5904,    -368.4040,      46.8955,     816.4795, ... 
             961.9250,    -681.0337,   -4156.3378,   -7722.5410, ... 
           -8863.9647,   -6374.3066,   -1585.0613,    2598.2264, ... 
            3967.6195,    2462.9114,    -418.6449,   -3339.5422, ... 
           -6073.4455,   -8861.6029,  -11148.5622,  -11391.5002, ... 
           -8419.4578,   -3082.5240,    1722.8156,    3137.9708, ... 
             803.8821,   -2710.9124,   -4087.8225,   -2154.3419, ... 
            1234.6105,    3005.0391,    1646.2191,   -1607.3525, ... 
           -4125.5646,   -4412.9429,   -3413.4411,   -3323.3786, ... 
           -5084.4951,   -7174.2761,   -7115.6560,   -4144.6503, ... 
             -17.8861,    2977.6982,    4417.2730,    5654.1022, ... 
            7483.3482,    8713.3595,    7520.5594,    3872.1300, ... 
             -54.1571,   -1931.5496,   -1389.1021,      54.0327, ... 
             757.3989,     267.9823,    -853.6350,   -2026.3394, ... 
           -3224.2362,   -4730.0734,   -6526.4264,   -8071.6258, ... 
           -8711.1368,   -8443.1436,   -8027.6709,   -8077.1170, ... 
           -8059.5225,   -6691.0631,   -3693.0309,    -802.7958, ... 
            -292.7034,   -2342.3865,   -4512.5755,   -4357.2276, ... 
           -2198.8425,    -587.5757,    -997.8161,   -2022.1352, ... 
           -1455.0026,     541.4956,    1505.7462,      90.7905, ... 
           -1711.3141,    -726.2409,    3306.0026,    6829.8427, ... 
            6045.7080,     940.6988,   -4549.2640,   -6118.0476, ... 
           -2582.4601,    3531.3806,    8074.2631,    8068.4416, ... 
            3637.8006,   -2008.7403,   -4870.4463,   -3509.2140, ... 
            -508.9438,     -49.3917,   -3466.7656,   -7399.5050, ... 
           -6954.9766,    -950.3113,    6319.4211,    8897.7357, ... 
            4786.1416,   -2250.5986,   -6276.7762,   -4366.4883, ... 
            1514.6671,    6984.5182,    8934.7907,    7070.8339, ... 
            2955.8542,   -1515.1259,   -4708.5677,   -5389.4528, ... 
           -3257.6826,     427.3847,    3380.9148,    4069.1332, ... 
            3117.4120,    2685.3565,    4246.4308,    7026.0711, ... 
            8753.8961,    7976.7813,    5426.0089,    3071.5622, ... 
            1923.9808,    1078.0618,    -876.2538,   -3641.4631, ... 
           -4847.7535,   -2297.4238,    3406.2578,    8792.6254, ... 
           10319.5069,    7268.8919,    1901.5006,   -2814.3946, ... 
           -5263.3041,   -5321.4453,   -3505.5200,    -794.2974, ... 
            1033.5609,      42.3985,   -4044.7035,   -8879.2425, ... 
          -10987.8444,   -8639.0878,   -3132.2159,    2717.2971, ... 
            7017.3843,    9646.4261,   11079.1934,   11305.6679, ... 
           10215.3441,    8660.3871,    8158.7382,    9268.9292, ... 
           10599.5691,   10008.3894,    6837.9012,    2626.1336, ... 
            -444.2890,   -1463.9740,   -1108.4276,    -528.0532, ... 
            -449.9339,   -1121.7461,   -2379.6477,   -3515.2585, ... 
           -3671.5087,   -2897.8116,   -2466.4951,   -3521.6151, ... 
           -5427.9191,   -6109.7862,   -4296.2598,    -934.4221, ... 
            1936.6867,    3343.6405,    3910.4182,    4540.7788, ... 
            5237.7898,    5371.6272,    4456.7272,    2379.1176, ... 
            -715.9195,   -4127.8582,   -6473.1028,   -6576.1948, ... 
           -4752.1767,   -2787.9536,   -2254.9064,   -3057.6246, ... 
           -3934.1843,   -4140.0392,   -4128.9899,   -4474.2143, ... 
           -4685.0115,   -3623.4741,   -1048.9528,    1716.0615, ... 
            2998.3633,    2586.6691,    2114.1924,    3440.7037, ... 
            6731.0411,   10151.8697,   11524.0435,   10265.2278, ... 
            7667.7904,    5458.3672,    4276.0575,    3639.5970, ... 
            3064.0843,    2728.1457,    2928.5176,    3300.4506, ... 
            3030.9939,    1819.2662,     249.9770,    -894.2609, ... 
           -1405.3236,   -1564.1889,   -1595.1777,   -1629.7525, ... 
           -2152.7456,   -3852.1498,   -6600.4765,   -8750.8211, ... 
           -8028.5519,   -3554.7054,    2904.9920,    7802.7585, ... 
            8240.2650,    4038.1483,   -2191.2579,   -6987.6335, ... 
           -8447.5938,   -7138.8693,   -4872.7127,   -2662.4616, ... 
             -22.3979,    3696.6419,    7456.8319,    8501.1738 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ykrz.ok"; fail; fi
cat > test.ykrzhat.ok << 'EOF'
ykrzhat = [   -4624.6257,    7289.9286,   -2137.0584,    -380.8461, ... 
               1862.1162,   -2150.0189,   -7837.1153,    6334.0544, ... 
              10781.5698,  -12674.4891,    -380.1889,    5102.4310, ... 
              -2136.9864,    -818.3392,    -461.0705,    5810.3306, ... 
              -1777.2623,  -10584.5781,    8882.1565,    -130.4102, ... 
               3656.3305,   -1489.8260,   -5188.7084,   -1456.6446, ... 
               1785.5523,    5540.4023,   -4932.7983,    6284.9465, ... 
              -4741.1048,   -2597.6986,    1987.9527,   -3022.5684, ... 
               5286.6410,    7802.2859,  -13534.8814,    2956.5737, ... 
              -5597.5436,   14296.0046,   -3136.9138,   -6199.9828, ... 
              -1260.5082,    4421.4470,   -3420.5784,    7171.2799, ... 
               1715.7829,  -14398.8226,    5441.8900,    8500.2762, ... 
              -6787.7189,     177.1283,     860.8115,    -932.1175, ... 
               2719.3518,   -4974.6462,    -138.4025,    3162.3738, ... 
               6001.2118,  -13538.2048,    2689.3819,    9803.1939, ... 
              -5310.7079,    2010.4970,   -9727.9150,    5591.6397, ... 
               5015.6747,   -1745.0643,   -1911.4909,    4757.8604, ... 
             -12800.4309,    4015.4082,   12654.9299,   -2619.2888, ... 
              -5719.9181,  -10842.0298,    9719.8678,   14533.6244, ... 
              -9315.3852,  -10483.3414,    -192.7191,   11299.2958, ... 
              -3418.6053,    3446.1657,     311.9668,   -9012.3563, ... 
               4036.8268,   -1809.1002,    2287.4369,    2482.7436, ... 
              -2013.3059,    3639.9825,    -741.8878,  -10572.4227, ... 
                995.9807,    7080.0412,    7551.1136,   -1042.9098, ... 
             -13957.9318,    2905.3592,    -801.5931,    5573.3707, ... 
               3288.9600,    4143.9256,   -9596.4300,   -5567.6710, ... 
                997.5863,   11249.9945,   -2510.8223,   -5549.8741, ... 
               5430.6824,   -1982.5337,      87.6275,   -5249.5556, ... 
               8293.8753,   -5173.8239,   -2859.6704,    8866.5883, ... 
                943.5258,   -5620.1036,   -5784.3894,    8773.5053, ... 
              -6224.8621,    6897.6599,   -2393.5718,    2919.0954, ... 
             -11951.0128,   10630.8811,   -1484.8121,   -1051.8573, ... 
               5131.7992,   -5515.7298,   -2889.8508,   -5981.3219, ... 
              19059.8874,  -10542.1042,    5613.9468,  -11451.5612, ... 
               4124.2295,    5440.6270,   -2644.0037,   -4504.2112, ... 
                781.1248,    6211.6273,   -2470.1286,    2031.9984, ... 
              -1744.0290,   -7655.9884,    6726.4817,     538.4996, ... 
               1828.9986,    -820.6936,      74.9149,   -5880.6926, ... 
               7660.8779,    -765.8067,    -673.7845,   -3738.3229, ... 
              -1018.8913,    3850.9252,    9148.4459,  -15247.5934, ... 
              11276.4363,  -13031.7216,    9151.3963,   -2364.1248, ... 
               6627.7338,  -13746.4966,    4879.2213,   11318.9839, ... 
             -11235.1624,   -2248.4043,    -735.6093,    7279.0034, ... 
               7773.2894,  -15438.1587,    1905.1196,    1273.4311, ... 
               4079.9364,    3905.0019,   -7313.2365,   -1699.3333, ... 
               -231.5186,   12394.3505,  -11866.0074,    -829.9798, ... 
               2393.5885,    6608.1729,     302.4906,  -14064.9542, ... 
               5068.3028,    7997.3162,   -3040.0063,   -2940.4652, ... 
              -1569.9262,    7446.4012,   -8311.3163,   -1561.1659, ... 
              12915.1907,   -4517.6977,  -12801.7745,    9514.8363, ... 
               6480.3463,   -5378.7547,    -805.6524,      67.5082, ... 
                125.3344,     -44.5579,   -2389.4245,    7081.2893, ... 
                  8.7144,   -5922.6354,    -619.4154,     593.4525, ... 
               7122.3761,   -2830.6553,   -8517.7430,    8798.8652, ... 
              -3351.1555,     699.8652,    4888.0147,  -11700.6015, ... 
               6178.1888,    1508.1882,     466.2289,   -5631.0709, ... 
               3140.3469,   -1337.6099,    6498.5034,   -3420.1414, ... 
              -3787.6299,    1099.3114,     179.4445,   -1833.9605, ... 
               4440.1506,     418.0064,      56.6216,   -3350.9414, ... 
               1374.8133,   -6539.0292,    9800.3526,    -183.8521, ... 
              -1657.5239,   -1870.2152,   -5559.1283,    7936.2453, ... 
               -508.7400,   -1246.7806,    7174.8221,  -10336.2511, ... 
               -650.0134,   -2320.8542,    6167.4999,    8634.0307, ... 
              -3220.0718,   -6458.2017,   -9555.2317,   13802.6659 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ykrzhat.ok"; fail; fi
cat > test.stdxxkrz.ok << 'EOF'
stdxxkrz = [       5.0190,       8.4552,      22.2163,      88.1882, ... 
                 148.2266,     148.3880,     282.6889,     456.4573, ... 
                 457.4835,     765.1512,    1107.3476,    1122.1634, ... 
                2024.1322,    2322.0800,    4410.8411,    6332.9978, ... 
                4892.0884,    5100.5332,    4776.3706,    4731.2844, ... 
                4762.5221,    4669.8182,    4674.4177,    4682.2263, ... 
                4660.1320,    4660.4763,    4662.8012,    4659.1408, ... 
                4658.0704,    4658.1744 ];
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.stdxxkrz.ok"; fail; fi
cat > test.ypkrz.ok << 'EOF'
ypkrz = [       2.8334,      -0.6415,     -16.3611,     -27.7821, ... 
                2.7324,      78.7173,     118.0854,      -2.8133, ... 
             -266.5904,    -368.4040,      46.8955,     816.4795, ... 
              961.9250,    -681.0337,   -4156.3378,   -7722.5410, ... 
            -8863.9647,   -6374.3066,   -1585.0613,    2598.2264, ... 
             3967.6195,    2462.9114,    -418.6449,   -3339.5422, ... 
            -6073.4455,   -8861.6029,  -11148.5622,  -11391.5002, ... 
            -8419.4578,   -3082.5240,    1722.8156,    3137.9708, ... 
              803.8821,   -2710.9124,   -4087.8225,   -2154.3419, ... 
             1234.6105,    3005.0391,    1646.2191,   -1607.3525, ... 
            -4125.5646,   -4412.9429,   -3413.4411,   -3323.3786, ... 
            -5084.4951,   -7174.2761,   -7115.6560,   -4144.6503, ... 
              -17.8861,    2977.6982,    4417.2730,    5654.1022, ... 
             7483.3482,    8713.3595,    7520.5594,    3872.1300, ... 
              -54.1571,   -1931.5496,   -1389.1021,      54.0327, ... 
              757.3989,     267.9823,    -853.6350,   -2026.3394, ... 
            -3224.2362,   -4730.0734,   -6526.4264,   -8071.6258, ... 
            -8711.1368,   -8443.1436,   -8027.6709,   -8077.1170, ... 
            -8059.5225,   -6691.0631,   -3693.0309,    -802.7958, ... 
             -292.7034,   -2342.3865,   -4512.5755,   -4357.2276, ... 
            -2198.8425,    -587.5757,    -997.8161,   -2022.1352, ... 
            -1455.0026,     541.4956,    1505.7462,      90.7905, ... 
            -1711.3141,    -726.2409,    3306.0026,    6829.8427, ... 
             6045.7080,     940.6988,   -4549.2640,   -6118.0476, ... 
            -2582.4601,    3531.3806,    8074.2631,    8068.4416, ... 
             3637.8006,   -2008.7403,   -4870.4463,   -3509.2140, ... 
             -508.9438,     -49.3917,   -3466.7656,   -7399.5050, ... 
            -6954.9766,    -950.3113,    6319.4211,    8897.7357, ... 
             4786.1416,   -2250.5986,   -6276.7762,   -4366.4883, ... 
             1514.6671,    6984.5182,    8934.7907,    7070.8339, ... 
             2955.8542,   -1515.1259,   -4708.5677,   -5389.4528, ... 
            -3257.6826,     427.3847,    3380.9148,    4069.1332, ... 
             3117.4120,    2685.3565,    4246.4308,    7026.0711, ... 
             8753.8961,    7976.7813,    5426.0089,    3071.5622, ... 
             1923.9808,    1078.0618,    -876.2538,   -3641.4631, ... 
            -4847.7535,   -2297.4238,    3406.2578,    8792.6254, ... 
            10319.5069,    7268.8919,    1901.5006,   -2814.3946, ... 
            -5263.3041,   -5321.4453,   -3505.5200,    -794.2974, ... 
             1033.5609,      42.3985,   -4044.7035,   -8879.2425, ... 
           -10987.8444,   -8639.0878,   -3132.2159,    2717.2971, ... 
             7017.3843,    9646.4261,   11079.1934,   11305.6679, ... 
            10215.3441,    8660.3871,    8158.7382,    9268.9292, ... 
            10599.5691,   10008.3894,    6837.9012,    2626.1336, ... 
             -444.2890,   -1463.9740,   -1108.4276,    -528.0532, ... 
             -449.9339,   -1121.7461,   -2379.6477,   -3515.2585, ... 
            -3671.5087,   -2897.8116,   -2466.4951,   -3521.6151, ... 
            -5427.9191,   -6109.7862,   -4296.2598,    -934.4221, ... 
             1936.6867,    3343.6405,    3910.4182,    4540.7788, ... 
             5237.7898,    5371.6272,    4456.7272,    2379.1176, ... 
             -715.9195,   -4127.8582,   -6473.1028,   -6576.1948, ... 
            -4752.1767,   -2787.9536,   -2254.9064,   -3057.6246, ... 
            -3934.1843,   -4140.0392,   -4128.9899,   -4474.2143, ... 
            -4685.0115,   -3623.4741,   -1048.9528,    1716.0615, ... 
             2998.3633,    2586.6691,    2114.1924,    3440.7037, ... 
             6731.0411,   10151.8697,   11524.0435,   10265.2278, ... 
             7667.7904,    5458.3672,    4276.0575,    3639.5970, ... 
             3064.0843,    2728.1457,    2928.5176,    3300.4506, ... 
             3030.9939,    1819.2662,     249.9770,    -894.2609, ... 
            -1405.3236,   -1564.1889,   -1595.1777,   -1629.7525, ... 
            -2152.7456,   -3852.1498,   -6600.4765,   -8750.8211, ... 
            -8028.5519,   -3554.7054,    2904.9920,    7802.7585, ... 
             8240.2650,    4038.1483,   -2191.2579,   -6987.6335, ... 
            -8447.5938,   -7138.8693,   -4872.7127,   -2662.4616, ... 
              -22.3979,    3696.6419,    7456.8319,    8501.1738 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ypkrz.ok"; fail; fi
cat > test.ypkrzhat.ok << 'EOF'
ypkrzhat = [       0.0017,       0.0020,      -0.0177,      -0.0584, ... 
                  -0.0145,       0.2979,       0.7406,       0.3887, ... 
                  -1.8016,      -4.5626,      -2.7750,       7.8977, ... 
                  20.1348,      11.2960,     -34.3236,     -83.3569, ... 
                 -42.5399,     162.5042,     445.7616,     513.0693, ... 
                  72.9524,    -762.9829,   -1290.2623,    -663.1813, ... 
                1115.7680,    2561.4185,    1544.3067,   -2205.2880, ... 
               -4375.4754,    4436.6498,   -4134.9316,    5555.6004, ... 
                2855.1919,   -6228.8220,   -5939.7692,    9660.6922, ... 
                2877.7269,  -10891.8436,    7921.2773,     304.8301, ... 
               -6810.8846,    -621.9717,    4068.9167,    8257.7466, ... 
               -5195.7118,   -7715.8139,    5547.7628,   -5239.8555, ... 
                6616.9253,     487.0547,   -1491.5573,    -764.7987, ... 
               -1355.2740,    -614.8704,   -2755.8956,    9794.2008, ... 
               -4479.9782,    -342.5598,   -3391.0314,   -3791.5351, ... 
               10214.7275,    3730.6695,  -12127.8723,    2820.0316, ... 
               -5559.6048,   14364.4225,   -6562.9959,    -820.9360, ... 
                -421.5621,    -986.5409,   -2096.8037,   10386.2837, ... 
               -4184.9902,   -9443.5608,   11161.3739,     366.3709, ... 
               -7523.3409,    4177.6863,     163.8121,     253.4244, ... 
                 557.1645,   -5680.1379,    4400.6876,    5442.7467, ... 
               -1148.1465,  -14611.6800,    8735.0226,    5799.2174, ... 
               -2989.3733,    2517.2372,  -10813.0683,    5801.1062, ... 
                  15.9488,    1156.0914,    4067.4711,   -2069.8883, ... 
              -15669.8340,   11556.4322,   11421.3579,   -4014.7596, ... 
               -8955.4169,  -11001.2119,   13315.3653,    9274.0713, ... 
               -7961.9193,   -1784.5990,    1144.9850,     879.1068, ... 
               -7971.4008,    7634.3341,     886.3091,   -1346.0123, ... 
                6299.7929,   -7557.2401,   -2611.5826,   -2532.4897, ... 
                3476.3317,   12140.0943,   -1271.3959,  -12498.2732, ... 
               -2921.3817,    1984.3893,    8076.1715,    2324.0059, ... 
               -4201.3362,    3248.1570,   -9945.2482,    1359.8590, ... 
                3906.5623,    5633.7446,   -7070.0635,    -655.6174, ... 
                2813.5346,    5280.1885,   -8699.1148,   -1393.3770, ... 
                5316.2183,   -2952.8582,    2656.0293,      21.6951, ... 
                5675.7400,  -12312.3881,     664.1482,    8774.2287, ... 
               -1072.3739,   -3040.2337,   -1402.7040,    3049.9485, ... 
               -8359.6484,   10564.4841,    -662.1894,    2026.2392, ... 
              -10281.4567,    8052.8899,   -8463.3144,    5810.6191, ... 
                7612.3662,   -5792.4433,   -3692.8274,   -1941.3872, ... 
               13425.1643,  -13268.2086,    7151.9836,  -11807.5340, ... 
               10967.2186,    3329.4188,   -3626.8386,   -3873.7033, ... 
                -333.5628,    1392.6414,   -1599.3431,    5733.5404, ... 
               -3549.7118,   -4638.5872,    6095.5567,   -2548.9941, ... 
                3121.8780,   -1482.6424,   -3214.1996,   -4092.8211, ... 
                9430.3511,    -815.3837,    1234.2680,   -5186.3617, ... 
               -1166.1097,    4517.1885,    3184.5667,   -9456.0157, ... 
               12430.1048,  -13843.1399,   13069.1187,   -5467.4422, ... 
                1131.2127,  -12857.3601,   15323.2347,    5604.7111, ... 
              -12993.1211,    -569.6004,   -1669.4896,    9721.8808, ... 
                2545.8361,  -12517.9490,    6011.2694,   -2502.8845, ... 
                4446.7834,     598.7420,   -7372.5253,    2109.4516, ... 
                4679.6598,    7036.7044,  -16007.1595,    3225.9251, ... 
                3130.8453,    7280.0415,   -4325.6661,  -10019.2033, ... 
                9371.0945,    1237.7082,   -4504.0805,     781.9185, ... 
                1416.4912,    1200.0057,  -11427.7274,    8204.2151, ... 
               11083.1752,  -11653.5010,   -6546.8619,   10223.5264, ... 
               -2372.2905,   -3815.2770,    4631.7105,     819.2285, ... 
               -1577.7431,   -3333.4139,    -485.1091,    8119.3472, ... 
               -2846.6225,   -4467.4229,     475.8667,    2312.7543, ... 
                5899.6649,   -6195.1222,   -2821.5694,    7571.9682, ... 
               -6271.3576,    4836.6696,    -779.9381,   -9854.4670, ... 
               11069.8448,     133.7634,     820.1150,   -4913.3393, ... 
                 785.5841,   -3302.3615,    5637.2126,   -3236.4443 ]';
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.ypkrzhat.ok"; fail; fi
cat > test.stdxxpkrz.ok << 'EOF'
stdxxpkrz = [    8191.9985,    8191.7544,    8191.7259,    8190.5674, ... 
                 8189.4707,    8189.4669,    8185.8980,    8178.0252, ... 
                 8177.9290,    8154.2493,    8114.6843,    8112.6349, ... 
                 7935.4905,    7853.2311,    6900.1892,    5193.8936, ... 
                 6567.0883,    6406.2458,    6651.0788,    6682.8605, ... 
                 6660.4084,    6725.4858,    6722.2668,    6716.6226, ... 
                 6731.7086,    6731.1666,    6728.8930,    6731.4059, ... 
                 6731.3333,    6731.1013 ];
EOF
if [ $? -ne 0 ]; then echo "Failed output cat test.stdxxpkrz.ok"; fail; fi

#
# run and see if the results match
#
echo "Running octave-cli -q " $prog

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.brz.ok complementaryFIRlattice_lowpass_test_brz_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.brz.ok"; fail; fi

diff -Bb test.brzc.ok complementaryFIRlattice_lowpass_test_brzc_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.brzc.ok"; fail; fi

diff -Bb test.krz.ok complementaryFIRlattice_lowpass_test_krz_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.krz.ok"; fail; fi

diff -Bb test.krzhat.ok complementaryFIRlattice_lowpass_test_krzhat_coef.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.krzhat.ok"; fail; fi

diff -Bb test.ykrz.ok complementaryFIRlattice_lowpass_test_ykrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ykrz.ok"; fail; fi

diff -Bb test.ykrzhat.ok complementaryFIRlattice_lowpass_test_ykrzhat.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ykrzhat.ok"; fail; fi

diff -Bb test.stdxxkrz.ok complementaryFIRlattice_lowpass_test_stdxxkrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.stdxxkrz.ok"; fail; fi

diff -Bb test.ypkrz.ok complementaryFIRlattice_lowpass_test_ypkrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ypkrz.ok"; fail; fi

diff -Bb test.ypkrzhat.ok complementaryFIRlattice_lowpass_test_ypkrzhat.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.ypkrzhat.ok"; fail; fi

diff -Bb test.stdxxpkrz.ok complementaryFIRlattice_lowpass_test_stdxxpkrz.m
if [ $? -ne 0 ]; then echo "Failed diff -Bb test.stdxxpkrz.ok"; fail; fi

#
# this much worked
#
pass

