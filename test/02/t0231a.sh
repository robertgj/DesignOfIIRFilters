#!/bin/sh

prog=schurOneMR2lattice2Abcd_test.m
depends="schurOneMR2lattice2Abcd_test.m test_common.m schurOneMR2lattice2Abcd.m \
tf2schurOneMlattice.m Abcd2tf.m schurOneMscale.m schurdecomp.oct \
schurexpand.oct svf.m KW.m crossWelch.m reprand.oct"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED ${0#$here"/"} $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED ${0#$here"/"} $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
A =

   0.00000   1.00000
   0.38742   0.00000

B =

   0.00000
   1.38742

C =

   0.18650   0.19652

D =  0.18650
Aap =

   0.00000   1.00000
   0.38742   0.00000

Bap =

   0.00000
   1.38742

Cap =

   0.61258   0.00000

Dap = -0.38742
ng =  0.19561
ngap =  1.0000
est_varyd =  0.099634
varyd =  0.10082
stdxx =

   128.60   128.60

est_varydap =  0.16667
varydap =  0.17008
stdxxap =

   128.60   128.60

indexABCap =

   1   2   3   5

A =

   0.00000   1.00000   0.00000   0.00000   0.00000
   0.78820   0.00000   0.00000   0.00000   1.78820
   0.21180   0.00000   0.00000   0.00000  -0.78820
   0.12860   0.13834   0.00000   0.00000   0.19222
   0.00000   0.00000  -0.48630   0.00000   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.51370

C =

   0.00000   0.00000   0.00000   1.00000   0.13834

D =  0.078437
Aap =

   0.00000   1.00000   0.00000   0.00000
   0.78820   0.00000   0.00000   1.78820
   0.21180   0.00000   0.00000  -0.78820
   0.00000   0.00000  -0.48630   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.51370

Cap =

   0.00000   0.00000   1.48630   0.00000

Dap =  0.48630
ng =  0.48133
ngap =  3.0000
est_varyd =  0.12344
varyd =  0.12327
stdxx =

   129.42   129.43   128.27   130.50   128.28

est_varydap =  0.33333
varydap =  0.33272
stdxxap =

   129.42   129.43   128.27   128.28

indexABCap =

   1   2   3   5   6   8

A =

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.86114   0.00000   0.00000   0.00000   0.13886   0.00000   0.00000   0.00000
   1.86114   0.00000   0.00000   0.00000  -0.86114   0.00000   0.00000   0.00000
   0.28000   0.31550   0.00000   0.00000   0.05215   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.86647   0.00000   0.00000   0.00000   0.00000   1.86647
   0.00000   0.00000   0.13353   0.00000   0.00000   0.00000   0.00000   0.86647
   0.00000   0.00000   0.00000   1.00000   0.03975   0.00000   0.00000   0.14987
   0.00000   0.00000   0.00000   0.00000   0.00000   0.44804   0.00000   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.55196

C =

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000   0.13397

D =  0.045209
Aap =

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000
   0.86114   0.00000   0.00000   0.13886   0.00000   0.00000
   1.86114   0.00000   0.00000  -0.86114   0.00000   0.00000
   0.00000   0.00000  -0.86647   0.00000   0.00000   1.86647
   0.00000   0.00000   0.13353   0.00000   0.00000   0.86647
   0.00000   0.00000   0.00000   0.00000   0.44804   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.55196

Cap =

   0.00000   0.00000   0.00000   0.00000   1.44804   0.00000

Dap = -0.44804
ng =  0.77895
ngap =  5.0000
est_varyd =  0.14825
varyd =  0.14659
stdxx =

   129.64   129.64   129.10   130.58   129.11   128.45   131.00   128.48

est_varydap =  0.50000
varydap =  0.49803
stdxxap =

   129.64   129.64   129.10   129.11   128.45   128.48

indexABCap =

    1    2    3    5    6    8    9   11   12   14   15   17

A =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.29504   0.00000   0.00000   0.00000   0.70496   0.00000   0.00000   0.00000
   1.29504   0.00000   0.00000   0.00000  -0.29504   0.00000   0.00000   0.00000
   0.11604   0.33428   0.00000   0.00000   0.36273   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.34141   0.00000   0.00000   0.00000   0.00000   1.34141
   0.00000   0.00000   0.65859   0.00000   0.00000   0.00000   0.00000   0.34141
   0.00000   0.00000   0.00000   1.00000   0.31839   0.00000   0.00000   0.20439
   0.00000   0.00000   0.00000   0.00000   0.00000   0.19585   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   1.19585   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000  -0.01881
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.80415   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.19585   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.09289   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.08857   0.00000   0.00000   0.00000   0.00000   0.91143   0.00000   0.00000
   1.08857   0.00000   0.00000   0.00000   0.00000   0.08857   0.00000   0.00000
   0.00000   1.00000  -0.06363   0.00000   0.00000  -0.00149   0.00000   0.00000
   0.00000   0.00000   0.00000   0.03540   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   1.03540   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   1.00000   0.02505   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.00538   0.00000

 Column 17:

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.96460
  -0.03540
   0.01561
   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.99462

C =

   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0

D = 0
Aap =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.29504   0.00000   0.00000   0.70496   0.00000   0.00000   0.00000   0.00000
   1.29504   0.00000   0.00000  -0.29504   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.34141   0.00000   0.00000   1.34141   0.00000   0.00000
   0.00000   0.00000   0.65859   0.00000   0.00000   0.34141   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.19585   0.00000   0.00000   0.80415
   0.00000   0.00000   0.00000   0.00000   1.19585   0.00000   0.00000  -0.19585
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.08857   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.08857   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 12:

   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.91143   0.00000   0.00000
   0.00000   0.08857   0.00000   0.00000
   0.03540   0.00000   0.00000   0.96460
   1.03540   0.00000   0.00000  -0.03540
   0.00000   0.00000  -0.00538   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.99462

Cap =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 12:

   0.00000   0.00000   1.00538   0.00000

Dap =  0.0053802
ng =  3.4586
ngap =  11.000
est_varyd =  0.37155
varyd =  0.37259
stdxx =

 Columns 1 through 8:

   127.85   127.86   127.50   128.06   127.50   128.05   128.63   128.06

 Columns 9 through 16:

   128.04   128.36   128.06   127.99   128.17   128.02   127.97   128.20

 Column 17:

   128.00

est_varydap =  1.0000
varydap =  0.99710
stdxxap =

 Columns 1 through 8:

   127.85   127.86   127.50   127.50   128.05   128.06   128.04   128.06

 Columns 9 through 12:

   127.99   128.02   127.97   128.00

indexABCap =

 Columns 1 through 16:

    1    2    3    5    6    8    9   11   12   14   15   17   18   20   21   23

 Columns 17 through 20:

   24   26   27   29

A =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.66277   0.00000   0.00000   0.00000   1.66277   0.00000   0.00000   0.00000
   0.33723   0.00000   0.00000   0.00000   0.66277   0.00000   0.00000   0.00000
   0.07121  -0.01291   0.00000   0.00000  -0.29923   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.49863   0.00000   0.00000   0.00000   0.00000   0.50137
   0.00000   0.00000   1.49863   0.00000   0.00000   0.00000   0.00000   0.49863
   0.00000   0.00000   0.00000   1.00000  -0.48302   0.00000   0.00000  -0.16306
   0.00000   0.00000   0.00000   0.00000   0.00000  -0.34576   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.65424   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000   0.12095
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   1.34576   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.34576   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.39442   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.41879   0.00000   0.00000   0.00000   0.00000   0.58121   0.00000   0.00000
   1.41879   0.00000   0.00000   0.00000   0.00000   0.41879   0.00000   0.00000
   0.00000   1.00000   0.30131   0.00000   0.00000   0.01833   0.00000   0.00000
   0.00000   0.00000   0.00000  -0.29691   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.70309   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   1.00000  -0.08212   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.25141   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.25141   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 24:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   1.29691   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.29691   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.08029   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.74859   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.25141   0.00000   0.00000   0.00000   0.00000
  -0.01322   0.00000   0.00000  -0.00946   0.00000   0.00000   0.00000   0.00000
   0.00000  -0.15065   0.00000   0.00000   0.00000   0.00000   0.84935   0.00000
   0.00000   1.15065   0.00000   0.00000   0.00000   0.00000   0.15065   0.00000
   0.00000   0.00000   1.00000  -0.03458   0.00000   0.00000  -0.02558   0.00000
   0.00000   0.00000   0.00000   0.00000  -0.10213   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.89787   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000   0.00440   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.03596
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.03596
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 25 through 29:

   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   1.10213   0.00000   0.00000   0.00000
   0.00000   0.10213   0.00000   0.00000   0.00000
   0.00000   0.02453   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.96404
   0.00000   0.00000   0.00000   0.00000   0.03596
   1.00000   0.01694   0.00000   0.00000   0.00303
   0.00000   0.00000  -0.01491   0.00000   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.98509

C =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 24:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 25 through 29:

   0.00000   0.00000   0.00000   1.00000   0.00103

D =  0.0052643
Aap =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.66277   0.00000   0.00000   1.66277   0.00000   0.00000   0.00000   0.00000
   0.33723   0.00000   0.00000   0.66277   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.49863   0.00000   0.00000   0.50137   0.00000   0.00000
   0.00000   0.00000   1.49863   0.00000   0.00000   0.49863   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000  -0.34576   0.00000   0.00000   1.34576
   0.00000   0.00000   0.00000   0.00000   0.65424   0.00000   0.00000   0.34576
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.41879   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.41879   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.58121   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.41879   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.29691   0.00000   0.00000   1.29691   0.00000   0.00000   0.00000   0.00000
   0.70309   0.00000   0.00000   0.29691   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.25141   0.00000   0.00000   0.74859   0.00000   0.00000
   0.00000   0.00000   1.25141   0.00000   0.00000   0.25141   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000  -0.15065   0.00000   0.00000   0.84935
   0.00000   0.00000   0.00000   0.00000   1.15065   0.00000   0.00000   0.15065
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.10213   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.89787   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 20:

   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   1.10213   0.00000   0.00000
   0.00000   0.10213   0.00000   0.00000
  -0.03596   0.00000   0.00000   0.96404
   1.03596   0.00000   0.00000   0.03596
   0.00000   0.00000  -0.01491   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.98509

Cap =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 20:

   0.00000   0.00000   1.01491   0.00000

Dap =  0.014908
ng =  3.5514
ngap =  19.000
est_varyd =  0.37928
varyd =  0.37979
stdxx =

 Columns 1 through 8:

   127.61   127.61   127.30   127.60   127.31   127.02   127.78   127.03

 Columns 9 through 16:

   127.33   128.30   127.35   127.71   127.93   127.74   127.66   128.29

 Columns 17 through 24:

   127.69   127.78   128.24   127.81   127.95   128.26   128.00   127.92

 Columns 25 through 29:

   128.23   127.97   127.97   128.26   128.02

est_varydap =  1.6667
varydap =  1.6748
stdxxap =

 Columns 1 through 8:

   127.61   127.61   127.30   127.31   127.02   127.03   127.33   127.35

 Columns 9 through 16:

   127.71   127.74   127.66   127.69   127.78   127.81   127.95   128.00

 Columns 17 through 20:

   127.92   127.97   127.97   128.02

EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match. .
#
echo "Running $prog"

octave-cli -q $prog >test.out 2>&1
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi

#
# this much worked
#
pass

