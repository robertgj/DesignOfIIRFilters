#!/bin/sh

prog=schurOneMR2lattice2Abcd_test.m
depends="schurOneMR2lattice2Abcd_test.m test_common.m schurOneMR2lattice2Abcd.m \
tf2schurOneMlattice.m Abcd2tf.m schurOneMscale.m schurdecomp.oct \
schurexpand.oct svf.m KW.m crossWelch.m reprand.oct"

tmp=/tmp/$$
here=`pwd`
if [ $? -ne 0 ]; then echo "Failed pwd"; exit 1; fi

fail()
{
        echo FAILED $prog 1>&2
        cd $here
        rm -rf $tmp
        exit 1
}

pass()
{
        echo PASSED $prog
        cd $here
        rm -rf $tmp
        exit 0
}

trap "fail" 1 2 3 15
mkdir $tmp
if [ $? -ne 0 ]; then echo "Failed mkdir"; exit 1; fi
echo $here
for file in $depends;do \
  cp -R src/$file $tmp; \
  if [ $? -ne 0 ]; then echo "Failed cp "$file; fail; fi \
done
cd $tmp
if [ $? -ne 0 ]; then echo "Failed cd"; fail; fi

#
# the output should look like this
#
cat > test.ok << 'EOF'
A =

   0.00000   1.00000
   0.38742   0.00000

B =

   0.00000
   1.38742

C =

   0.18650   0.19652

D =  0.18650
Aap =

   0.00000   1.00000
   0.38742   0.00000

Bap =

   0.00000
   1.38742

Cap =

   0.61258   0.00000

Dap = -0.38742
lenffn =  3
lenffdR =  3
ng =  0.19561
ngap =  1.0000
est_varyd =  0.099634
varyd =  0.10082
stdxx =

   128.60   128.60

est_varydap =  0.16667
varydap =  0.17008
stdxxap =

   128.60   128.60

indexABCap =

   1   2   3   5

A =

   0.00000   1.00000   0.00000   0.00000   0.00000
   0.78820   0.00000   0.00000   0.00000   1.78820
   0.21180   0.00000   0.00000   0.00000  -0.78820
   0.12860   0.13834   0.00000   0.00000   0.19222
   0.00000   0.00000  -0.48630   0.00000   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.51370

C =

   0.00000   0.00000   0.00000   1.00000   0.13834

D =  0.078437
Aap =

   0.00000   1.00000   0.00000   0.00000
   0.78820   0.00000   0.00000   1.78820
   0.21180   0.00000   0.00000  -0.78820
   0.00000   0.00000  -0.48630   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.51370

Cap =

   0.00000   0.00000   1.48630   0.00000

Dap =  0.48630
lenffn =  5
lenffdR =  5
ng =  0.48133
ngap =  3.0000
est_varyd =  0.12344
varyd =  0.12327
stdxx =

   129.42   129.43   128.27   130.50   128.28

est_varydap =  0.33333
varydap =  0.33272
stdxxap =

   129.42   129.43   128.27   128.28

indexABCap =

   1   2   3   5   6   8

A =

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.86114   0.00000   0.00000   0.00000   0.13886   0.00000   0.00000   0.00000
   1.86114   0.00000   0.00000   0.00000  -0.86114   0.00000   0.00000   0.00000
   0.28000   0.31550   0.00000   0.00000   0.05215   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.86647   0.00000   0.00000   0.00000   0.00000   1.86647
   0.00000   0.00000   0.13353   0.00000   0.00000   0.00000   0.00000   0.86647
   0.00000   0.00000   0.00000   1.00000   0.03975   0.00000   0.00000   0.14987
   0.00000   0.00000   0.00000   0.00000   0.00000   0.44804   0.00000   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.55196

C =

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000   0.13397

D =  0.045209
Aap =

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000
   0.86114   0.00000   0.00000   0.13886   0.00000   0.00000
   1.86114   0.00000   0.00000  -0.86114   0.00000   0.00000
   0.00000   0.00000  -0.86647   0.00000   0.00000   1.86647
   0.00000   0.00000   0.13353   0.00000   0.00000   0.86647
   0.00000   0.00000   0.00000   0.00000   0.44804   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.55196

Cap =

   0.00000   0.00000   0.00000   0.00000   1.44804   0.00000

Dap = -0.44804
lenffn =  7
lenffdR =  7
ng =  0.77895
ngap =  5.0000
est_varyd =  0.14825
varyd =  0.14659
stdxx =

   129.64   129.64   129.10   130.58   129.11   128.45   131.00   128.48

est_varydap =  0.50000
varydap =  0.49803
stdxxap =

   129.64   129.64   129.10   129.11   128.45   128.48

indexABCap =

    1    2    3    5    6    8    9   11   12   14   15   17

A =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.59579   0.00000   0.00000   0.00000   1.59579   0.00000   0.00000   0.00000
   0.40421   0.00000   0.00000   0.00000  -0.59579   0.00000   0.00000   0.00000
   0.23790   0.30131   0.00000   0.00000   0.39191   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.51922   0.00000   0.00000   0.00000   0.00000   0.48078
   0.00000   0.00000   1.51922   0.00000   0.00000   0.00000   0.00000   0.51922
   0.00000   0.00000   0.00000   1.00000   0.12117   0.00000   0.00000  -0.05057
   0.00000   0.00000   0.00000   0.00000   0.00000   0.40816   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.59184   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000  -0.06284
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   1.40816   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.40816   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.02974   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.24976   0.00000   0.00000   0.00000   0.00000   0.75024   0.00000   0.00000
   1.24976   0.00000   0.00000   0.00000   0.00000   0.24976   0.00000   0.00000
   0.00000   1.00000   0.02358   0.00000   0.00000   0.02472   0.00000   0.00000
   0.00000   0.00000   0.00000   0.11189   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   1.11189   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   1.00000   0.00913   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.02778   0.00000

 Column 17:

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.88811
  -0.11189
  -0.00316
   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.97222

C =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000

 Column 17:

  -0.00270

D =    6.6702e-04
Aap =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.59579   0.00000   0.00000   1.59579   0.00000   0.00000   0.00000   0.00000
   0.40421   0.00000   0.00000  -0.59579   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.51922   0.00000   0.00000   0.48078   0.00000   0.00000
   0.00000   0.00000   1.51922   0.00000   0.00000   0.51922   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.40816   0.00000   0.00000   1.40816
   0.00000   0.00000   0.00000   0.00000   0.59184   0.00000   0.00000  -0.40816
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.24976   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.24976   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 12:

   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.75024   0.00000   0.00000
   0.00000   0.24976   0.00000   0.00000
   0.11189   0.00000   0.00000   0.88811
   1.11189   0.00000   0.00000  -0.11189
   0.00000   0.00000  -0.02778   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.97222

Cap =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 12:

   0.00000   0.00000   1.02778   0.00000

Dap =  0.027778
lenffn =  13
lenffdR =  13
ng =  3.0289
ngap =  11.000
est_varyd =  0.33574
varyd =  0.33997
stdxx =

 Columns 1 through 8:

   128.48   128.48   127.39   129.00   127.39   127.69   128.87   127.70

 Columns 9 through 16:

   127.92   128.50   127.95   128.02   128.53   128.05   127.98   128.53

 Column 17:

   128.01

est_varydap =  1.0000
varydap =  0.99159
stdxxap =

 Columns 1 through 8:

   128.48   128.48   127.39   127.39   127.69   127.70   127.92   127.95

 Columns 9 through 12:

   128.02   128.05   127.98   128.01

indexABCap =

 Columns 1 through 16:

    1    2    3    5    6    8    9   11   12   14   15   17   18   20   21   23

 Columns 17 through 20:

   24   26   27   29

A =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.65781   0.00000   0.00000   0.00000   1.65781   0.00000   0.00000   0.00000
   0.34219   0.00000   0.00000   0.00000   0.65781   0.00000   0.00000   0.00000
   0.07517  -0.00824   0.00000   0.00000  -0.28809   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.51649   0.00000   0.00000   0.00000   0.00000   0.48351
   0.00000   0.00000   1.51649   0.00000   0.00000   0.00000   0.00000   0.51649
   0.00000   0.00000   0.00000   1.00000  -0.48874   0.00000   0.00000  -0.17094
   0.00000   0.00000   0.00000   0.00000   0.00000  -0.35275   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.64725   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000   0.10654
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   1.35275   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.35275   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.38459   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.42803   0.00000   0.00000   0.00000   0.00000   0.57197   0.00000   0.00000
   1.42803   0.00000   0.00000   0.00000   0.00000   0.42803   0.00000   0.00000
   0.00000   1.00000   0.30742   0.00000   0.00000   0.02421   0.00000   0.00000
   0.00000   0.00000   0.00000  -0.29896   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.70104   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   1.00000  -0.08043   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.25255   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.25255   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 24:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   1.29896   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.29896   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.08441   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.74745   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.25255   0.00000   0.00000   0.00000   0.00000
  -0.01540   0.00000   0.00000  -0.00630   0.00000   0.00000   0.00000   0.00000
   0.00000  -0.14990   0.00000   0.00000   0.00000   0.00000   0.85010   0.00000
   0.00000   1.14990   0.00000   0.00000   0.00000   0.00000   0.14990   0.00000
   0.00000   0.00000   1.00000  -0.03027   0.00000   0.00000  -0.02431   0.00000
   0.00000   0.00000   0.00000   0.00000  -0.10109   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.89891   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   1.00000   0.00379   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.03328
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.03328
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 25 through 29:

   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   1.10109   0.00000   0.00000   0.00000
   0.00000   0.10109   0.00000   0.00000   0.00000
   0.00000   0.02459   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.96672
   0.00000   0.00000   0.00000   0.00000   0.03328
   1.00000   0.01770   0.00000   0.00000   0.00240
   0.00000   0.00000  -0.01340   0.00000   0.00000

B =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.98660

C =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 24:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 25 through 29:

   0.00000   0.00000   0.00000   1.00000  -0.00153

D =  0.0023859
Aap =

 Columns 1 through 8:

   0.00000   1.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.65781   0.00000   0.00000   1.65781   0.00000   0.00000   0.00000   0.00000
   0.34219   0.00000   0.00000   0.65781   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.51649   0.00000   0.00000   0.48351   0.00000   0.00000
   0.00000   0.00000   1.51649   0.00000   0.00000   0.51649   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000  -0.35275   0.00000   0.00000   1.35275
   0.00000   0.00000   0.00000   0.00000   0.64725   0.00000   0.00000   0.35275
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.42803   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   1.42803   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.57197   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.42803   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
  -0.29896   0.00000   0.00000   1.29896   0.00000   0.00000   0.00000   0.00000
   0.70104   0.00000   0.00000   0.29896   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000  -0.25255   0.00000   0.00000   0.74745   0.00000   0.00000
   0.00000   0.00000   1.25255   0.00000   0.00000   0.25255   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000  -0.14990   0.00000   0.00000   0.85010
   0.00000   0.00000   0.00000   0.00000   1.14990   0.00000   0.00000   0.14990
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000  -0.10109   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.89891   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 20:

   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   0.00000   0.00000   0.00000
   0.00000   1.10109   0.00000   0.00000
   0.00000   0.10109   0.00000   0.00000
  -0.03328   0.00000   0.00000   0.96672
   1.03328   0.00000   0.00000   0.03328
   0.00000   0.00000  -0.01340   0.00000

Bap =

   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.00000
   0.98660

Cap =

 Columns 1 through 8:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 9 through 16:

   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000   0.00000

 Columns 17 through 20:

   0.00000   0.00000   1.01340   0.00000

Dap =  0.013400
lenffn =  21
lenffdR =  21
ng =  3.4480
ngap =  19.000
est_varyd =  0.37067
varyd =  0.37045
stdxx =

 Columns 1 through 8:

   127.61   127.62   127.30   127.59   127.31   126.99   127.82   127.00

 Columns 9 through 16:

   127.30   128.33   127.32   127.70   127.96   127.73   127.65   128.33

 Columns 17 through 24:

   127.68   127.78   128.29   127.81   127.95   128.30   127.99   127.93

 Columns 25 through 29:

   128.28   127.97   127.97   128.31   128.02

est_varydap =  1.6667
varydap =  1.6568
stdxxap =

 Columns 1 through 8:

   127.61   127.62   127.30   127.31   126.99   127.00   127.30   127.32

 Columns 9 through 16:

   127.70   127.73   127.65   127.68   127.78   127.81   127.95   127.99

 Columns 17 through 20:

   127.93   127.97   127.97   128.02

EOF
if [ $? -ne 0 ]; then echo "Failed output cat"; fail; fi

#
# run and see if the results match. Suppress m-file warnings.
#
echo "Running octave-cli -q " $prog
echo "warning('off');" >> .octaverc

octave-cli -q $prog > test.out
if [ $? -ne 0 ]; then echo "Failed running $prog"; fail; fi

diff -Bb test.ok test.out
if [ $? -ne 0 ]; then echo "Failed diff -Bb"; fail; fi

#
# this much worked
#
pass

